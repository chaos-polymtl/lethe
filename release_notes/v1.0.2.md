## Release of Lethe v1.0.2 - 2025-10-15

The Lethe v1.0.2 requires the latest major release of the deal.II library (deal.ii v9.7).

As part of the v1.0 release, the major components of this version are detailed in the following Journal Article (which is available in open-access):
https://doi.org/10.1016/j.cpc.2025.109880

Lethe v1.0.2 introduces some key new features and bug fixes including:

Five new examples : Turbulent Flow Around a Cylinder, Pseudo-2D Gas-Solid Fluidized Bed, Gas-Solid Spouted Rectangular Bed, Heat Transfer in Aligned Particles and Heated Packed Bed
Full support for particle-particle heat transfer in the DEM simulations. This feature is illustrated in two of the aforementioned examples.
A new feature which allows user to apply a single boundary condition to multiple boundary conditions id, greatly simplifying parameter files.
Significant improvement to the geometric redistanciation algorithm. It is now approximatively 3-5X faster to apply this method to sharpen the interface. Furthermore, the method can also be used to generate initial conditions
SDIRK time integration scheme for the matrix-based fluid dynamics solver (SDIRK22, SDIRK33 and SDIRK34)
A number of bug fixes related to the of simulations in which post-processing capabilities are used. Notably, the Tables used to store the post-processing information were not all serialized and restored properly.
Significant improvement to the compilation of Lethe. Warnings during compilation under CLang were all eliminated. Furthermore, compilation speed was improved by removing unnecessary include files.
A great number of small bug fixes and improvements which are given in details below.
The lethe v1.0.2 release comes with a structured and stable syntax. All of the examples and test provided with lethe were re-ran with this v1.0.2 release to ensure that all of the results provided online are up to date. This version is production-ready and has been tested and validated extensively.

### [Master] - 2025-10-14

### Fixed

- MAJOR The CFD-DEM implementation could run with adaptive time step (set adapt = true), but the DEM time step was never updated when the CFD time-step was adapted. This meant that the time progression in the DEM was actually wrong. None of our examples or previous publications use CFD-DEM with adaptive time-stepping, but this is clearly a problem. This change fixes this issue by recaclulating the DEM time-step at every coupling interval when the CFD time-step is adaptive. The portion of the critical Rayleigh time-step is also recalculated when that occurs. A test has been added to verify the adequacy of the feature. [#1715](https://github.com/chaos-polymtl/lethe/pull/1715)

- MINOR There was a segmentation fault when the geometric smoother was selected in the vof initial condition with a reinitialization method other than the geometric one. It was because the SignedDistanceSolver was only instantiated if the geometric reinitialization method was selected. This PR fixes this problem. [#1718](https://github.com/chaos-polymtl/lethe/pull/1718)

### [Master] - 2025-10-13

### Changed

- MINOR The CLang tidy workflow is back to ensure that Lethe is as clean as possible. Some of the small issues identified by it through the run have been fixed (notably some pass by copy instead of const reference and some range-based loop missing). [#1708](https://github.com/chaos-polymtl/lethe/pull/1708)

- MINOR The organization of the documentation for multiphase flows has been restructured slightly so that DEM is allowed to stand-out more. [#1713] (https://github.com/chaos-polymtl/lethe/pull/1713)

### [Master] - 2025-10-10

### Changed

- MAJOR The CXX standard enforced for Lethe has been switched from C++ 17 to C++ 20. This change has been done to harmonize with the deal.II docker images, which are also now based on C++ 20. To further modernize the CI architecture, the docker images have been moved from Jammy (22.04) to Noble (24.04). This is a major breaking change for the tests since Noble is packaged with p4est 2.3.6 whereas Jammy was packaged with p4est 2.2. Consequently, all of the restart files and DEM files used in the tests have been regenerated using p4est 2.3.6. This is a positive change since p4est 2.3.6 is much easier to compile on modern machine than p4est 2.2 and it makes the whole testing environment a lot more portable. We have also reintroduced the deal.II major release CI. This means that Lethe is not only tested against deal.II v9.8pre (master), but is also tested against the last major stable release which is deal.II v9.7.1. This will be useful since installing the deal.II v9.7.1 is very easy on debian or ubuntu since there is a package for it. The documentation has been updated to reflect this major change and the installation instructions have been modernized to explain the capability of installing deal.II from the package manager under certain operating systems. Finally, this enables us to also rebuild docker files with every change to master and make Lethe available as a docker image. [#1709](https://github.com/chaos-polymtl/lethe/pull/1709)

### [Master] - 2025-10-06

### Changed

- MINOR Unnecessary included files were removed from most ``.h`` and ``.cc`` files from the repository. This should speed up the compilation on clusters. [#1704](https://github.com/chaos-polymtl/lethe/pull/1704)

### Fixed

- MINOR The timer in navier_stokes_base post_process_fd was requesting the time summary while the timer itself was running. In the recent deal.II change, this undefined behavior is asserted for. This  manually opens and closes the timing at the right locations to ensure that the timer is not running anymore when the time is requested. [#1705](https://github.com/chaos-polymtl/lethe/pull/1693)

### [Master] - 2025-10-01

### Added

- MINOR Added doxygen documentation for VANS and CFD-DEM solvers. [#1702](https://github.com/chaos-polymtl/lethe/pull/1702)

### [Master] - 2025-09-29

### Added

- MINOR Continuing the integration of the mortar method with the matrix-free solver from #1682, this PR adds the mortar operators in the GC multigrid preconditioner. [#1693](https://github.com/chaos-polymtl/lethe/pull/1693)

### Changed

- MINOR We are targetting to uniformize the parameter names. As such, parameter declaration which are made of multiple words will not be separated by an "_" anymore. This is already the case for 95% of the parameters in the code. The remaining "_" will only be kept to indicate an underscore as per LaTeX syntax. This PR refactors the periodic_id and the periodic_direction parameter to follow this syntax. To keep the code stable in the short term, an alias was declared for this parameter which uses the previous syntax. [#1698](https://github.com/chaos-polymtl/lethe/pull/1698)

### Added

- MAJOR The id for the boundary condition used to support a single unsigned integer value, which meant that applying the same boundary condition to multiple ids would require setting up a large amount of boundary condition sections. This PR adds the support to specify a list of boundary id on which a boundary condition is applied. This list of boundary id is only used at the level of the parameter file and each id is still considered seperately in the simulation itself. [#1697](https://github.com/chaos-polymtl/lethe/pull/1697)

### [Master] - 2025-09-26

### Fixed

- MAJOR Fixed a bug in which an additional sparsity pattern was generated which would prevent the matrix-based code from refining past 80M cells or so on the cluster. This sparsity pattern has been removed. [#1696](https://github.com/chaos-polymtl/lethe/pull/1696)

- MINOR Add a virtual destructor to PhysicsScratchDataBase to remove some clang warnings. [#1695](https://github.com/chaos-polymtl/lethe/pull/1695)

### [Master] - 2025-09-23

### Added

- MINOR A new reaction prefactor Gaussian model to be used with the lethe-fluid-sharp solver with the tracer physics. This new model imposes different properties at the interface and in the bulk of each phase, with a tunable width. It has been added to the tracer diffusivity as well. [#1688](https://github.com/chaos-polymtl/lethe/pull/1688)

### [Master] - 2025-09-18

### Added

- MINOR The mortar implementation is added in the matrix-free solver. This PR also adds a direct MF solver to be used for debugging purposes.[#1682](https://github.com/chaos-polymtl/lethe/pull/1682)

### Fixed

- MINOR The code is modified so that the TableHandler objects are properly restored when writing checkpoints and restarting simulations for the lethe-fluid, lethe-fluid-particles and lethe-fluid-nitsche solvers. This feature was only working for the lethe-fluid/lethe-fluid-block/lethe-fluid-matrix-free solvers before. [#1673] (https://github.com/chaos-polymtl/lethe/pull/1673)


### [Master] - 2025-09-16

### Fixed

- MINOR There was a typo in the code when load balancing. "Repartitioning" was written with two "n". [#1681](https://github.com/chaos-polymtl/lethe/pull/1681)

### Changed

- MINOR Remove dealii 9.6 version checks in matrix-free solver. [#1680](https://github.com/chaos-polymtl/lethe/pull/1680)

- MINOR There was a warning that would be triggered in some of the Kokkos prototypes. These are now fixed by using the new syntax for the matrix-free operators. Furthermore, I took the opportunity to remove all the Clang warnings that would appear in prototypes. [#1679](https://github.com/chaos-polymtl/lethe/pull/1679)

### [Master] - 2025-09-13

### Changed

- MAJOR This is the last PR of the output refactoring started in #1624(https://github.com/chaos-polymtl/lethe/pull/1624) and fixed in #1661(https://github.com/chaos-polymtl/lethe/pull/1661). It includes using the new output struct to replace the previous "attach output" to DataOut pattern. [#1678](https://github.com/chaos-polymtl/lethe/pull/1678)

### [Master] - 2025-09-12

### Fixed

- MINOR A missing include "deal.II/multigrid/mg_transfer_matrix_free.templates.h" was added to enable compilation on deal.II master version (9.8-pre). It will not be impossible to compile Lethe with a deal.II 9.8-pre version that predates 10/09/2025. [#1676](https://github.com/chaos-polymtl/lethe/pull/1676). The initial version of this PR was partially wrong and is updated in [#1677](https://github.com/chaos-polymtl/lethe/pull/1677) to adequately account for the 9.7 version check.

- MINOR Prevent termination of the CI when it is running on master.  cancel-in-progress is only called if ${{github.event_name == 'pull_request'}} which prevents cancellation on events other than pull request (e.g. merge to master). [#1675](https://github.com/chaos-polymtl/lethe/pull/1675)

### [Master] - 2025-09-11

### Fixed

- MINOR When compiling Lethe with Clang, multiple warning arise throughout the code. This removes the last remaining warning in the dem, fem-dem and rpt library. The majority of the warnings left were related to some virtual classes not having virtual destructors and static_cast missing when using the type properties from the article. Lethe now compiles without any warning on modern Clang. [#1674](https://github.com/chaos-polymtl/lethe/pull/1674)

### [Master] - 2025-09-10

### Added

- MINOR Add DoFRenumbering call in matrix-free solver. [#1671](https://github.com/chaos-polymtl/lethe/pull/1671)

### Fixed

- MINOR When compiling Lethe with Clang, multiple warning arise throughout the code. In the long term, we aim to remove these warnings so that Lethe compiles on both GCC and Clang without any warnings. All of the warnings of the solver library were removed. The majority of the warnings were related to some virtual classes not having a virtual distructors and some odd integers to double or double to integers conversions that were implicit. The type for the fill level in the ILU preconditioners was changed from double to integer since this is the actualy type required by the Trilinos library. [#1672](https://github.com/chaos-polymtl/lethe/pull/1672)

### [Master] - 2025-09-08

### Fixed

- MINOR The parameters for initial translation and rotation of the mesh were included in the Parameters::Mesh structure, but not used in attach_grid_to_triangulation. This PR fixes this. [#1668](https://github.com/chaos-polymtl/lethe/pull/1668)

### [Master] - 2025-09-07

### Fixed

- Minor When compiling Lethe with Clang, multiple warning arise throughout the code. In the long term, we aim to remove these warnings so that Lethe compiles on both GCC and Clang without any warnings. All of the warnings of the core library were removed. The majority of the warnings were related to some virtual classes not having a virtual distructors and some odd integers to double or double to integers conversions that were implicit. [#1666](https://github.com/chaos-polymtl/lethe/pull/1666)

### [Master] - 2025-09-04

### Added

- MINOR Add validation case for the sharp application. [#1663](https://github.com/chaos-polymtl/lethe/pull/1663)

### Fixed

- MAJOR This PR fixes the bug patched in [#1658](https://github.com/chaos-polymtl/lethe/pull/1658). It attaches a DoF handler to the DataOut instance, which prevents calls for add_solution_vector without DoF handler. This is a more robust solution than the previous one. More tests will be carried out, but this solution reproduces what the code had before the refactoring in [#1624](https://github.com/chaos-polymtl/lethe/pull/1624). Additionally, this PR finishes the refactoring of the "write output" function, unifying cell and DoF output data into the same container of structs. [#1661](https://github.com/chaos-polymtl/lethe/pull/1661)

### Fixed

- MAJOR The sharp-edge solver used in resolved CFD-DEM would crash at the first VTU output produced. This is because no dof handler was being attached to the output hook. This PR temporarily fixes that by attaching the dof handler of the main problem. A better solution will be implemented soon. [#1658](https://github.com/chaos-polymtl/lethe/pull/1658)

### [Master] - 2025-09-03

### Added

- MINOR Script in Python to generate Function expression for inlet velocity using polynomial function. [#1655](https://github.com/chaos-polymtl/lethe/pull/1655)

### Fixed

- MINOR The webpage CI would still upload the artifacts to the webpage branch even when not on the master branch which would increase the size of the repository. This has been fixed now and the artifacts will only be uploaded from the master branch. [#1654](https://github.com/chaos-polymtl/lethe/pull/1654)

### [Master] - 2025-09-02

### Changed

- MINOR The checkpointing with TableHandler tables had some issues. When checkpointing and restarting, the tables were serialized and deserialized on all ranks. Since the tables were only owned on rank 0, this resulted in an overwriting of data in the tables, and data history was lost at restart. With this change, by default, only rank 0 serializes and deserializes the information. If wished in the future, with the current change it is also possible to serialize on multiple cores, by setting the default parameter `serialize_on_rank_zero`/`deserialize_on_rank_zero` to `false`. [#1652](https://github.com/chaos-polymtl/lethe/pull/1652)

- MINOR The documentation for the diffusion factors for the projection of interface normal as well as the curvature did not document the parameter correctly. It used the word filter instead of diffusion for the two factors. [#1643](https://github.com/chaos-polymtl/lethe/pull/1643)

- MAJOR The rolling resistance models naming convention was redundant. Every option had an extra \"_resistance\" at the end, which was not necessary. Options are now "none", "constant", "viscous" and "epsd". The old naming convention is still compatible for now, but will be deprecated down the line. Currently, a warning message is shown when using the previous naming convention. [#1640](https://github.com/chaos-polymtl/lethe/pull/1640)

### [Master] - 2025-09-01

### Added

- MINOR Adds the capability to project the particle-fluid forces within the ParticleProjector class. This is still an experimental feature that is not usable from the parameter file. [#1642](https://github.com/chaos-polymtl/lethe/pull/1642)

### [Master] - 2025-08-30

### Changed

- MINOR The `create_random_number_container`, previously only used during the volume insertion in the DEM, has been moved to the `utilities.h` file. This way, this function will be accessible outside the volume insertion, which will limit duplicated code. [#1639](https://github.com/chaos-polymtl/lethe/pull/1639)

## [Master] - 2025-08-29

### Fixed

- MINOR The ALE mortar assembler did not account for changes in the stabilization terms due to the introduction of the ALE velocity. This PR fixes this.[#1638](https://github.com/chaos-polymtl/lethe/pull/1638)

### [Master] - 2025-08-28

### Added

- MINOR A bash script for checking simulations on cluster that have timed-out (TIMEOUT) or failed (FAILED) and relaunching them (if requested) has been added to the utilities of Lethe. [#1636](https://github.com/chaos-polymtl/lethe/pull/1636)

### Changed

- MINOR The core library had many included headers that were not required. These have been removed. I have also started to improve the doxygen documentation of many functions in utilities.h. This is an ongoing work that will be split into many small PRs. [#1635](https://github.com/chaos-polymtl/lethe/pull/1635)

- MINOR The scratch data for the particle-fluid interaction had a flawed hypothesis in that it relied on the fact that the velocity component of the scratch data (namely related to the fe_values for the velocity) had its cell reinit before the particle-fluid interaction was gathered at the location of the particles. This is true in the regular CFD-DEM framework or VANS framework, but it is not true for what I wish to do in the matrix-free framework. This PR fixes that by decoupling the two. Furthermore, assertions regarding the fact that components were actually enabled before they are reinit or they are required were added in Debug mode to make the code more robust. Finally, everything that could be easily moved from the .h to the .cc has been moved. [#1634](https://github.com/chaos-polymtl/lethe/pull/1634)

### [Master] - 2025-08-27

### Changed

- MINOR The constructor for some of the particle-fluid force assemblers were taking as an argument the lagrangian particle properties, but never using them. As part of a refactor, these constructors have been cleaned out and streamlined to not take any argument. Furthermore, the buoyancy constructor took the full particle parameters whereas it only needs the particle gravity acceleration. This has also been fixed. [#1633](https://github.com/chaos-polymtl/lethe/pull/1633)

### [Master] - 2025-08-21

### Added

- MAJOR The void fraction manager has been refactored to become the particle_projector. This class now manages not only the calculation of the void fraction, but it can also project other particle fields onto the triangulation. Right now the only field that can be projected is the particle velocity, but additional fields can be easily added to the method. [#1614](https://github.com/chaos-polymtl/lethe/pull/1614)

- MINOR Update instructions for using new clusters. [#1632](https://github.com/chaos-polymtl/lethe/pull/1632)

- MINOR Local smoothing multigrid now supports hp-multigrid. [#1630](https://github.com/chaos-polymtl/lethe/pull/1630)

### [Master] - 2025-08-20

### Added

- MINOR The additive Schwarz method (ASM) is now also working for local-smoothing multigrid. [#1628](https://github.com/chaos-polymtl/lethe/pull/1628)

### [Master] - 2025-08-19

### Changed

- MINOR Refactor write_output_results into two functions: one that gathers the outputs into a container (vector of structs) and another one that instantiates the DataOut object and fills it with the gathered data. The struct data structure is also created in this PR. Lastly, it deprecates the postprocessor smoothing feature. [#1624](https://github.com/chaos-polymtl/lethe/pull/1624)

### Fixed

- MINOR The matrix-free version of the TGV example did not use the fix pressure constant option. This prevented the prm file from being robust if you modified the CFL, the order or anything similar. I have added the fix pressure constant option to the example to ensure that it is now robust. [#1625](https://github.com/chaos-polymtl/lethe/pull/1625)

- MINOR The pressure constraint and the periodic boundary conditions were not working for the local smoothing multigrid preconditioner. This was fixed and a Taylor-Couette test was added for both multigrid variants. [#1626](https://github.com/chaos-polymtl/lethe/pull/1626) 

### [Master] - 2025-08-18

- MINOR The mortar indices were being computed according to the cell face center, and not taking into account in which side of the mortar the cell was placed. This led to rounding issues for very refined meshes, when the distribution of local and ghost mortar cells would fail. This has been fixed by adding a bool is_inner to identify the mortar cell side. [#1623](https://github.com/chaos-polymtl/lethe/pull/1623)

### [Master] - 2025-08-14

### Fixed

- MAJOR Add check for heat transfer request when solving multiphysics simulations with the matrix-free solver. This is a tiny change, but without this check an error was triggered upon running a multiphysics simulation without heat transfer.[#1622](https://github.com/chaos-polymtl/lethe/pull/1622)

### Changed

- MINOR The geometric reinitialization method was really expensive in terms of computational time. This PR improves the performances by reducing the number of cells in the layer's loop (only the cells in a corona around the interface are visited) and the number of calls to FEPointEvaluation.reinit(). [#1621](https://github.com/chaos-polymtl/lethe/pull/1621)

### Added

- MINOR A new time stepping scheme to solve the unsteady Navier-Stokes equations with a matrix based solver. Before, only BDF schemes were used in Lethe. This PR adds the Singly Diagonnaly Implicit Runge-Kutta (SDIRK) schemes with order 2, 3 and 4. [#1598](https://github.com/chaos-polymtl/lethe/pull/1598/)

### [Master] - 2025-08-13

### Added

- MINOR In some location in the core library, AssertThrow were being used in locations were a simple Assert would have been sufficient. This should have a slightly positive impact on performance. [#1615](https://github.com/chaos-polymtl/lethe/pull/1615)

### [Master] - 2025-08-12

### Fixed

-MINOR Fix the rotate_mapping() function for 2D cases to account for the center_of_rotation. [#1619](https://github.com/chaos-polymtl/lethe/pull/1619)

### Added

- MINOR The function to write the collision logs is modified to manage the way MPI processes can access the .csv file to write the data. A forced synchronization of the MPI processes is imposed to avoid corrupting the data. The particle diameter and mass is added to the collision log, and a dem_current_time is calculated in CFD-DEM. [#1613](https://github.com/chaos-polymtl/lethe/pull/1613)


### [Master] - 2025-08-11

### Added

- MINOR Prototype of slice output feature using deal.II's [DataOutputResample](https://dealii.org/current/doxygen/deal.II/classDataOutResample.html). The prototype works in parallel for the cases tested. This is the first step towards having a slice output feature, which will allow users to output only a slice or a region of the domain. [#1612](https://github.com/chaos-polymtl/lethe/pull/1612)

### [Master] - 2025-08-08

### Fixed 

- MINOR The mortar update was not accounting for the updated constraints when rotating the mesh, and the initial condition was being erased when updating the mortar information. This has been fixed. This PR also changes the way msh files are read, so that two separate rotor/stator meshes are taken as input (the same way it was done for dealii grids). [#1614](https://github.com/chaos-polymtl/lethe/pull/1614)


- MINOR Account for a reference rotation in the mortar coupling manager. This is nedded for cases where the initial mesh contain cells with edges not aligned with the x axis. [#1611](https://github.com/chaos-polymtl/lethe/pull/1611)

### [Master] - 2025-08-07

### Fixed

- MINOR Although Lethe can be configured without METIS, there would be nothing to indicate to the user that a parallel simulation without METIS would not work if a simplex mesh was used. This PR adds this assertion and also fixes some issues with some nullptr that were lying around there and there and could prevent compilation. [#1610](https://github.com/chaos-polymtl/lethe/pull/1610)

### [Master] - 2025-07-31

### Added

- MINOR Add a prototype for HP-refinement. In HP-refinement, both the mesh (h-refinement) and the polynomial degree of the shape functions of a cell (p-refinement) can be modified to provide a better approximation of the solution. [#1608](https://github.com/chaos-polymtl/lethe/pull/1608)

### Added

- MINOR Refactors the way the initial conditions smoothing for VOF can be applied. On top of the diffusive smoothing, a new approach can be used to set up the initial condition using geometric redistanciation. This is great when using the geometric redistanciation strategy since the interface remains defined coherently throughout the simulation. [#1602](https://github.com/chaos-polymtl/lethe/pull/1602)

### [Master] - 2025-08-05

### Fixed

- MINOR The rotate_mapping() function was only implemented for 2D rotation; this PR adds the option for 3D rotation. [#1605](https://github.com/chaos-polymtl/lethe/pull/1605)

### [Master] - 2025-08-01

### Added

- MINOR This PR adds a mortar Arbitrary Lagrangian Eulerian (ALE) asssembler to allow the simulation of rotor-stator transient problems. [#1597](https://github.com/chaos-polymtl/lethe/pull/1597)
### [Master] - 2025-07-31

### Fixed

- MINOR Add "max refinement level" parameter to "uniform" mesh adaptation method. Before, transient simulations would have meshes being refined indefinitely. This PR fixes this, adds an application test, and adds an assertion to avoid the use of uniform mesh adaptation with simplex meshes. [#1599](https://github.com/chaos-polymtl/lethe/pull/1599)

### Fixed

- MINOR Remove some compilation warning in some of the unit tests for mortar and core. [#1601](https://github.com/chaos-polymtl/lethe/pull/1601)

### [Master] - 2025-07-25

### Added

- MINOR A feature that allows to log the particle-wall collision statistics in a .csv or a .dat file is added. The time, velocity and angular velocity at the start and at the end of a collision are logged for each collision between a particle and the boundary id(s) specified in the .prm file. [#1586](https://github.com/chaos-polymtl/lethe/pull/1586)

### Added

- MINOR The DG tracer implementation was not very good for pure advection equations since the high-order implementation did not have a limiter. This PR implements a Moe limiter that works for all scalar equations with DG. This is especially useful for the DG Tracer implementation and will be tested for the DG VOF implementation in the future. [#1595](https://github.com/chaos-polymtl/lethe/pull/1595)

### [Master] - 2025-07-23

### Fixed

- MINOR The default insertion frequency was causing a segmentation fault when using the DEM solver (division by zero when set unchanged). This PR adds an "if" statement that checks if this insertion frequency is equal to 0. [#1593](https://github.com/chaos-polymtl/lethe/pull/1593)

### [Master] - 2025-07-21

### Changed

- MINOR The QCM calculation method for the void fraction had multiple chunks of code which were duplicated. This PR refactors the QCM to make an additional use of functions and greatly simplifies the code. Nothing is changed in the way the calculations are made. [#1591](https://github.com/chaos-polymtl/lethe/pull/1591)

### [Master] - 2025-07-20

### Fixed

- MAJOR Deal.II-9.8pre deprecates some functions such as get_communicator and the parallel::distributed::SolutionTransfer class. This PR uses the modern version of these functions or classes following the new 9.8 release standard before they are deprecated. This PR officially deprecates the compatibility with deal.II 9.6.0.  [#1589](https://github.com/chaos-polymtl/lethe/pull/1589)

### Changed

- MINOR At multiple locations and for specific features, Lethe was still checking if deal.II was compiled with a version number larger than 9.4. Since we do not even compile with anything before deal.II 9.6, this PR removes all of these checks which are not relevant anymore. This increases readability and prevents confusion in terms of compatibility. [#1588](https://github.com/chaos-polymtl/lethe/pull/1588)

### [Master] - 2025-07-17

### Added

- MINOR Allow quad/hex meshes to use bubble enrichment function FE_Q_Bubbles. [#1584](https://github.com/chaos-polymtl/lethe/pull/1584)

### [Master] - 2025-07-16

### Changed

- MINOR Lethe could not be compiled when deal.II was using 64 bit indices due to some locations where unsigned int were used instead of types::global_dof_index. This PR fixes this by using the correct type. It compiles with deal.II with 64bit indices. [#1585](https://github.com/chaos-polymtl/lethe/pull/1585)

### [Master] - 2025-07-14

### Changed

- MAJOR The introduction of the deal.II-9.8-pre version introduced numerous warnings for functions that will be deprecated in the near future. This PR addresses all of these warnings. Furthermore, I reran all of the prototypes and realized there was an issue with the matrix_free_non_linear prototype in which the multigrid solution did not have their ghost value correctly calculated. I have addressed this issue at the same time. Finally, on my machine I encountered a small segfault when running the kelly error estimator with multiple variables. This is because the solver assumed the number of coarsen and refine flag would be the same in the for loop, while there is no reason for this assumption. I have thus fixed this problem within this PR also. [#1582](https://github.com/chaos-polymtl/lethe/pull/1582)

### [Master] - 2025-07-13

### Changed

- MAJOR The void fraction linear tolerance can now be specified directly within the .prm file. The previous default value which was 1e-15 has now been changed to the default value used for all linear solvers. We advise users to explicitely specify the minimum tolerance for the void fraction within their parameter files. [#1580](https://github.com/chaos-polymtl/lethe/pull/1580)

### [Master] - 2025-07-11

### Fixed

- MINOR The rotor mesh rotation was not in the right place in the code, so that at the start of the simulation the accessed mapping information was still incorrect. This PR fixes this, and adds an application test for a rotor rotated mesh. [#1579](https://github.com/chaos-polymtl/lethe/pull/1579)

### Added

- MINOR Removes the old gas-solid-spouted-bed example which has now been replaced with the much better gas-solid-spouted-rectangular-bed. The newer example features validation and other components which make it significnatly more relevant than the previous one which just displayed the capabilities of the solver. [#1578](https://github.com/chaos-polymtl/lethe/pull/1578)

### Added

- MINOR Dynamic particle insertion in CFD-DEM functionality is added using the insertion methods defined for DEM. [#1576](https://github.com/chaos-polymtl/lethe/pull/1576)

### [Master] - 2025-07-10

### Added

- MAJOR A new example consisting in the 3d simulation of the turbulent flow around a cylinder at Re=3900 has been added. The example includes several comparison with the literature including the drag coefficient, the Strouhal number and the pressure profile around the cylinder for several meshes and orders of convergence. The example will be extended in the near future to include additional validation metric such as the time-averaged velocity and reynolds stresses at serveral locations behind the cylinder. [#1570](https://github.com/chaos-polymtl/lethe/pull/1570)

# [Master] - 2025-07-08

### Fixed

- MINOR The center of rotation of the rotor was not being accounted for in the MortarManagerBase, which has been fixed. Two application tests for a MMS with mortar have also been added. [#1575](https://github.com/chaos-polymtl/lethe/pull/1575)

## [Master] - 2025-07-03

### Added

- MINOR Add tailored capability for validation script to run on Lucille (a compute node) and re-adapt rising bubble case. [#1574](https://github.com/chaos-polymtl/lethe/pull/1574)

## [Master] - 2025-07-07

### Changed

- MINOR The default parameter for the linear solver of the matrix-free solvers now uses eigenvalue estimation instead of not. This approach is generally more robust and should be preferred. [#1572](https://github.com/chaos-polymtl/lethe/pull/1572)

## [Master] - 2025-07-03

### Added

- MINOR Add functionality that allows to delete previous vtu and pvd files by using a flag '-R'. [#1569](https://github.com/chaos-polymtl/lethe/pull/1569)

## [Master] - 2025-06-30

### Added

- MINOR The surface area computation of the interface was added in this PR for VOF simulations when mass conservation monitoring is enable. For that, the NonMatching FEValues features of deal.II are used. Additionally, the geometric volume computation was changed to use the same features. [#1562](https://github.com/chaos-polymtl/lethe/pull/1562)

## [Master] - 2025-06-26

### Added

- MINOR This PR adds an Multiphysic DEM example that simulates the heating of a packed bed. It is based on the experimental and simulation results of Beaulieu with stainless steel particles. [#1561](https://github.com/chaos-polymtl/lethe/pull/1561)

## [Master] - 2025-06-25

### Added

- MAJOR This PR implements the coupling of the mortar method with the Navier-Stokes matrix-based solver. An application test of a Taylor-Couette flow has been added, where a mortar interface binds two hyper_shell geometries. [#1563](https://github.com/chaos-polymtl/lethe/pull/1563)

## [Master] - 2025-06-19

### Added

- MINOR This PR extends the rising bubble example with the addition of a second test case and the comparison of the regularization methods implemented in Lethe. It also documents the geometric reinitialization method in the parameters section and the theory guide. [#1558](https://github.com/chaos-polymtl/lethe/pull/1558)

## [Master] - 2025-06-16

### Fixed

- MINOR The function defining zero_constraints considered the types noslip, function, and none in the same else case. This has been fixed so that none is indeed a "do-nothing" boundary condition. [#1557](https://github.com/chaos-polymtl/lethe/pull/1557)

### Added

- MAJOR The geometric redistanciation method had only a tanh transformation to go from the signed distance to the phase fraction. With it, it is difficult (technically impossible) to clamp the value of the phase fraction indicator to 0 and 1 away from the interface. To get close, the max redistanciation distance must be increased leading to higher computational cost. Hence, a 4th degree piecewise polynomial transformation is added in this PR. It clamps the phase fraction to 0 or 1 at +/- the max redistanciation distance and it has a smooth change from 0 to 1. This PR also improves the treatment of the level-set field and the iso-level in the VOF and SignedDistanceSolver implementation. [#1546](https://github.com/chaos-polymtl/lethe/pull/1546)

## [Master] - 2025-06-15

### Fixed

- MINOR Add capability to calculate the void fraction in the matrix-free vans solver using information drawn from a particle handler instead of just a function. This is a minor extension that re-uses the feature of the regular VANS implementation. [#1556](https://github.com/chaos-polymtl/lethe/pull/1556)

## [Master] - 2025-06-13

### Fixed

- MINOR Fixed bug with constrained indices and edge constrained indices in the functions required by the operator when using local smoothing geometric multigrid in the matrix-free application. Added a cylinder test with kelly error estimator to avoid this in the future. [#1555](https://github.com/chaos-polymtl/lethe/pull/1555)

## [Master] - 2025-06-12

### Fixed

- MINOR Fixed restarts in CFD-DEM simulations with Lagrangian post-processing enabled. The checkpointing file for the pvd file was not named correctly. This has now been corrected to ensure consistency. [#1552](https://github.com/chaos-polymtl/lethe/pull/1552)

### Added

- MINOR Added a simple first multiphysic DEM example that consists of lined up particles that are heated by others or by a wall. It verifies the models of particle-particle and particle-wall heat transfer using two simple test cases. This PR also adds dem-mp in the documentation and examples directories. [#1548](https://github.com/chaos-polymtl/lethe/pull/1548)

- MINOR Added initial support for the dynamic flow control in lethe-fluid-sharp. Beta force particle is still missing from the calculation. [#1553] (https://github.com/chaos-polymtl/lethe/pull/1553)

## [Master] - 2025-06-11

### Fixed

- MINOR Added support for the box refinement in the matrix-free solver. [#1551](https://github.com/chaos-polymtl/lethe/pull/1551)

## [Master] - 2025-06-05

### Added

- MAJOR Added the calculation of particle-wall heat transfer and the updating of the temperature of solid objects when needed.
A parameter real_youngs_modulus is added, to be used for Multiphysic DEM when the Young's modulus is underestimated in the simulation.
A parameter disable_position_integration is also added to be able to freeze the position of particles. [#1542](https://github.com/chaos-polymtl/lethe/pull/1542)
