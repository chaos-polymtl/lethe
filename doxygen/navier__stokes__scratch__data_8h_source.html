<!-- HTML header for doxygen 1.9.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Lethe Open-Source Library: /home/runner/work/lethe/lethe/include/solvers/navier_stokes_scratch_data.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/x-icon" href="lethe_favicon.ico"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="lethe-logo-with-bkgd.png"/></td>
  <td id="projectalign">
   <div id="projectname">Lethe Open-Source Library
   </div>
   <div id="projectbrief">Developer Guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_949292de90bec6ca0ef87cb838b26113.html">solvers</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">navier_stokes_scratch_data.h</div></div>
</div><!--header-->
<div class="contents">
<a href="navier__stokes__scratch__data_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// SPDX-FileCopyrightText: Copyright (c) 2021-2025 The Lethe Authors</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception OR LGPL-2.1-or-later</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#ifndef lethe_navier_stokes_scratch_data_h</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#define lethe_navier_stokes_scratch_data_h</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;<a class="code" href="bdf_8h.html">core/bdf.h</a>&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;<a class="code" href="dem__properties_8h.html">core/dem_properties.h</a>&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;<a class="code" href="parameters_8h.html">core/parameters.h</a>&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;<a class="code" href="physical__property__model_8h.html">core/physical_property_model.h</a>&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &lt;<a class="code" href="sdirk__stage__data_8h.html">core/sdirk_stage_data.h</a>&gt;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;<a class="code" href="time__integration__utilities_8h.html">core/time_integration_utilities.h</a>&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;<a class="code" href="cahn__hilliard__filter_8h.html">solvers/cahn_hilliard_filter.h</a>&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;<a class="code" href="physical__properties__manager_8h.html">solvers/physical_properties_manager.h</a>&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;<a class="code" href="physics__scratch__data_8h.html">solvers/physics_scratch_data.h</a>&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &lt;<a class="code" href="vof__filter_8h.html">solvers/vof_filter.h</a>&gt;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;deal.II/base/quadrature.h&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span> </div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &lt;deal.II/dofs/dof_renumbering.h&gt;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span> </div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &lt;deal.II/fe/fe_system.h&gt;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span> </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &lt;deal.II/numerics/vector_tools.h&gt;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span> </div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &lt;deal.II/particles/particle_handler.h&gt;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespacedealii.html">dealii</a>;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment"></span> </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">/**</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment"> * @brief Class that stores the information required by the assembly procedure</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment"> * for a Navier-Stokes equation. Consequently, this class calculates</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment"> * the velocity (values, gradients, laplacians) and the shape function</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment"> * (values, gradients, laplacians) at all the gauss points for all degrees</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment"> * of freedom and stores it into arrays. Additionally, the use can request</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment"> * that this class gathers additional fields for physics which are coupled</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment"> * to the Navier-Stokes equation, such as the VOF. This class</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="comment"> * serves as a separation between the evaluation at the gauss point of the</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="comment"> * variables of interest and their use in the assembly, which is carried out</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="comment"> * by the assembler functions. For more information on this design, the reader</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="comment"> * can consult deal.II step-9</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="comment"> * &quot;https://www.dealii.org/current/doxygen/deal.II/step_9.html&quot;. In this latter</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="comment"> * example, the scratch is a struct instead of a templated class because of the</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment"> * simplicity of step-9.</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment"> *</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="comment"> * @tparam dim An integer that denotes the dimension of the space in which</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="comment"> * the flow is solved</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="comment"> *</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="comment"> * @ingroup solvers</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="comment"> **/</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="foldopen" id="foldopen00054" data-start="{" data-end="};">
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html">   54</a></span><span class="keyword">class </span><a class="code hl_class" href="classNavierStokesScratchData.html">NavierStokesScratchData</a> : <span class="keyword">public</span> <a class="code hl_class" href="classPhysicsScratchDataBase.html">PhysicsScratchDataBase</a></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>{</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="comment">   * @brief Constructor. The constructor creates the fe_values that will be used</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">   * to fill the member variables of the scratch. It also allocated the</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="comment">   * necessary memory for all member variables. However, it does not do any</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="comment">   * evaluation, since this needs to be done at the cell level.</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span><span class="comment">   *</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="comment">   * @param simulation_control The SimulationControl object that holds</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">   * information related to the control of the steady-state or transient</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">   * simulation. This is used to extrapolate auxiliary physics solutions in time</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment">   * for transient simulation.</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="comment">   *</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment">   * @param properties_manager The PhysicalPropertiesManager object that stores</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="comment">   * physical property models.</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment">   *</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment">   * @param fe The FESystem used to solve the Navier-Stokes equations</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment">   *</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="comment">   * @param quadrature The quadrature to use for the assembly</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">   *</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">   * @param mapping The mapping of the domain in which the Navier-Stokes</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">   * equations are solved</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="comment">   */</span></div>
<div class="foldopen" id="foldopen00078" data-start="{" data-end="}">
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a170bd84860356dfd01caf5fc3287eec8">   78</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a170bd84860356dfd01caf5fc3287eec8">NavierStokesScratchData</a>(</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="keyword">const</span> std::shared_ptr&lt;SimulationControl&gt; &amp;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>,</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="keyword">const</span> <a class="code hl_class" href="classPhysicalPropertiesManager.html">PhysicalPropertiesManager</a>          &amp;<a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>,</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keyword">const</span> FESystem&lt;dim&gt;                      &amp;fe,</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;                    &amp;quadrature,</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="keyword">const</span> Mapping&lt;dim&gt;                       &amp;mapping,</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keyword">const</span> Quadrature&lt;dim - 1&gt;                &amp;face_quadrature)</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    : <a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>(<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>)</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>(<a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>)</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>(mapping,</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>                fe,</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>                quadrature,</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>                update_values | update_quadrature_points | update_JxW_values |</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>                  update_gradients | update_hessians)</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>(mapping,</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>                     fe,</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>                     face_quadrature,</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>                     update_values | update_quadrature_points |</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>                       update_JxW_values | update_gradients | update_hessians |</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>                       update_normal_vectors)</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c">sdirk_table</a>(<a class="code hl_function" href="time__integration__utilities_8h.html#aa978da869c242558658db8bf49e8568e">is_sdirk</a>(<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>-&gt;get_assembly_method()) ?</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>                    ::<a class="code hl_variable" href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c">sdirk_table</a>(<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>-&gt;get_assembly_method()) :</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>                    <a class="code hl_struct" href="structSDIRKTable.html">SDIRKTable</a>())</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  {</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#ad98b8bde0f425d5269cde4132d5cdfd3">allocate</a>();</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span> </div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="comment">// By default, the assembly of variables belonging to auxiliary physics is</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="comment">// disabled.</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>                               = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a3ea0ab72226feac5c12b4c018b2e7672">gather_projected_phase_fraction_gradient</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990">gather_curvature</a>                         = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">gather_void_fraction</a>                     = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76">gather_particles_information</a>             = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ac45b659821eec6e1fa6c8ecd2cae5415">gather_temperature</a>                       = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a80675043762c14c602da2c651248d2c6">gather_cahn_hilliard</a>                     = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a0bd069ab2a2e317dcfb1f506b0041a50">gather_mortar</a>                            = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">gather_hessian</a> = <a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>.<a class="code hl_function" href="classPhysicalPropertiesManager.html#a62c83e5e2c38c581718752435b46e0f1">is_non_newtonian</a>();</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  }</div>
</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span><span class="comment"></span> </div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span><span class="comment">   * @brief Copy Constructor. Same as the main constructor.</span></div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span><span class="comment">   * This constructor only uses the other scratch to build the FeValues, it</span></div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="comment">   * does not copy the content of the other scratch into itself since, by</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span><span class="comment">   * definition of the WorkStream mechanism it is assumed that the content of</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="comment">   * the scratch will be reset on a cell basis.</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span><span class="comment">   *</span></div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span><span class="comment">   * @param sd The scratch data to be copied</span></div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span><span class="comment">   */</span></div>
<div class="foldopen" id="foldopen00126" data-start="{" data-end="}">
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a05a68c1d47ea11eeea610580e93f1d0e">  126</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a05a68c1d47ea11eeea610580e93f1d0e">NavierStokesScratchData</a>(<span class="keyword">const</span> <a class="code hl_class" href="classNavierStokesScratchData.html">NavierStokesScratchData&lt;dim&gt;</a> &amp;sd)</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    : <a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>)</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>)</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_mapping(),</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>                sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_fe(),</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>                sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_quadrature(),</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>                update_values | update_quadrature_points | update_JxW_values |</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>                  update_gradients | update_hessians)</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.get_mapping(),</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>                     sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.get_fe(),</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>                     sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.get_quadrature(),</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>                     update_values | update_quadrature_points |</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>                       update_JxW_values | update_gradients | update_hessians |</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>                       update_normal_vectors)</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    , <a class="code hl_variable" href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c">sdirk_table</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c">sdirk_table</a>)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>  {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#ad98b8bde0f425d5269cde4132d5cdfd3">allocate</a>();</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="comment">// By default, the assembly of variables belonging to auxiliary physics is</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="comment">// disabled.</span></div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>                               = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a3ea0ab72226feac5c12b4c018b2e7672">gather_projected_phase_fraction_gradient</a> = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990">gather_curvature</a>                         = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">gather_void_fraction</a>                     = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76">gather_particles_information</a>             = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ac45b659821eec6e1fa6c8ecd2cae5415">gather_temperature</a>                       = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a80675043762c14c602da2c651248d2c6">gather_cahn_hilliard</a>                     = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a0bd069ab2a2e317dcfb1f506b0041a50">gather_mortar</a>                            = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">gather_hessian</a> = <a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>.<a class="code hl_function" href="classPhysicalPropertiesManager.html#a62c83e5e2c38c581718752435b46e0f1">is_non_newtonian</a>();</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>)</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#aa3ac2a1e98dd07b62ee49f808642ce09">enable_vof</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>                 sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_quadrature(),</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>                 sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_mapping(),</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                 sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a49f74b732d4b2321493338e2d84a9911">filter</a>);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a3ea0ab72226feac5c12b4c018b2e7672">gather_projected_phase_fraction_gradient</a>)</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a6937a49938e44bf91ff473c99e176561">enable_projected_phase_fraction_gradient</a>(</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>        sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e">fe_values_projected_phase_fraction_gradient</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>        sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e">fe_values_projected_phase_fraction_gradient</a>-&gt;get_quadrature(),</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>        sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e">fe_values_projected_phase_fraction_gradient</a>-&gt;get_mapping());</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990">gather_curvature</a>)</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a9f3a9b09303fb38071eba70e6392dc0c">enable_curvature</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">fe_values_curvature</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>                       sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">fe_values_curvature</a>-&gt;get_quadrature(),</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>                       sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">fe_values_curvature</a>-&gt;get_mapping());</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">gather_void_fraction</a>)</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a2c271b97942ba7a74d7f4e9e0c545b6b">enable_void_fraction</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_quadrature(),</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_mapping());</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76">gather_particles_information</a>)</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a661e62ccc078b9798322641b2c56655c">enable_particle_fluid_interactions</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a204a64dc7ede58da66f4b8b3879df7bf">max_number_of_particles_per_cell</a>,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                                         sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a50e47e5746c3b8e513d798318938235b">interpolated_void_fraction</a>);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ac45b659821eec6e1fa6c8ecd2cae5415">gather_temperature</a>)</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a59bab3e52c8e29cf84473965f49baefe">enable_heat_transfer</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_quadrature(),</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_mapping());</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a80675043762c14c602da2c651248d2c6">gather_cahn_hilliard</a>)</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a126d7e05decf1cd0ab526d786a86e1af">enable_cahn_hilliard</a>(sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;get_quadrature(),</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;get_mapping(),</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>                           sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a9a9121f92c46736d4be8b92933fb6874">cahn_hilliard_filter</a>);</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="keywordflow">if</span> (sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#a0bd069ab2a2e317dcfb1f506b0041a50">gather_mortar</a>)</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#a51cadf33b64ca212d6b49e6bfa7be9e1">enable_mortar</a>();</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">gather_hessian</a> = sd.<a class="code hl_variable" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">gather_hessian</a>;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  }</div>
</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="comment"></span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span><span class="comment">   * @brief Allocates the memory for the scratch</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="comment">   *</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="comment">   * This function allocates the necessary memory for all members of the scratch</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="comment">   */</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#ad98b8bde0f425d5269cde4132d5cdfd3">allocate</a>() <span class="keyword">override</span>;</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment"></span> </div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span><span class="comment">   * @brief Reinitializes the content of the scratch.</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span><span class="comment">   *</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span><span class="comment">   * Using the FeValues and the content of the solutions and previous solutions,</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span><span class="comment">   * fills all of the class member of the scratch.</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span><span class="comment">   *</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span><span class="comment">   * @param[in] cell The cell over which the assembly is being carried.</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span><span class="comment">   * This cell must be compatible with the FE which is used to fill the</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="comment">   * FeValues.</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span><span class="comment">   *</span></div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span><span class="comment">   * @param[in] current_solution The present value of the solution for [u,p].</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span><span class="comment">   *</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span><span class="comment">   * @param[in] previous_solutions The solutions at the previous time steps.</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span><span class="comment">   *</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span><span class="comment">   * @param[in] forcing_function The function describing the momentum/mass</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span><span class="comment">   * source term.</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span><span class="comment">   *</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="comment">   * @param[in] beta_force The additional force for flow control.</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span><span class="comment">   * TODO : Deprecate this argument and pass it to the constructor of the</span></div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment">   * assembler</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="comment">   */</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00225" data-start="{" data-end="}">
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a991574ac5b97689773fd0108eeab24a0">  225</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a991574ac5b97689773fd0108eeab24a0">reinit</a>(<span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;cell,</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>         <span class="keyword">const</span> VectorType                                     &amp;current_solution,</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>         <span class="keyword">const</span> std::vector&lt;VectorType&gt; &amp;previous_solutions,</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>         <span class="keyword">const</span> VectorType              &amp;sum_over_previous_stages,</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>         std::shared_ptr&lt;Function&lt;dim&gt;&gt; forcing_function,</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>         Tensor&lt;1, dim&gt;                 <a class="code hl_variable" href="classNavierStokesScratchData.html#aefffdd294c642100ea21ba30aea5d185">beta_force</a>,</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>         <span class="keyword">const</span> <span class="keywordtype">double</span>                   <a class="code hl_variable" href="classNavierStokesScratchData.html#a24846172d49e366a6d0fed30df1213fd">pressure_scaling_factor</a>)</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.reinit(cell);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span> </div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a6aa64fd685358a4990eb37189602d20f">quadrature_points</a> = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_quadrature_points();</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>    <span class="keyword">auto</span> &amp;fe          = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_fe();</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    forcing_function-&gt;vector_value_list(<a class="code hl_variable" href="classNavierStokesScratchData.html#a6aa64fd685358a4990eb37189602d20f">quadrature_points</a>, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad824df2b7790211977cea193a1810af8">rhs_force</a>);</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span> </div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="comment">// Establish the force vector</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ab297c915f78a5aa41da5f0f1a476944f">n_q_points</a>; ++q)</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>      {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>          {</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_i =</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>              fe.system_to_component_index(d).first;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a132a5f0c61439d03594e00c5052b27fe">force</a>[q][d] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad824df2b7790211977cea193a1810af8">rhs_force</a>[q](component_i);</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>          }</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_mass =</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>          fe.system_to_component_index(dim).first;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0c71709046272d72203fbe735e40e0f4">mass_source</a>[q] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad824df2b7790211977cea193a1810af8">rhs_force</a>[q](component_mass);</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span> </div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>        <span class="comment">// Correct force to include the dynamic forcing term for flow</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        <span class="comment">// control</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a132a5f0c61439d03594e00c5052b27fe">force</a>[q] = <a class="code hl_variable" href="classNavierStokesScratchData.html#a132a5f0c61439d03594e00c5052b27fe">force</a>[q] + <a class="code hl_variable" href="classNavierStokesScratchData.html#aefffdd294c642100ea21ba30aea5d185">beta_force</a>;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>      }</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k : <a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.dof_indices())</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>      {</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a4b89c62b025b47447f51e9eea1bc2480">components</a>[k] = fe.system_to_component_index(k).first;</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      }</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span> </div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>    <span class="comment">// Compute cell diameter</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="keywordtype">double</span> cell_measure =</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      <a class="code hl_function" href="utilities_8h.html#a3d02cb065c32b672c94bb862ecff4431">compute_cell_measure_with_JxW</a>(this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_JxW_values());</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a9b57679638ab4f0b90a3d7e2c7c2c32c">cell_size</a> = compute_cell_diameter&lt;dim&gt;(cell_measure, fe.degree);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="comment">// For the SDIRK methods, \sum_{j=1}^{i-1} a_{ij} k_j is needed for the</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <span class="comment">// assembler</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>-&gt;is_sdirk())</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      {</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_values(</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>          sum_over_previous_stages, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0d6c54e17e2e5dc31f8e8d1e2bfe30e7">sdirk_stage_sum</a>);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      }</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span> </div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <span class="comment">// Gather velocity (values, gradient and laplacian)</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_values(current_solution,</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>                                                    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8a93306de6e1cd56c819318e8253f2a5">velocity_values</a>);</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_gradients(</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a566544b2f37645bd28a94073e42caf94">velocity_gradients</a>);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_laplacians(</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>      current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#af76efde9fb25c3d5174fafda67d91307">velocity_laplacians</a>);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">gather_hessian</a>)</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>      this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_hessians(</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a2a598e7c026ac4edd8c7b95c188b64b1">velocity_hessians</a>);</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span> </div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ab297c915f78a5aa41da5f0f1a476944f">n_q_points</a>; ++q)</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>      {</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#adc5876c2ab3a6358caac55eacd49b6df">velocity_divergences</a>[q] = trace(this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a566544b2f37645bd28a94073e42caf94">velocity_gradients</a>[q]);</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>      }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    <span class="comment">// Gather pressure (values, gradient)</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].get_function_values(current_solution,</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                                            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0d32755f9533006a0c28c61b594f4b0f">pressure_values</a>);</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].get_function_gradients(current_solution,</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                                               this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#af329e1c369385dbdd3cb044f23aeda0f">pressure_gradients</a>);</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>    this-&gt;pressure_scaling_factor = <a class="code hl_variable" href="classNavierStokesScratchData.html#a24846172d49e366a6d0fed30df1213fd">pressure_scaling_factor</a>;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; previous_solutions.size(); ++p)</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>      {</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_values(</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>          previous_solutions[p], <a class="code hl_variable" href="classNavierStokesScratchData.html#a35e6cecb73b9e5a9d2576b8208c77da8">previous_velocity_values</a>[p]);</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>      }</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    <span class="comment">// Only gather the pressure when a pressure history is necessary</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <span class="comment">// (compressible Navier-Stokes)</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="keywordflow">if</span> (!this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>.<a class="code hl_function" href="classPhysicalPropertiesManager.html#a4fbf4cde6182467899c9cfab9a4bfdb0">density_is_constant</a>())</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; previous_solutions.size(); ++p)</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        {</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].get_function_values(</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>            previous_solutions[p], <a class="code hl_variable" href="classNavierStokesScratchData.html#a425e384b23005541ab442a50b49560f4">previous_pressure_values</a>[p]);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>        }</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span> </div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ab297c915f78a5aa41da5f0f1a476944f">n_q_points</a>; ++q)</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>      {</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a405da43dc1730f5de1a5a3683202ddbd">JxW</a>[q] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.JxW(q);</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>; ++k)</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>          {</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="comment">// Velocity</span></div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a70fd7e5971c2481ba307bc08f90f60b0">phi_u</a>[q][k] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].value(k, q);</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b858fcc61c20c7b3ca24253741b39eb">div_phi_u</a>[q][k] =</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>              this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].divergence(k, q);</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a95349c742f9be9d55490462c30a1c9fb">grad_phi_u</a>[q][k] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].gradient(k, q);</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a981c3e639a7e753c867a48d835f2b9b9">hess_phi_u</a>[q][k] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].hessian(k, q);</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>              this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aa02f906b4d33a632cd21d38eefff32ce">laplacian_phi_u</a>[q][k][d] = trace(this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a981c3e639a7e753c867a48d835f2b9b9">hess_phi_u</a>[q][k][d]);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            <span class="comment">// Pressure</span></div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a32458393ad0bd016416c85b53a285013">phi_p</a>[q][k]      = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].value(k, q);</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>            this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae38cfc270e721ef6a4de6db34dbe7e12">grad_phi_p</a>[q][k] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].gradient(k, q);</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>          }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>      }</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a26944c6375322a4ad03b51b959f5b3f6">is_boundary_cell</a> = cell-&gt;at_boundary();</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classNavierStokesScratchData.html#a26944c6375322a4ad03b51b959f5b3f6">is_boundary_cell</a>)</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>      {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>          = cell-&gt;n_faces();</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a85c0cf98990e2f944e1043a13577d78b">is_boundary_face</a> = std::vector&lt;bool&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a> = <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.get_quadrature().size();</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#acc2f4cf7c08898d8ff4172e2e07ce260">boundary_face_id</a> = std::vector&lt;unsigned int&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a1800b777a5f6ee949f4bd19632f8dbd9">face_JxW</a>.reinit(<a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>);</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>        <span class="comment">// Velocity and pressure values</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>        <span class="comment">// First vector is face number, second quadrature point</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aa10f5197d2a06f1d40525bdf8493d8c6">face_velocity_values</a> = std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt;(</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;Tensor&lt;1, dim&gt;&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#adf8f8020ea98df223151cccd92a2e738">face_velocity_divergences</a> = std::vector&lt;std::vector&lt;double&gt;&gt;(</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;double&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae190c0101083553dafc546b98b300ce6">face_velocity_gradients</a> =</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>          std::vector&lt;std::vector&lt;Tensor&lt;2, dim&gt;&gt;&gt;(</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;Tensor&lt;2, dim&gt;&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span> </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a33b670f69579168534803ca45effeecd">face_velocity_laplacians</a> =</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>          std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt;(</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;Tensor&lt;1, dim&gt;&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span> </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aebfc11a2eade6b515242a0f09275fac0">face_pressure_values</a> = std::vector&lt;std::vector&lt;double&gt;&gt;(</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;double&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ab6df2938e916f981c39c1deaacbe4d03">face_pressure_gradients</a> =</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>          std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt;(</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;Tensor&lt;1, dim&gt;&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span> </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0a08bcb3a530d7517edf64c72dbdc28a">face_normal</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>);</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#af0c85dd1b4866fb1c70c2cf5de3281b1">face_quadrature_points</a> = std::vector&lt;std::vector&lt;Point&lt;dim&gt;&gt;&gt;(</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>, std::vector&lt;Point&lt;dim&gt;&gt;(<a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>));</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8d7c491f60dacd4d624b3665e4e4372c">face_div_phi_u</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#abd334c0baa72b939278f4b2869371414">face_phi_u</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a6fb8903e517afdf6ae84667e6dc118ff">face_hess_phi_u</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae20f109ee3fd7a5ed525a1ba76a4e759">face_laplacian_phi_u</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a2a341602a56ab835dd59c54126be6734">face_grad_phi_u</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a14f88c10c2002a41a49cda82e5575d25">face_phi_p</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#adbd62f1711f3edcf392271e9d0b4e6e6">face_grad_phi_p</a>.reinit(n_faces, <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>, <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>);</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> face : cell-&gt;face_indices())</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>          {</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a85c0cf98990e2f944e1043a13577d78b">is_boundary_face</a>[face] = cell-&gt;face(face)-&gt;at_boundary();</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classNavierStokesScratchData.html#a85c0cf98990e2f944e1043a13577d78b">is_boundary_face</a>[face])</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>              {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.reinit(cell, face);</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a> = <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.get_fe().n_dofs_per_cell();</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#acc2f4cf7c08898d8ff4172e2e07ce260">boundary_face_id</a>[face] = cell-&gt;face(face)-&gt;boundary_id();</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>                <span class="comment">// Shape functions</span></div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>                <span class="comment">// First vector is face number, second quadrature point, third</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>                <span class="comment">// DOF</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>                <span class="comment">// Gather velocity (values, gradient and laplacian)</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_values(</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>                  current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aa10f5197d2a06f1d40525bdf8493d8c6">face_velocity_values</a>[face]);</div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_gradients(</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>                  current_solution, this-&gt;face_velocity_gradients[face]);</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_laplacians(</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>                  current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a33b670f69579168534803ca45effeecd">face_velocity_laplacians</a>[face]);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>                <span class="comment">// Gather pressure (values, gradient)</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].get_function_values(</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>                  current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aebfc11a2eade6b515242a0f09275fac0">face_pressure_values</a>[face]);</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].get_function_gradients(</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>                  current_solution, this-&gt;face_pressure_gradients[face]);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span> </div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>; ++q)</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>                  {</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>                    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a1800b777a5f6ee949f4bd19632f8dbd9">face_JxW</a>[face][q] = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.JxW(q);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>                    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0a08bcb3a530d7517edf64c72dbdc28a">face_normal</a>[face][q] =</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>                      this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.normal_vector(q);</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>                    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#af0c85dd1b4866fb1c70c2cf5de3281b1">face_quadrature_points</a>[face][q] =</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>                      this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.quadrature_point(q);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>                    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k : <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>.dof_indices())</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                      {</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                        <span class="comment">// Velocity</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#abd334c0baa72b939278f4b2869371414">face_phi_u</a>[face][q][k] =</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].value(k, q);</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>                        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8d7c491f60dacd4d624b3665e4e4372c">face_div_phi_u</a>[face][q][k] =</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].divergence(k, q);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>                        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a2a341602a56ab835dd59c54126be6734">face_grad_phi_u</a>[face][q][k] =</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].gradient(k, q);</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>                        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a6fb8903e517afdf6ae84667e6dc118ff">face_hess_phi_u</a>[face][q][k] =</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].hessian(k, q);</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; dim; ++d)</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae20f109ee3fd7a5ed525a1ba76a4e759">face_laplacian_phi_u</a>[face][q][k][d] =</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                            trace(this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a6fb8903e517afdf6ae84667e6dc118ff">face_hess_phi_u</a>[face][q][k][d]);</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                        <span class="comment">// Pressure</span></div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>                        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a14f88c10c2002a41a49cda82e5575d25">face_phi_p</a>[face][q][k] =</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].value(k, q);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>                        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#adbd62f1711f3edcf392271e9d0b4e6e6">face_grad_phi_p</a>[face][q][k] =</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>                          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].gradient(k, q);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>                      }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>                  }</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>              }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>          }</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>      }</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>  }</div>
</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="comment"></span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span><span class="comment">   * @brief enable_vof Enables the collection of the VOF data by the scratch</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span><span class="comment">   *</span></div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span><span class="comment">   * @param fe FiniteElement associated with the VOF.</span></div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span><span class="comment">   *</span></div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span><span class="comment">   *</span></div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span><span class="comment">   *</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span><span class="comment">   * @param phase_filter_parameters Parameters for phase fraction filtering</span></div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span><span class="comment">   */</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#aa3ac2a1e98dd07b62ee49f808642ce09">enable_vof</a>(<span class="keyword">const</span> FiniteElement&lt;dim&gt;          &amp;fe,</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>             <span class="keyword">const</span> Quadrature&lt;dim&gt;             &amp;quadrature,</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>             <span class="keyword">const</span> Mapping&lt;dim&gt;                &amp;mapping,</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>             <span class="keyword">const</span> <a class="code hl_struct" href="structParameters_1_1VOF__PhaseFilter.html">Parameters::VOF_PhaseFilter</a> &amp;phase_filter_parameters);</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span><span class="comment"></span> </div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span><span class="comment">   * @brief enable_vof Enables the collection of the VOF data by the scratch - function overload used in the copy constructor of NavierStokesScratchData</span></div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="comment">   *</span></div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span><span class="comment">   * @param fe FiniteElement associated with the VOF.</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span><span class="comment">   *</span></div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span><span class="comment">   *</span></div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span><span class="comment">   *</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span><span class="comment">   * @param filter Filter that is applied on the phase fraction</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span><span class="comment">   */</span></div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#aa3ac2a1e98dd07b62ee49f808642ce09">enable_vof</a>(<span class="keyword">const</span> FiniteElement&lt;dim&gt;                       &amp;fe,</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>             <span class="keyword">const</span> Quadrature&lt;dim&gt;                          &amp;quadrature,</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>             <span class="keyword">const</span> Mapping&lt;dim&gt;                             &amp;mapping,</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>             <span class="keyword">const</span> std::shared_ptr&lt;VolumeOfFluidFilterBase&gt; &amp;<a class="code hl_variable" href="classNavierStokesScratchData.html#a49f74b732d4b2321493338e2d84a9911">filter</a>);</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a6937a49938e44bf91ff473c99e176561">enable_projected_phase_fraction_gradient</a>(</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>    <span class="keyword">const</span> FiniteElement&lt;dim&gt; &amp;fe_projected_phase_fraction_gradient,</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;    &amp;quadrature,</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <span class="keyword">const</span> Mapping&lt;dim&gt;       &amp;mapping);</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a9f3a9b09303fb38071eba70e6392dc0c">enable_curvature</a>(<span class="keyword">const</span> FiniteElement&lt;dim&gt; &amp;fe_curvature,</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                   <span class="keyword">const</span> Quadrature&lt;dim&gt;    &amp;quadrature,</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                   <span class="keyword">const</span> Mapping&lt;dim&gt;       &amp;mapping);</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span><span class="comment"></span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span><span class="comment">   * @brief Reinitialize the content of the scratch for the vof</span></div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span><span class="comment">   *</span></div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span><span class="comment">   * @param cell The cell over which the assembly is being carried.</span></div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span><span class="comment">   * This cell must be compatible with the VOF FE and not the</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span><span class="comment">   * Navier-Stokes FE</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span><span class="comment">   *</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span><span class="comment">   * @param current_solution The present value of the solution for [alpha]</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span><span class="comment">   *</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span><span class="comment">   * @param current_filtered_solution The present value of the solution for [alpha]_filtered</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span><span class="comment">   *</span></div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="comment">   * @param previous_solutions The solutions at the previous time steps for [alpha]</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span><span class="comment">   */</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00505" data-start="{" data-end="}">
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae83e521a115865e9bec668fc26be1e49">  505</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#ae83e521a115865e9bec668fc26be1e49">reinit_vof</a>(<span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;cell,</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>             <span class="keyword">const</span> VectorType              &amp;current_solution,</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>             <span class="keyword">const</span> VectorType              &amp;current_filtered_solution,</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>             <span class="keyword">const</span> std::vector&lt;VectorType&gt; &amp;previous_solutions)</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  {</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>    Assert(</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>,</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>      ExcMessage(</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <span class="stringliteral">&quot;You are trying to reinit the VOF model in a cell, but you did not enable VOF for the scratch data (gather_vof=false).&quot;</span>));</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;reinit(cell);</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>    <span class="comment">// Gather phase fraction (values, gradient)</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_function_values(current_solution,</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                                             this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a9acf89bc99f2fcfc1a454e0ffec12911">phase_values</a>);</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_function_values(current_filtered_solution,</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                                             this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad8eaa43dddfe9c8dd2d3fccdb1375062">filtered_phase_values</a>);</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_function_gradients(</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      current_filtered_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ab42fb46ce7737929c7b76f6faa1a8a86">filtered_phase_gradient_values</a>);</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_function_gradients(current_solution,</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>                                                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a402dc7a9c4c505cb09842b649fbf0c81">phase_gradient_values</a>);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span> </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>    <span class="comment">// Gather previous phase fraction values</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; previous_solutions.size(); ++p)</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>-&gt;get_function_values(previous_solutions[p],</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>                                                 <a class="code hl_variable" href="classNavierStokesScratchData.html#a077315d33bded4ae3e9f13b1541bbe3d">previous_phase_values</a>[p]);</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>      }</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  }</div>
</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span> </div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00536" data-start="{" data-end="}">
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0e506238dac667b6c23647eb1b237120">  536</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a0e506238dac667b6c23647eb1b237120">reinit_projected_phase_fraction_gradient</a>(</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                     &amp;projected_phase_fraction_gradient_cell,</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <span class="keyword">const</span> VectorType &amp;current_projected_phase_fraction_gradient_solution)</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>  {</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e">fe_values_projected_phase_fraction_gradient</a>-&gt;reinit(</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      projected_phase_fraction_gradient_cell);</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    FEValuesExtractors::Vector pfg(0);</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    <span class="comment">// Gather phase fraction gradient</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    (*fe_values_projected_phase_fraction_gradient)[pfg].get_function_values(</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>      current_projected_phase_fraction_gradient_solution,</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a77a8a872036804121a9eb9f73a23b7f5">projected_phase_fraction_gradient_values</a>);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  }</div>
</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00553" data-start="{" data-end="}">
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ada4d466d38ae48bee70c5b562e4a74af">  553</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#ada4d466d38ae48bee70c5b562e4a74af">reinit_curvature</a>(</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;curvature_cell,</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <span class="keyword">const</span> VectorType &amp;current_curvature_solution)</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  {</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    Assert(</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990">gather_curvature</a>,</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>      ExcMessage(</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        <span class="stringliteral">&quot;You are trying to reinit the curvature in a cell, but you did not enable curvature for the scratch data (gather_curvature=false).&quot;</span>));</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span> </div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">fe_values_curvature</a>-&gt;reinit(curvature_cell);</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span> </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <span class="comment">// Gather phase fraction gradient</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">fe_values_curvature</a>-&gt;get_function_values(current_curvature_solution,</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>                                                   this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a963f460a1a06ad5969f0ae5a21c2b5ca">curvature_values</a>);</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  }</div>
</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span><span class="comment"></span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span><span class="comment">   * @brief enable_void_fraction Enables the collection of the void fraction</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span><span class="comment">   * data by the scratch</span></div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span><span class="comment">   *</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span><span class="comment">   * @param fe FiniteElement associated with the void fraction</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span><span class="comment">   *</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span><span class="comment">   *</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span><span class="comment">   */</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span> </div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a2c271b97942ba7a74d7f4e9e0c545b6b">enable_void_fraction</a>(<span class="keyword">const</span> FiniteElement&lt;dim&gt; &amp;fe,</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>                       <span class="keyword">const</span> Quadrature&lt;dim&gt;    &amp;quadrature,</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>                       <span class="keyword">const</span> Mapping&lt;dim&gt;       &amp;mapping);</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span><span class="comment"></span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span><span class="comment">   *  @brief Reinitialize the content of the scratch for the void fraction</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span><span class="comment">   *</span></div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span><span class="comment">   * @param cell The cell over which the assembly is being carried.</span></div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span><span class="comment">   * This cell must be compatible with the void fraction FE and not the</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span><span class="comment">   * Navier-Stokes FE</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span><span class="comment">   *</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span><span class="comment">   * @param current_solution The present value of the solution for [epsilon]</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span><span class="comment">   *</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span><span class="comment">   * @param previous_solutions The solutions at the previous time steps for [epsilon]</span></div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span><span class="comment">   */</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00599" data-start="{" data-end="}">
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a59cf6c71f993b535281774fb63838cbd">  599</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a59cf6c71f993b535281774fb63838cbd">reinit_void_fraction</a>(</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;cell,</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    <span class="keyword">const</span> VectorType                                     &amp;current_solution,</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="keyword">const</span> std::vector&lt;VectorType&gt;                        &amp;previous_solutions)</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>  {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>    Assert(</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">gather_void_fraction</a>,</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>      ExcMessage(</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>        <span class="stringliteral">&quot;You are trying to reinit the void fraction in a cell, but you did not enable void fraction for the scratch data (gather_void_fraction=false).&quot;</span>));</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span> </div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;reinit(cell);</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span> </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <span class="comment">// Gather void fraction (values, gradient)</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_function_values(</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>      current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a732e9107c27d323f8d013e214dbcd223">void_fraction_values</a>);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_function_gradients(</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>      current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a2e37181c34de8b2712921a955fc7a5c2">void_fraction_gradient_values</a>);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span> </div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <span class="comment">// Gather previous void fraction fraction values</span></div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; previous_solutions.size(); ++p)</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>      {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>        this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_function_values(</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>          previous_solutions[p], <a class="code hl_variable" href="classNavierStokesScratchData.html#aa48c218f4f67db5887e6036756508bbd">previous_void_fraction_values</a>[p]);</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>      }</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>  }</div>
</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span><span class="comment"></span> </div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span><span class="comment">   * @brief enable_particle_fluid_interactions Enables the calculation of the fluid information at the particle location for the scratch.</span></div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span><span class="comment">   *</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="comment">   * @param fe FiniteElement associated with the void fraction</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span><span class="comment">   *</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span><span class="comment">   *</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span><span class="comment">   */</span></div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span> </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a661e62ccc078b9798322641b2c56655c">enable_particle_fluid_interactions</a>(</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_global_max_particles_per_cell,</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span>         enable_void_fraction_interpolation);</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span><span class="comment"></span> </div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span><span class="comment">   * @brief Reinitializes the fluid forces and torques on the particles in the cell to zero</span></div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span><span class="comment">   */</span></div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#ab059ac1bfc7ed0fc0f1540ead8fa59f0">reinit_particle_fluid_forces</a>();</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span><span class="comment"></span> </div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span><span class="comment">   * @brief Extracts the velocity of the particles and calculates their total volume</span></div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span><span class="comment">   * in the cell</span></div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span><span class="comment">   *</span></div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span><span class="comment">   * @return Total volume of the particles in the cell</span></div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span><span class="comment">   */</span></div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <span class="keywordtype">double</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#af8ac55b44d36bba2da5edb79754de69b">extract_particle_properties</a>();</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span><span class="comment"></span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span><span class="comment">   * @brief Computes the cell void fraction</span></div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><span class="comment">   *</span></div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span><span class="comment">   * @param[in] total_particle_volume The total volume of the particles in the</span></div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span><span class="comment">   * cell</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span><span class="comment">   */</span></div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#af72659fbca48ccb8a9a76fcacef290ee">calculate_cell_void_fraction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;total_particle_volume);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="comment"></span> </div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span><span class="comment">   * @brief Creates an object of type Quadrature&lt;dim&gt; that contains the</span></div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span><span class="comment">   * particle reference location. This object can be used to interpolate any</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span><span class="comment">   * function known at the dofs at the location of the particles.</span></div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span><span class="comment">   *</span></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span><span class="comment">   * @return Quadrature type object that contains the location of the particles</span></div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span><span class="comment">   * relative to the cell&#39;s frame of reference.</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span><span class="comment">   */</span></div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  Quadrature&lt;dim&gt;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#aa2e6cff4889a98d9ed713209ad8e9a06">gather_particles_reference_location</a>();</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span><span class="comment"></span> </div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span><span class="comment">   * @brief Interpolates the velocity and pressure of the fluid, as well as the</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span><span class="comment">   * pressure gradient, and the laplacian, curl and gradient of the velocity,</span></div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span><span class="comment">   * at the locations of the particles.</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span><span class="comment">   *</span></div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span><span class="comment">   * @param[in] q_particles_location Quadrature type object that contains the</span></div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span><span class="comment">   * location of the particles relative to the cell&#39;s frame of reference.</span></div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span><span class="comment">   *</span></div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span><span class="comment">   * @param[in] velocity_cell The active cell associated with the velocity and</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span><span class="comment">   * pressure DoFHandler</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span><span class="comment">   *</span></div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span><span class="comment">   * @param[in] velocity_pressure_solution The solution (velocity and</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span><span class="comment">   * pressure) that is used to interpolate the velocity and pressure at the</span></div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="comment">   * particles locations.</span></div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span><span class="comment">   */</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00696" data-start="{" data-end="}">
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a8a004531a8787367955a1a4345bb0de0">  696</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a8a004531a8787367955a1a4345bb0de0">calculate_fluid_fields_at_particle_location</a>(</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;                                &amp;q_particles_location,</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;velocity_cell,</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>    <span class="keyword">const</span> VectorType &amp;velocity_pressure_solution)</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>  {</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    FEValues&lt;dim&gt; fe_values_local_particles(this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>.get_fe(),</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                                            q_particles_location,</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>                                            update_gradients | update_values |</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>                                              update_hessians);</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span> </div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    <span class="comment">// Reallocate memory for the fields to be interpolated at the particle</span></div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    <span class="comment">// location This has to be done for every cell because deal.II expects the</span></div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <span class="comment">// size of the vector to be strictly equal to the number of points in the</span></div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>    <span class="comment">// quadrature</span></div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ac0c8bbc5f5970cab5fb230b53070fbf8">fluid_velocity_at_particle_location</a>.resize(<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#adaa0ede5e0e15a6c423d648d51fd55a0">fluid_velocity_laplacian_at_particle_location</a>.resize(<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>);</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a853bc7f1f89073ba31f04e869c382290">fluid_velocity_curls_at_particle_location_2d</a>.resize(<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#ac89d0f424dfb61cab155a75d1bcab036">fluid_velocity_curls_at_particle_location_3d</a>.resize(<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>);</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#af4d6f3f3933bb6a0ee8a290750bd7b84">fluid_pressure_gradients_at_particle_location</a>.resize(<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>);</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span> </div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    fe_values_local_particles.reinit(velocity_cell);</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span> </div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>    <span class="comment">// Calculate all fluid properties at the particle location</span></div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>    fe_values_local_particles[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_values(</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>      velocity_pressure_solution, <a class="code hl_variable" href="classNavierStokesScratchData.html#ac0c8bbc5f5970cab5fb230b53070fbf8">fluid_velocity_at_particle_location</a>);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span> </div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    fe_values_local_particles[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_laplacians(</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>      velocity_pressure_solution,</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#adaa0ede5e0e15a6c423d648d51fd55a0">fluid_velocity_laplacian_at_particle_location</a>);</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (dim == 2)</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>      {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        fe_values_local_particles[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_curls(</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>          velocity_pressure_solution,</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a853bc7f1f89073ba31f04e869c382290">fluid_velocity_curls_at_particle_location_2d</a>);</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>      }</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (dim == 3)</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>      {</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>        fe_values_local_particles[<a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>].get_function_curls(</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>          velocity_pressure_solution,</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#ac89d0f424dfb61cab155a75d1bcab036">fluid_velocity_curls_at_particle_location_3d</a>);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>      }</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>    fe_values_local_particles[<a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>].get_function_gradients(</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>      velocity_pressure_solution,</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#af4d6f3f3933bb6a0ee8a290750bd7b84">fluid_pressure_gradients_at_particle_location</a>);</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>  }</div>
</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span><span class="comment"></span> </div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span><span class="comment">   * @brief Interpolates the void fraction at the locations of the particles.</span></div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><span class="comment">   *</span></div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span><span class="comment">   * @param[in] q_particles_location Quadrature type object that contains the</span></div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span><span class="comment">   * location of the particles relative to the cell&#39;s frame of reference.</span></div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span><span class="comment">   *</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span><span class="comment">   * @param[in] void_fraction_cell The active cell associated with the void</span></div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span><span class="comment">   * fraction DoFHandler</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="comment">   *</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span><span class="comment">   * @param[in] void_fraction_solution The void fraction calculated with one of</span></div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span><span class="comment">   * the methods of the VoidFractionBase class.</span></div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span><span class="comment">   */</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span> </div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00759" data-start="{" data-end="}">
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a899d3f71f0c5958d0a5a6321b5d1b62c">  759</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a899d3f71f0c5958d0a5a6321b5d1b62c">calculate_void_fraction_at_particle_location</a>(</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;                                &amp;q_particles_location,</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;void_fraction_cell,</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>    <span class="keyword">const</span> VectorType &amp;void_fraction_solution)</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>  {</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    Assert(</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">gather_void_fraction</a>,</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>      ExcMessage(</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>        <span class="stringliteral">&quot;gather_void_fraction has been set to false, yet you are trying to gather the void fraction at the location of the particles. The scratch data is currently unaware of the finite element interpolation for the void fraction and the simulation will abort.&quot;</span>));</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span> </div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    FEValues&lt;dim&gt; fe_values_particles_void_fraction(</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>      this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>-&gt;get_fe(),</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>      q_particles_location,</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>      update_values);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span> </div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    fe_values_particles_void_fraction.reinit(void_fraction_cell);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    fe_values_particles_void_fraction.get_function_values(</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>      void_fraction_solution, <a class="code hl_variable" href="classNavierStokesScratchData.html#a5470704145930632762c7dee59207de1">cell_void_fraction</a>);</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>  }</div>
</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span><span class="comment"></span> </div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span><span class="comment">   * @brief Calculates the properties of the fluid at the locations of the particles.</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span><span class="comment">   * At the moment, only constant properties within the same fluid are</span></div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span><span class="comment">   * supported. When two fluids are present and VOF is used, the properties are</span></div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span><span class="comment">   * calculated based on the filtered VOF solution interpolated at the</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span><span class="comment">   * location of the particles. These properties are used in the forces</span></div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span><span class="comment">   * calculations in the VANS equations.</span></div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span><span class="comment">   */</span></div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span> </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00790" data-start="{" data-end="}">
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a75b812c13d59aa2d7dccb006301ae84e">  790</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a75b812c13d59aa2d7dccb006301ae84e">calculate_fluid_properties_at_particle_location</a>()</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>  {</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    AssertThrow(</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>.<a class="code hl_function" href="classPhysicalPropertiesManager.html#a4fbf4cde6182467899c9cfab9a4bfdb0">density_is_constant</a>(),</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      ExcMessage(</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        <span class="stringliteral">&quot;The lethe-fluid-particles solver only supports constant densities&quot;</span>));</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>    AssertThrow(</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>      !<a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>.<a class="code hl_function" href="classPhysicalPropertiesManager.html#ac301cee6597f9d4565681d9069365a8a">get_rheology</a>()</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>          -&gt;is_non_newtonian_rheological_model() &amp;&amp;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        !<a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>.<a class="code hl_function" href="classPhysicalPropertiesManager.html#ac301cee6597f9d4565681d9069365a8a">get_rheology</a>()</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>           -&gt;is_non_newtonian_rheological_model(),</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>      ExcMessage(</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>        <span class="stringliteral">&quot;The lethe-fluid-particles solver only supports constant rheology model&quot;</span>));</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span> </div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>)</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>      {</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_particle = 0; i_particle &lt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>             ++i_particle)</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>          {</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#ade08aef1aa4ab5ec0bde23394c92c348">density_at_particle_location</a>[i_particle] = <a class="code hl_function" href="utilities_8h.html#a955c2851894d041727c14dff59686f0d">calculate_point_property</a>(</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f">filtered_phase_values_at_particle_location</a>[i_particle],</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>              this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ac7d601c55618c1618aeaa585f6f0552f">density_ref_0</a>,</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>              this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8210e7b229953704ed77819e7abc38e8">density_ref_1</a>);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            <span class="keywordtype">double</span> dynamic_viscosity_at_particle_location =</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>              <a class="code hl_function" href="utilities_8h.html#a955c2851894d041727c14dff59686f0d">calculate_point_property</a>(</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f">filtered_phase_values_at_particle_location</a>[i_particle],</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a217da6b0183d1fb370e0d0c362888252">kinematic_viscosity_scale_0</a> * this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ac7d601c55618c1618aeaa585f6f0552f">density_ref_0</a>,</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>                this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#affb3f96369a5da5dcd9a246baa18e734">kinematic_viscosity_scale_1</a> * this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8210e7b229953704ed77819e7abc38e8">density_ref_1</a>);</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#adfa7834a2c85ab8d1f91316c2b6712a7">kinematic_viscosity_at_particle_location</a>[i_particle] =</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>              dynamic_viscosity_at_particle_location /</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#ade08aef1aa4ab5ec0bde23394c92c348">density_at_particle_location</a>[i_particle];</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>          }</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span> </div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>        <span class="comment">// Properties have been calculated, return</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>      }</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    <span class="comment">// Regular case without VOF</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_particle = 0; i_particle &lt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>         ++i_particle)</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>      {</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        <span class="comment">// Gather the kinematic viscosity and density at the particle</span></div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        <span class="comment">// location assuming a constant kinematic viscosity and density in a</span></div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>        <span class="comment">// single fluid</span></div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#adfa7834a2c85ab8d1f91316c2b6712a7">kinematic_viscosity_at_particle_location</a>[i_particle] =</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a82d5130ae1a9d00a7328d3a7db44d666">kinematic_viscosity_scale</a>;</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#ade08aef1aa4ab5ec0bde23394c92c348">density_at_particle_location</a>[i_particle] = <a class="code hl_variable" href="classNavierStokesScratchData.html#a44c0473dfbeadc8880372e632c45a885">density_scale</a>;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>      }</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>  }</div>
</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span><span class="comment"></span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span><span class="comment">   * @brief Calculates the velocity of the fluid relative to that of the particle and</span></div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span><span class="comment">   * the particle Reynolds number at the location of the particles. These will</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span><span class="comment">   * be used in forces calculations in the vans equations.</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span><span class="comment">   */</span></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span> </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00848" data-start="{" data-end="}">
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6ddebf3c3b40b8989c7ab25fd83c4b5c">  848</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a6ddebf3c3b40b8989c7ab25fd83c4b5c">calculate_force_parameters_at_particle_location</a>()</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>  {</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    <span class="comment">// Tolerance for the calculation of the particle Reynolds number.</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    <span class="comment">// TODO -&gt; Revisit if that is not a too high value.</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Re_particle_tolerance       = 1e-3;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_particle                  = 0;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6">average_fluid_particle_relative_velocity</a> = 0;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span> </div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;particle : <a class="code hl_variable" href="classNavierStokesScratchData.html#a9e58737ebcfc6340e1a42f53056c7a2d">pic</a>)</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>      {</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>        <span class="keyword">auto</span> particle_properties = particle.get_properties();</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a6e54265ec4571075921ef83518d38c36">fluid_particle_relative_velocity_at_particle_location</a>[i_particle] =</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#ac0c8bbc5f5970cab5fb230b53070fbf8">fluid_velocity_at_particle_location</a>[i_particle] -</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#ab1202093c4ca2dfbbce9b93b93cc9b14">particle_velocity</a>[i_particle];</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6">average_fluid_particle_relative_velocity</a> +=</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a6e54265ec4571075921ef83518d38c36">fluid_particle_relative_velocity_at_particle_location</a>[i_particle];</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>        <a class="code hl_variable" href="classNavierStokesScratchData.html#a91011b4cd4861cad33fe26dd60c010b8">Re_particle</a>[i_particle] =</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>          Re_particle_tolerance +</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>          <a class="code hl_variable" href="classNavierStokesScratchData.html#a5470704145930632762c7dee59207de1">cell_void_fraction</a>[i_particle] *</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a6e54265ec4571075921ef83518d38c36">fluid_particle_relative_velocity_at_particle_location</a>[i_particle]</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>              .norm() *</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>            particle_properties[<a class="code hl_enumvalue" href="namespaceDEM_1_1CFDDEMProperties.html#ae9734b9d29480269e4764c5092d87b2fac31564c0282259a90fa3036a0f7993e5">DEM::CFDDEMProperties::PropertiesIndex::dp</a>] /</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>            (<a class="code hl_variable" href="classNavierStokesScratchData.html#adfa7834a2c85ab8d1f91316c2b6712a7">kinematic_viscosity_at_particle_location</a>[i_particle] + DBL_MIN);</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>        i_particle++;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>      }</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6">average_fluid_particle_relative_velocity</a> =</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6">average_fluid_particle_relative_velocity</a> / i_particle;</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  }</div>
</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span><span class="comment"></span> </div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span><span class="comment">   * @brief Interpolates the filtered VOF solution at the location of the particles.</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span><span class="comment">   * The latter values are used in calculating the density and viscosity of the</span></div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span><span class="comment">   * fluid at the particles&#39; locations when VOF is used.</span></div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span><span class="comment">   *</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span><span class="comment">   * @param[in] q_particles_location Quadrature type object that contains the</span></div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span><span class="comment">   * location of the particles relative to the cell&#39;s frame of reference.</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span><span class="comment">   *</span></div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span><span class="comment">   * @param[in] phase_cell The active cell associated with the VOF DoFHandler</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span><span class="comment">   *</span></div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span><span class="comment">   * @param[in] current_filtered_solution The present value of the filtered VOF</span></div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span><span class="comment">   * solution</span></div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span><span class="comment">   */</span></div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span> </div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00896" data-start="{" data-end="}">
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a4757cd43b23a146abbbfb67be6fa7c81">  896</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a4757cd43b23a146abbbfb67be6fa7c81">calculate_vof_at_particle_location</a>(</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;                                &amp;q_particles_location,</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;phase_cell,</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>    <span class="keyword">const</span> VectorType &amp;current_filtered_solution)</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>  {</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>    Assert(</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>,</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>      ExcMessage(</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>        <span class="stringliteral">&quot;gather_vof has been set to false, yet you are trying to gather the VOF at the location of the particles. The scratch data is currently unaware of the finite element interpolation for VOF and the simulation will abort.&quot;</span>));</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span> </div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>    FEValues&lt;dim&gt; fe_values_vof_local_particles((*this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>).get_fe(),</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>                                                q_particles_location,</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>                                                update_values |</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>                                                  update_quadrature_points |</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>                                                  update_JxW_values);</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f">filtered_phase_values_at_particle_location</a>.resize(<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>);</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span> </div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>    fe_values_vof_local_particles.reinit(phase_cell);</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span> </div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>    fe_values_vof_local_particles.get_function_values(</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>      current_filtered_solution, <a class="code hl_variable" href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f">filtered_phase_values_at_particle_location</a>);</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>  }</div>
</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span><span class="comment"></span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span><span class="comment">   * @brief Calculates the variables needed to compute the particle fluid interactions</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span><span class="comment">   * in the VANS equations.</span></div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span><span class="comment">   *</span></div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span><span class="comment">   * @param[in] velocity_cell The active cell associated with the velocity and</span></div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span><span class="comment">   * pressure DoFHandler</span></div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span><span class="comment">   *</span></div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span><span class="comment">   * @param[in] void_fraction_cell The active cell associated with the void</span></div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span><span class="comment">   * fraction DoFHandler</span></div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span><span class="comment">   *</span></div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span><span class="comment">   * @param[in] previous_velocity_pressure_solution The solution at the previous</span></div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span><span class="comment">   * time step for the fluid&#39;s velocity and pressure</span></div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span><span class="comment">   *</span></div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span><span class="comment">   * @param[in] void_fraction_solution The void fraction value calculated with</span></div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span><span class="comment">   * one of the methods of the VoidFractionBase class.</span></div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span><span class="comment">   *</span></div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span><span class="comment">   * @param[in] particle_handler The particle handler object that stores and</span></div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span><span class="comment">   * manages the particles in the simulations</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span><span class="comment">   */</span></div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span> </div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen00943" data-start="{" data-end="}">
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a49d6b95189b964ca9682f81c5b0f97b5">  943</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a49d6b95189b964ca9682f81c5b0f97b5">reinit_particle_fluid_interactions</a>(</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;velocity_cell,</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;void_fraction_cell,</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    <span class="keyword">const</span> VectorType &amp; <span class="comment">/*velocity_pressure_solution*/</span>,</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>    <span class="keyword">const</span> VectorType                      &amp;previous_velocity_pressure_solution,</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    <span class="keyword">const</span> VectorType                      &amp;void_fraction_solution,</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    <span class="keyword">const</span> Particles::ParticleHandler&lt;dim&gt; &amp;particle_handler)</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>  {</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>    Assert(</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>      <a class="code hl_variable" href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76">gather_particles_information</a>,</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>      ExcMessage(</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        <span class="stringliteral">&quot;You are trying to reinit the fluid information at the particle location within a cell,&quot;</span></div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <span class="stringliteral">&quot; but you did not enable the gathering of the information at the particle location for the scratch data (gather_particles_information=false).&quot;</span>));</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span> </div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a9e58737ebcfc6340e1a42f53056c7a2d">pic</a> = particle_handler.particles_in_cell(velocity_cell);</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    <span class="keywordtype">double</span> total_particle_volume = 0;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#ab059ac1bfc7ed0fc0f1540ead8fa59f0">reinit_particle_fluid_forces</a>();</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    total_particle_volume = <a class="code hl_function" href="classNavierStokesScratchData.html#af8ac55b44d36bba2da5edb79754de69b">extract_particle_properties</a>();</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#af72659fbca48ccb8a9a76fcacef290ee">calculate_cell_void_fraction</a>(total_particle_volume);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a> == 0)</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span> </div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    Quadrature&lt;dim&gt; q_particles_location =</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#aa2e6cff4889a98d9ed713209ad8e9a06">gather_particles_reference_location</a>();</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a8a004531a8787367955a1a4345bb0de0">calculate_fluid_fields_at_particle_location</a>(</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>      q_particles_location, velocity_cell, previous_velocity_pressure_solution);</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span> </div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a50e47e5746c3b8e513d798318938235b">interpolated_void_fraction</a>)</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>      {</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>        <a class="code hl_function" href="classNavierStokesScratchData.html#a899d3f71f0c5958d0a5a6321b5d1b62c">calculate_void_fraction_at_particle_location</a>(q_particles_location,</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>                                                     void_fraction_cell,</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>                                                     void_fraction_solution);</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>      }</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a75b812c13d59aa2d7dccb006301ae84e">calculate_fluid_properties_at_particle_location</a>();</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a6ddebf3c3b40b8989c7ab25fd83c4b5c">calculate_force_parameters_at_particle_location</a>();</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>  }</div>
</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span><span class="comment"></span> </div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span><span class="comment">  /**</span></div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span><span class="comment">   * @brief Calculates the variables needed to compute the particle fluid interactions</span></div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span><span class="comment">   * in the VANS equations.This version of the function is used when VOF is used</span></div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span><span class="comment">   * with CFD-DEM.</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span><span class="comment">   *</span></div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span><span class="comment">   * @param[in] velocity_cell The active cell associated with the velocity and</span></div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span><span class="comment">   * pressure DoFHandler</span></div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span><span class="comment">   *</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span><span class="comment">   * @param[in] void_fraction_cell The active cell associated with the void</span></div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span><span class="comment">   * fraction DoFHandler</span></div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span><span class="comment">   *</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span><span class="comment">   * @param[in] phase_cell The active cell associated with the VOF DoFHandler</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span><span class="comment">   *</span></div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span><span class="comment">   * @param[in] previous_velocity_pressure_solution The solution at the previous</span></div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span><span class="comment">   * time step for the fluid&#39;s velocity and pressure</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span><span class="comment">   *</span></div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span><span class="comment">   * @param[in] void_fraction_solution The void fraction value calculated with</span></div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span><span class="comment">   * one of the methods of the VoidFractionBase class.</span></div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span><span class="comment">   *</span></div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span><span class="comment">   * @param[in] particle_handler The particle handler object that stores and</span></div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span><span class="comment">   * manages the particles in the simulations</span></div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span><span class="comment">   *</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span><span class="comment">   * @param[in] current_filtered_solution The present value of the VOF solution</span></div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span><span class="comment">   * at the dofs of the cell</span></div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span><span class="comment">   */</span></div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01010" data-start="{" data-end="}">
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad3150bbed772e9ada4dce841e0d2de97"> 1010</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#ad3150bbed772e9ada4dce841e0d2de97">reinit_particle_fluid_interactions</a>(</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;velocity_cell,</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;void_fraction_cell,</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;phase_cell,</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <span class="keyword">const</span> VectorType &amp; <span class="comment">/*velocity_pressure_solution*/</span>,</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>    <span class="keyword">const</span> VectorType                      &amp;previous_velocity_pressure_solution,</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>    <span class="keyword">const</span> VectorType                      &amp;void_fraction_solution,</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>    <span class="keyword">const</span> Particles::ParticleHandler&lt;dim&gt; &amp;particle_handler,</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    <span class="keyword">const</span> VectorType                      &amp;current_filtered_solution)</div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>  {</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a9e58737ebcfc6340e1a42f53056c7a2d">pic</a> = particle_handler.particles_in_cell(velocity_cell);</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span> </div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    <span class="keywordtype">double</span> total_particle_volume = 0;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    total_particle_volume        = <a class="code hl_function" href="classNavierStokesScratchData.html#af8ac55b44d36bba2da5edb79754de69b">extract_particle_properties</a>();</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#ab059ac1bfc7ed0fc0f1540ead8fa59f0">reinit_particle_fluid_forces</a>();</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#af72659fbca48ccb8a9a76fcacef290ee">calculate_cell_void_fraction</a>(total_particle_volume);</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span> </div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a> == 0)</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span> </div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>    Quadrature&lt;dim&gt; q_particles_location =</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>      <a class="code hl_function" href="classNavierStokesScratchData.html#aa2e6cff4889a98d9ed713209ad8e9a06">gather_particles_reference_location</a>();</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a8a004531a8787367955a1a4345bb0de0">calculate_fluid_fields_at_particle_location</a>(</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      q_particles_location, velocity_cell, previous_velocity_pressure_solution);</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span> </div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a50e47e5746c3b8e513d798318938235b">interpolated_void_fraction</a>)</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      {</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <a class="code hl_function" href="classNavierStokesScratchData.html#a899d3f71f0c5958d0a5a6321b5d1b62c">calculate_void_fraction_at_particle_location</a>(q_particles_location,</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>                                                     void_fraction_cell,</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>                                                     void_fraction_solution);</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>      }</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a4757cd43b23a146abbbfb67be6fa7c81">calculate_vof_at_particle_location</a>(q_particles_location,</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>                                       phase_cell,</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>                                       current_filtered_solution);</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a75b812c13d59aa2d7dccb006301ae84e">calculate_fluid_properties_at_particle_location</a>();</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>    <a class="code hl_function" href="classNavierStokesScratchData.html#a6ddebf3c3b40b8989c7ab25fd83c4b5c">calculate_force_parameters_at_particle_location</a>();</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>  }</div>
</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span><span class="comment"></span> </div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span><span class="comment">   * @brief enable_heat_transfer Enables the collection of the heat transfer</span></div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span><span class="comment">   * data (Temperature field) by the scratch</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span><span class="comment">   *</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span><span class="comment">   * @param fe FiniteElement associated with the heat transfer.</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span><span class="comment">   *</span></div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span><span class="comment">   *</span></div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span><span class="comment">   */</span></div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span> </div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a59bab3e52c8e29cf84473965f49baefe">enable_heat_transfer</a>(<span class="keyword">const</span> FiniteElement&lt;dim&gt; &amp;fe,</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>                       <span class="keyword">const</span> Quadrature&lt;dim&gt;    &amp;quadrature,</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>                       <span class="keyword">const</span> Mapping&lt;dim&gt;       &amp;mapping);</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span><span class="comment"></span> </div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span><span class="comment">   * @brief Reinitialize the content of the scratch for the heat transfer</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span><span class="comment">   * auxiliary physic</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span><span class="comment">   *</span></div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span><span class="comment">   * @param cell The cell over which the assembly is being carried.</span></div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span><span class="comment">   * This cell must be compatible with the heat transfer FE and not the</span></div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span><span class="comment">   * Navier-Stokes FE</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span><span class="comment">   *</span></div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span><span class="comment">   * @param current_solution The present value of the solution for temperature</span></div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span><span class="comment">   *</span></div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span><span class="comment">   * @param previous_solutions Vector of \f$n\f$ @p VectorType containers of</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span><span class="comment">   * previous temperature solutions. \f$n\f$ depends on the BDF scheme selected</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span><span class="comment">   * for time-stepping.</span></div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span><span class="comment">   */</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span> </div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01081" data-start="{" data-end="}">
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a3c148603b147b2f0e746395d8756ab52"> 1081</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a3c148603b147b2f0e746395d8756ab52">reinit_heat_transfer</a>(</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;cell,</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    <span class="keyword">const</span> VectorType                                     &amp;current_solution,</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>    <span class="keyword">const</span> std::vector&lt;VectorType&gt;                        &amp;previous_solutions)</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>  {</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;reinit(cell);</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span> </div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    <span class="comment">// Gather temperature</span></div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_function_values(current_solution,</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>                                                     this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ac05774c7b7819ddfec872a43af036b9c">temperature_values</a>);</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span> </div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    <span class="comment">// Gather temperature gradient</span></div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_function_gradients(</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>      current_solution, this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a3ebc680707e5085db58fb099b5b97bd7">temperature_gradients</a>);</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span> </div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>    <span class="comment">// Extrapolate temperature and temperature gradient to t+dt using the BDF</span></div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    <span class="comment">// if the simulation is transient</span></div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>    <span class="keyword">const</span> <span class="keyword">auto</span> method = this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>-&gt;get_assembly_method();</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="time__integration__utilities_8h.html#a0a24876ac89130c482872183aaabb619">is_bdf</a>(method))</div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>      {</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>        <span class="comment">// Gather previous temperature and temperature gradient values</span></div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p = 0; p &lt; previous_solutions.size(); ++p)</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>          {</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_function_values(</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>              previous_solutions[p], this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a4a134fc3c9836109e4077f63c26a4e17">previous_temperature_values</a>[p]);</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>            <a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>-&gt;get_function_gradients(</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>              previous_solutions[p], this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a457d2cc982eb13afbfa39427f6c68807">previous_temperature_gradients</a>[p]);</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>          }</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>        <span class="comment">// Extrapolate temperature and temperature gradient</span></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>        std::vector&lt;double&gt; time_vector =</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>          this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>-&gt;get_simulation_times();</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>        <a class="code hl_function" href="bdf_8h.html#a4e79f83003fb6f8817196a020a8dc161">bdf_extrapolate</a>(time_vector,</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>                        <a class="code hl_variable" href="classNavierStokesScratchData.html#a4a134fc3c9836109e4077f63c26a4e17">previous_temperature_values</a>,</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>                        <a class="code hl_function" href="bdf_8h.html#a79e44dc10ababc737a8659c2f5f8c18a">number_of_previous_solutions</a>(method),</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>                        <a class="code hl_variable" href="classNavierStokesScratchData.html#ac05774c7b7819ddfec872a43af036b9c">temperature_values</a>);</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>        <a class="code hl_function" href="bdf_8h.html#a4e79f83003fb6f8817196a020a8dc161">bdf_extrapolate</a>(time_vector,</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>                        <a class="code hl_variable" href="classNavierStokesScratchData.html#a457d2cc982eb13afbfa39427f6c68807">previous_temperature_gradients</a>,</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>                        <a class="code hl_function" href="bdf_8h.html#a79e44dc10ababc737a8659c2f5f8c18a">number_of_previous_solutions</a>(method),</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>                        <a class="code hl_variable" href="classNavierStokesScratchData.html#a3ebc680707e5085db58fb099b5b97bd7">temperature_gradients</a>);</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>      }</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>  }</div>
</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span><span class="comment"></span> </div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span><span class="comment">   * @brief enable_cahn_hilliard Enables the collection of the CahnHilliard data</span></div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span><span class="comment">   * by the scratch</span></div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span><span class="comment">   *</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span><span class="comment">   * @param fe FiniteElement associated with the CahnHilliard physics</span></div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span><span class="comment">   *</span></div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span><span class="comment">   *</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span><span class="comment">   */</span></div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a126d7e05decf1cd0ab526d786a86e1af">enable_cahn_hilliard</a>(</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    <span class="keyword">const</span> FiniteElement&lt;dim&gt;       &amp;fe,</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;          &amp;quadrature,</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    <span class="keyword">const</span> Mapping&lt;dim&gt;             &amp;mapping,</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    <span class="keyword">const</span> <a class="code hl_struct" href="structParameters_1_1CahnHilliard.html">Parameters::CahnHilliard</a> &amp;cahn_hilliard_parameters);</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span><span class="comment"></span> </div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span><span class="comment">   * @brief Enables the collection of the CahnHilliard data by the scratch</span></div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span><span class="comment">   *</span></div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span><span class="comment">   * @param fe FiniteElement associated with the CahnHilliard physics</span></div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span><span class="comment">   *</span></div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span><span class="comment">   * @param quadrature Quadrature rule of the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span><span class="comment">   *</span></div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span><span class="comment">   * @param mapping Mapping used for the Navier-Stokes problem assembly</span></div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span><span class="comment">   */</span></div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a126d7e05decf1cd0ab526d786a86e1af">enable_cahn_hilliard</a>(</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    <span class="keyword">const</span> FiniteElement&lt;dim&gt;                      &amp;fe,</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    <span class="keyword">const</span> Quadrature&lt;dim&gt;                         &amp;quadrature,</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <span class="keyword">const</span> Mapping&lt;dim&gt;                            &amp;mapping,</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    <span class="keyword">const</span> std::shared_ptr&lt;CahnHilliardFilterBase&gt; &amp;<a class="code hl_variable" href="classNavierStokesScratchData.html#a9a9121f92c46736d4be8b92933fb6874">cahn_hilliard_filter</a>);</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span><span class="comment"></span> </div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span><span class="comment">   * @brief Reinitialize the content of the scratch for CH</span></div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span><span class="comment">   *</span></div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span><span class="comment">   * @param cell The cell over which the assembly is being carried.</span></div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span><span class="comment">   * This cell must be compatible with the CH FE and not the</span></div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span><span class="comment">   * Navier-Stokes FE</span></div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span><span class="comment">   *</span></div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span><span class="comment">   * @param current_solution The present value of the solution for [phi]</span></div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span><span class="comment">   */</span></div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span>  <span class="keywordtype">void</span></div>
<div class="foldopen" id="foldopen01167" data-start="{" data-end="}">
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a89be382ee756efb20600f131017a5d33"> 1167</a></span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a89be382ee756efb20600f131017a5d33">reinit_cahn_hilliard</a>(</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>    <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;cell,</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    <span class="keyword">const</span> VectorType                                     &amp;current_solution,</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>    <span class="keyword">const</span> VectorType &amp;current_filtered_solution)</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>  {</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;reinit(cell);</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82">phase_order</a>.component        = 0;</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#ab12122ce6e915131ae74691c0aaf8a11">chemical_potential</a>.component = 1;</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span> </div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    <span class="comment">// Gather phase fraction (values, gradients)</span></div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;operator[](<a class="code hl_variable" href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82">phase_order</a>)</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>      .get_function_values(current_solution,</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>                           this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#aaf28c142ac8fd80e605d236c5770f11f">phase_order_cahn_hilliard_values</a>);</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;operator[](<a class="code hl_variable" href="classNavierStokesScratchData.html#ab12122ce6e915131ae74691c0aaf8a11">chemical_potential</a>)</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>      .get_function_values(current_solution,</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>                           this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#afcbbcbddf76fe8e5c18ee4f4549aee17">chemical_potential_cahn_hilliard_values</a>);</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;operator[](<a class="code hl_variable" href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82">phase_order</a>)</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>      .get_function_gradients(current_solution,</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>                              this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a39ac4958d1c97b955d55874904644a01">phase_order_cahn_hilliard_gradients</a>);</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span> </div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    <span class="comment">// Gather filtered VOF solution (values, gradients)</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>    this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>-&gt;operator[](<a class="code hl_variable" href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82">phase_order</a>)</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>      .get_function_values(current_filtered_solution,</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>                           this-&gt;<a class="code hl_variable" href="classNavierStokesScratchData.html#af1ed3d09a7c260547245c035a1641d03">filtered_phase_order_cahn_hilliard_values</a>);</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  }</div>
</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span><span class="comment"></span> </div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span><span class="comment">   * @brief enable_mortar Enables the calculation of the rotor rotation angle</span></div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span><span class="comment">   */</span></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a51cadf33b64ca212d6b49e6bfa7be9e1">enable_mortar</a>();</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span> </div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span><span class="comment"></span> </div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span><span class="comment">   * @brief Renitialize the content of the scratch data for mortar</span></div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span><span class="comment">   *</span></div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span><span class="comment">   * @param[in] cell The cell over which the assembly is being carried.</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span><span class="comment">   * This cell must be compatible with the FE which is used to fill the</span></div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span><span class="comment">   * FeValues.</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span><span class="comment">   *</span></div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span><span class="comment">   * @param[in] mortar_parameters Parameters for the mortar method</span></div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span><span class="comment">   *</span></div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span><span class="comment">   * @param[in] radius Radius of the rotor domain</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span><span class="comment">   */</span></div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a3377bdde203866dd8bd0d4670df2fb89">reinit_mortar</a>(<span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim&gt;::active_cell_iterator &amp;cell,</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>                <span class="keyword">const</span> <a class="code hl_struct" href="structParameters_1_1Mortar.html">Parameters::Mortar&lt;dim&gt;</a> &amp;mortar_parameters,</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>                <span class="keyword">const</span> <span class="keywordtype">double</span>                  &amp;radius);</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span><span class="comment"></span> </div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span><span class="comment">   * @brief Calculates the physical properties. This function calculates the</span></div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span><span class="comment">   * physical properties that may be required by the fluid dynamics problem.</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span><span class="comment">   * Namely the kinematic viscosity and, when required, the density.</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span><span class="comment">   */</span></div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>  <span class="keywordtype">void</span></div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>  <a class="code hl_function" href="classNavierStokesScratchData.html#a30ca912e22e35000f7109061ad47726b">calculate_physical_properties</a>();</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span> </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>  <span class="comment">// For auxiliary physics solution extrapolation</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d"> 1225</a></span>  <span class="keyword">const</span> std::shared_ptr&lt;SimulationControl&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">simulation_control</a>;</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>  <span class="comment">// Physical properties</span></div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c"> 1228</a></span>  <span class="keyword">const</span> <a class="code hl_class" href="classPhysicalPropertiesManager.html">PhysicalPropertiesManager</a>      <a class="code hl_variable" href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">properties_manager</a>;</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a7a84adbf5b1f22f5a91c0f27dd1748e1"> 1229</a></span>  std::map&lt;field, std::vector&lt;double&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a7a84adbf5b1f22f5a91c0f27dd1748e1">fields</a>;</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aeb94e9a27086b6776c73896a8ad92d6e"> 1230</a></span>  std::vector&lt;double&gt;                  <a class="code hl_variable" href="classNavierStokesScratchData.html#aeb94e9a27086b6776c73896a8ad92d6e">density</a>;</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a49eb75df4a79112316a46d5f714f3b2b"> 1231</a></span>  <span class="keywordtype">double</span>                               <a class="code hl_variable" href="classNavierStokesScratchData.html#a49eb75df4a79112316a46d5f714f3b2b">density_ref</a>;</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad20a933f0fb20cca56c20f8a61c869bb"> 1232</a></span>  <span class="keywordtype">double</span>                               <a class="code hl_variable" href="classNavierStokesScratchData.html#ad20a933f0fb20cca56c20f8a61c869bb">density_psi</a>;</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae72c592369ec0d85c01f4495eaee169c"> 1233</a></span>  std::vector&lt;double&gt;                  <a class="code hl_variable" href="classNavierStokesScratchData.html#ae72c592369ec0d85c01f4495eaee169c">dynamic_viscosity</a>;</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a84fa7f09cd33151a56e6655bcd19c61e"> 1234</a></span>  std::vector&lt;double&gt;                  <a class="code hl_variable" href="classNavierStokesScratchData.html#a84fa7f09cd33151a56e6655bcd19c61e">kinematic_viscosity</a>;</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a82d5130ae1a9d00a7328d3a7db44d666"> 1235</a></span>  <span class="keywordtype">double</span>                               <a class="code hl_variable" href="classNavierStokesScratchData.html#a82d5130ae1a9d00a7328d3a7db44d666">kinematic_viscosity_scale</a>;<span class="comment"></span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span><span class="comment">  /// Values of the kinematic viscosity used in the SUPG and PSPG</span></div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span><span class="comment">  /// stabilizations.</span></div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad3a36ee74822fecc5ee3f63facc7d2ad"> 1238</a></span><span class="comment"></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ad3a36ee74822fecc5ee3f63facc7d2ad">kinematic_viscosity_for_stabilization</a>;<span class="comment"></span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span><span class="comment">  /// Values of the dynamic viscosity used in the SUPG and PSPG stabilizations.</span></div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#add32ba3d3e8df614b7cb332483226d5f"> 1240</a></span><span class="comment"></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#add32ba3d3e8df614b7cb332483226d5f">dynamic_viscosity_for_stabilization</a>;</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af63bf259579dd4a09ae20cc81b36b01d"> 1241</a></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#af63bf259579dd4a09ae20cc81b36b01d">thermal_expansion</a>;</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae7754a9f031d997877e37f788f749fdb"> 1242</a></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#ae7754a9f031d997877e37f788f749fdb">grad_kinematic_viscosity_shear_rate</a>;</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a5c0fe0240fc3541e95df2896b0231e84"> 1243</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a5c0fe0240fc3541e95df2896b0231e84">previous_density</a>;</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span> </div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>  <span class="comment">// Pressure scaling factor to facilitate different scales between velocity and</span></div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>  <span class="comment">// pressure</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a24846172d49e366a6d0fed30df1213fd"> 1247</a></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a24846172d49e366a6d0fed30df1213fd">pressure_scaling_factor</a>;</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span> </div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>  <span class="comment">// For VOF and CH simulations. Present properties for fluid 0 and 1.</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a615e771dac9cdc466d96a437076c0f3e"> 1250</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a615e771dac9cdc466d96a437076c0f3e">density_0</a>;</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a1ae1ea949cfae902e9af13d01fb9540e"> 1251</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a1ae1ea949cfae902e9af13d01fb9540e">density_1</a>;</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ac7d601c55618c1618aeaa585f6f0552f"> 1252</a></span>  <span class="keywordtype">double</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#ac7d601c55618c1618aeaa585f6f0552f">density_ref_0</a>;</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a8210e7b229953704ed77819e7abc38e8"> 1253</a></span>  <span class="keywordtype">double</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#a8210e7b229953704ed77819e7abc38e8">density_ref_1</a>;</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a77665366e5d77005ed30767b65a5e4f7"> 1254</a></span>  <span class="keywordtype">double</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#a77665366e5d77005ed30767b65a5e4f7">density_psi_0</a>;</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#acdbc2067fb56794ff053c86100b7124f"> 1255</a></span>  <span class="keywordtype">double</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#acdbc2067fb56794ff053c86100b7124f">density_psi_1</a>;</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a44c0473dfbeadc8880372e632c45a885"> 1256</a></span>  <span class="keywordtype">double</span>              <a class="code hl_variable" href="classNavierStokesScratchData.html#a44c0473dfbeadc8880372e632c45a885">density_scale</a>;</div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>  <span class="comment">// The density at the particles locations is used to calculate the forces</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>  <span class="comment">// between the fluid and the particles.</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ade08aef1aa4ab5ec0bde23394c92c348"> 1259</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ade08aef1aa4ab5ec0bde23394c92c348">density_at_particle_location</a>;</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a55be20797a583dc74e98db1265f4e7b7"> 1260</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a55be20797a583dc74e98db1265f4e7b7">compressibility_multiplier</a>;</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a8150ab425914422919793a5a0a4bf3af"> 1261</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a8150ab425914422919793a5a0a4bf3af">dynamic_viscosity_0</a>;</div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#abec92bb60f2174b1d4f0fc674420ece9"> 1262</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#abec92bb60f2174b1d4f0fc674420ece9">dynamic_viscosity_1</a>;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a388e56385b295cc88c28137a82f79aa2"> 1263</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a388e56385b295cc88c28137a82f79aa2">kinematic_viscosity_0</a>;</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a342292f02eab0cb140f77cd12588775d"> 1264</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a342292f02eab0cb140f77cd12588775d">kinematic_viscosity_1</a>;<span class="comment"></span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span><span class="comment">  /// Scale of the kinematic viscosity for fluid 0.</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a217da6b0183d1fb370e0d0c362888252"> 1266</a></span><span class="comment"></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a217da6b0183d1fb370e0d0c362888252">kinematic_viscosity_scale_0</a>;<span class="comment"></span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span><span class="comment">  /// Scale of the kinematic viscosity for fluid 1.</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#affb3f96369a5da5dcd9a246baa18e734"> 1268</a></span><span class="comment"></span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#affb3f96369a5da5dcd9a246baa18e734">kinematic_viscosity_scale_1</a>;<span class="comment"></span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span><span class="comment">  /// Kinematic viscosity at the particles locations. This is used to calculate</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span><span class="comment">  /// the Reynolds number and the forces between the fluid and the particles.</span></div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adfa7834a2c85ab8d1f91316c2b6712a7"> 1271</a></span><span class="comment"></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#adfa7834a2c85ab8d1f91316c2b6712a7">kinematic_viscosity_at_particle_location</a>;<span class="comment"></span></div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span><span class="comment">  /// Values of the dynamic viscosity used in the SUPG and PSPG stabilizations</span></div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span><span class="comment">  /// for fluid 0.</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af9e94c266309f54fa5210766dd1e7e96"> 1274</a></span><span class="comment"></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#af9e94c266309f54fa5210766dd1e7e96">dynamic_viscosity_for_stabilization_0</a>;<span class="comment"></span></div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span><span class="comment">  /// Values of the dynamic viscosity used in the SUPG and PSPG stabilizations</span></div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span><span class="comment">  /// for fluid 1.</span></div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a7a125a0005aafb952cd026b445ee0b6b"> 1277</a></span><span class="comment"></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a7a125a0005aafb952cd026b445ee0b6b">dynamic_viscosity_for_stabilization_1</a>;</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a874ee56d946ee54f5848bd5d0b42b9bc"> 1278</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a874ee56d946ee54f5848bd5d0b42b9bc">thermal_expansion_0</a>;</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a13040c1693b86dadfd2d7edade3140e8"> 1279</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a13040c1693b86dadfd2d7edade3140e8">thermal_expansion_1</a>;</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a5f65155a6dcfa12516d5357049ecba5b"> 1280</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a5f65155a6dcfa12516d5357049ecba5b">surface_tension</a>;</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a578dfea0694f03cf3ab93953bbf37d91"> 1281</a></span>  std::vector&lt;double&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a578dfea0694f03cf3ab93953bbf37d91">surface_tension_gradient</a>;</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span> </div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>  <span class="comment">// FEValues for the Navier-Stokes problem</span></div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f"> 1284</a></span>  FEValues&lt;dim&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">fe_values</a>;</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8"> 1285</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               <a class="code hl_variable" href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">n_dofs</a>;</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ab297c915f78a5aa41da5f0f1a476944f"> 1286</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>               <a class="code hl_variable" href="classNavierStokesScratchData.html#ab297c915f78a5aa41da5f0f1a476944f">n_q_points</a>;</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a9b57679638ab4f0b90a3d7e2c7c2c32c"> 1287</a></span>  <span class="keywordtype">double</span>                     <a class="code hl_variable" href="classNavierStokesScratchData.html#a9b57679638ab4f0b90a3d7e2c7c2c32c">cell_size</a>;</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e"> 1288</a></span>  FEValuesExtractors::Vector <a class="code hl_variable" href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">velocities</a>;</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff"> 1289</a></span>  FEValuesExtractors::Scalar <a class="code hl_variable" href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">pressure</a>;</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span> </div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad824df2b7790211977cea193a1810af8"> 1291</a></span>  std::vector&lt;Vector&lt;double&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ad824df2b7790211977cea193a1810af8">rhs_force</a>;</div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aefffdd294c642100ea21ba30aea5d185"> 1292</a></span>  Tensor&lt;1, dim&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#aefffdd294c642100ea21ba30aea5d185">beta_force</a>;</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a132a5f0c61439d03594e00c5052b27fe"> 1293</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a132a5f0c61439d03594e00c5052b27fe">force</a>;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0c71709046272d72203fbe735e40e0f4"> 1294</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a0c71709046272d72203fbe735e40e0f4">mass_source</a>;</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span> </div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>  <span class="comment">// Quadrature</span></div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a405da43dc1730f5de1a5a3683202ddbd"> 1297</a></span>  Table&lt;1, double&gt;        <a class="code hl_variable" href="classNavierStokesScratchData.html#a405da43dc1730f5de1a5a3683202ddbd">JxW</a>;</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6aa64fd685358a4990eb37189602d20f"> 1298</a></span>  std::vector&lt;Point&lt;dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a6aa64fd685358a4990eb37189602d20f">quadrature_points</a>;</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>  <span class="comment">// Components index</span></div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a4b89c62b025b47447f51e9eea1bc2480"> 1301</a></span>  std::vector&lt;unsigned int&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a4b89c62b025b47447f51e9eea1bc2480">components</a>;</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>  <span class="comment">// Velocity and pressure values</span></div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a8a93306de6e1cd56c819318e8253f2a5"> 1304</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a8a93306de6e1cd56c819318e8253f2a5">velocity_values</a>;</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adc5876c2ab3a6358caac55eacd49b6df"> 1305</a></span>  std::vector&lt;double&gt;                      <a class="code hl_variable" href="classNavierStokesScratchData.html#adc5876c2ab3a6358caac55eacd49b6df">velocity_divergences</a>;</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a566544b2f37645bd28a94073e42caf94"> 1306</a></span>  std::vector&lt;Tensor&lt;2, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a566544b2f37645bd28a94073e42caf94">velocity_gradients</a>;</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af76efde9fb25c3d5174fafda67d91307"> 1307</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#af76efde9fb25c3d5174fafda67d91307">velocity_laplacians</a>;</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a2a598e7c026ac4edd8c7b95c188b64b1"> 1308</a></span>  std::vector&lt;Tensor&lt;3, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a2a598e7c026ac4edd8c7b95c188b64b1">velocity_hessians</a>;</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aa750e3f05a771a2e56c29f5d6e27e202"> 1309</a></span>  std::vector&lt;double&gt;                      <a class="code hl_variable" href="classNavierStokesScratchData.html#aa750e3f05a771a2e56c29f5d6e27e202">shear_rate</a>;</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0d32755f9533006a0c28c61b594f4b0f"> 1310</a></span>  std::vector&lt;double&gt;                      <a class="code hl_variable" href="classNavierStokesScratchData.html#a0d32755f9533006a0c28c61b594f4b0f">pressure_values</a>;</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af329e1c369385dbdd3cb044f23aeda0f"> 1311</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#af329e1c369385dbdd3cb044f23aeda0f">pressure_gradients</a>;</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a425e384b23005541ab442a50b49560f4"> 1312</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a425e384b23005541ab442a50b49560f4">previous_pressure_values</a>;</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a35e6cecb73b9e5a9d2576b8208c77da8"> 1313</a></span>  std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a35e6cecb73b9e5a9d2576b8208c77da8">previous_velocity_values</a>;</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0d6c54e17e2e5dc31f8e8d1e2bfe30e7"> 1314</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a0d6c54e17e2e5dc31f8e8d1e2bfe30e7">sdirk_stage_sum</a>;</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span> </div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>  <span class="comment">// Shape functions</span></div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0b858fcc61c20c7b3ca24253741b39eb"> 1317</a></span>  Table&lt;2, double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a0b858fcc61c20c7b3ca24253741b39eb">div_phi_u</a>;</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a70fd7e5971c2481ba307bc08f90f60b0"> 1318</a></span>  Table&lt;2, Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a70fd7e5971c2481ba307bc08f90f60b0">phi_u</a>;</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a981c3e639a7e753c867a48d835f2b9b9"> 1319</a></span>  Table&lt;2, Tensor&lt;3, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a981c3e639a7e753c867a48d835f2b9b9">hess_phi_u</a>;</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aa02f906b4d33a632cd21d38eefff32ce"> 1320</a></span>  Table&lt;2, Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#aa02f906b4d33a632cd21d38eefff32ce">laplacian_phi_u</a>;</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a95349c742f9be9d55490462c30a1c9fb"> 1321</a></span>  Table&lt;2, Tensor&lt;2, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a95349c742f9be9d55490462c30a1c9fb">grad_phi_u</a>;</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a32458393ad0bd016416c85b53a285013"> 1322</a></span>  Table&lt;2, double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a32458393ad0bd016416c85b53a285013">phi_p</a>;</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae38cfc270e721ef6a4de6db34dbe7e12"> 1323</a></span>  Table&lt;2, Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ae38cfc270e721ef6a4de6db34dbe7e12">grad_phi_p</a>;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span><span class="comment"></span> </div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span><span class="comment">   * Scratch component for the VOF auxiliary physics</span></div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span><span class="comment">   */</span></div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76"> 1328</a></span>  <span class="keywordtype">bool</span>                             <a class="code hl_variable" href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">gather_vof</a>;</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a1f794b9e6eda684ee0169bfb72864bc0"> 1329</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code hl_variable" href="classNavierStokesScratchData.html#a1f794b9e6eda684ee0169bfb72864bc0">n_dofs_vof</a>;</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a9acf89bc99f2fcfc1a454e0ffec12911"> 1330</a></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a9acf89bc99f2fcfc1a454e0ffec12911">phase_values</a>;</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad8eaa43dddfe9c8dd2d3fccdb1375062"> 1331</a></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#ad8eaa43dddfe9c8dd2d3fccdb1375062">filtered_phase_values</a>;</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f"> 1332</a></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f">filtered_phase_values_at_particle_location</a>;</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a077315d33bded4ae3e9f13b1541bbe3d"> 1333</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a077315d33bded4ae3e9f13b1541bbe3d">previous_phase_values</a>;</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ab42fb46ce7737929c7b76f6faa1a8a86"> 1334</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;      <a class="code hl_variable" href="classNavierStokesScratchData.html#ab42fb46ce7737929c7b76f6faa1a8a86">filtered_phase_gradient_values</a>;</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a402dc7a9c4c505cb09842b649fbf0c81"> 1335</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;      <a class="code hl_variable" href="classNavierStokesScratchData.html#a402dc7a9c4c505cb09842b649fbf0c81">phase_gradient_values</a>;</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>  <span class="comment">// This is stored as a shared_ptr because it is only instantiated when needed</span></div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9"> 1337</a></span>  std::shared_ptr&lt;FEValues&lt;dim&gt;&gt;           <a class="code hl_variable" href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">fe_values_vof</a>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a49f74b732d4b2321493338e2d84a9911"> 1338</a></span>  std::shared_ptr&lt;VolumeOfFluidFilterBase&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a49f74b732d4b2321493338e2d84a9911">filter</a>; <span class="comment">// Phase fraction filter</span></div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span> </div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a3ea0ab72226feac5c12b4c018b2e7672"> 1340</a></span>  <span class="keywordtype">bool</span>                           <a class="code hl_variable" href="classNavierStokesScratchData.html#a3ea0ab72226feac5c12b4c018b2e7672">gather_projected_phase_fraction_gradient</a>;</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990"> 1341</a></span>  <span class="keywordtype">bool</span>                           <a class="code hl_variable" href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990">gather_curvature</a>;</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e"> 1342</a></span>  std::shared_ptr&lt;FEValues&lt;dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e">fe_values_projected_phase_fraction_gradient</a>;</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66"> 1343</a></span>  std::shared_ptr&lt;FEValues&lt;dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">fe_values_curvature</a>;</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a77a8a872036804121a9eb9f73a23b7f5"> 1344</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;    <a class="code hl_variable" href="classNavierStokesScratchData.html#a77a8a872036804121a9eb9f73a23b7f5">projected_phase_fraction_gradient_values</a>;</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a963f460a1a06ad5969f0ae5a21c2b5ca"> 1345</a></span>  std::vector&lt;double&gt;            <a class="code hl_variable" href="classNavierStokesScratchData.html#a963f460a1a06ad5969f0ae5a21c2b5ca">curvature_values</a>;</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span><span class="comment"></span> </div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span><span class="comment">   * Scratch component for the void fraction auxiliary physics</span></div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span><span class="comment">   */</span></div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980"> 1350</a></span>  <span class="keywordtype">bool</span>                             <a class="code hl_variable" href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">gather_void_fraction</a>;</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a539bd8eb9798dce1834fdf0a21b89e73"> 1351</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code hl_variable" href="classNavierStokesScratchData.html#a539bd8eb9798dce1834fdf0a21b89e73">n_dofs_void_fraction</a>;</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a732e9107c27d323f8d013e214dbcd223"> 1352</a></span>  std::vector&lt;double&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a732e9107c27d323f8d013e214dbcd223">void_fraction_values</a>;</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aa48c218f4f67db5887e6036756508bbd"> 1353</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#aa48c218f4f67db5887e6036756508bbd">previous_void_fraction_values</a>;</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a2e37181c34de8b2712921a955fc7a5c2"> 1354</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;      <a class="code hl_variable" href="classNavierStokesScratchData.html#a2e37181c34de8b2712921a955fc7a5c2">void_fraction_gradient_values</a>;</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>  <span class="comment">// This is stored as a shared_ptr because it is only instantiated when needed</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427"> 1356</a></span>  std::shared_ptr&lt;FEValues&lt;dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">fe_values_void_fraction</a>;</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span><span class="comment"></span> </div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span><span class="comment">   * Scratch component for the particle fluid interaction auxiliary physics</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span><span class="comment">   */</span></div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76"> 1361</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76">gather_particles_information</a>;</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a50e47e5746c3b8e513d798318938235b"> 1362</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a50e47e5746c3b8e513d798318938235b">interpolated_void_fraction</a>;</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span> </div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ab1202093c4ca2dfbbce9b93b93cc9b14"> 1364</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ab1202093c4ca2dfbbce9b93b93cc9b14">particle_velocity</a>;</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a3dbda49d1128ac105d4d92b83fa47cc3"> 1365</a></span>  Tensor&lt;1, dim&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a3dbda49d1128ac105d4d92b83fa47cc3">average_particle_velocity</a>;</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ac0c8bbc5f5970cab5fb230b53070fbf8"> 1366</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ac0c8bbc5f5970cab5fb230b53070fbf8">fluid_velocity_at_particle_location</a>;</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6e54265ec4571075921ef83518d38c36"> 1368</a></span>                 <a class="code hl_variable" href="classNavierStokesScratchData.html#a6e54265ec4571075921ef83518d38c36">fluid_particle_relative_velocity_at_particle_location</a>;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6"> 1369</a></span>  Tensor&lt;1, dim&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6">average_fluid_particle_relative_velocity</a>;</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af4d6f3f3933bb6a0ee8a290750bd7b84"> 1370</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#af4d6f3f3933bb6a0ee8a290750bd7b84">fluid_pressure_gradients_at_particle_location</a>;</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adaa0ede5e0e15a6c423d648d51fd55a0"> 1371</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#adaa0ede5e0e15a6c423d648d51fd55a0">fluid_velocity_laplacian_at_particle_location</a>;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a853bc7f1f89073ba31f04e869c382290"> 1372</a></span>  std::vector&lt;Tensor&lt;1, 1&gt;&gt;   <a class="code hl_variable" href="classNavierStokesScratchData.html#a853bc7f1f89073ba31f04e869c382290">fluid_velocity_curls_at_particle_location_2d</a>;</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ac89d0f424dfb61cab155a75d1bcab036"> 1373</a></span>  std::vector&lt;Tensor&lt;1, 3&gt;&gt;   <a class="code hl_variable" href="classNavierStokesScratchData.html#ac89d0f424dfb61cab155a75d1bcab036">fluid_velocity_curls_at_particle_location_3d</a>;</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a62323c078408373c8553c6c4a19b83be"> 1374</a></span>  std::vector&lt;Point&lt;dim&gt;&gt;     <a class="code hl_variable" href="classNavierStokesScratchData.html#a62323c078408373c8553c6c4a19b83be">particle_reference_location</a>;</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a853be5072710d046742d14590199db78"> 1375</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a853be5072710d046742d14590199db78">particle_weights</a>;</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a5470704145930632762c7dee59207de1"> 1376</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a5470704145930632762c7dee59207de1">cell_void_fraction</a>;</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a91011b4cd4861cad33fe26dd60c010b8"> 1377</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a91011b4cd4861cad33fe26dd60c010b8">Re_particle</a>;</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a204a64dc7ede58da66f4b8b3879df7bf"> 1378</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#a204a64dc7ede58da66f4b8b3879df7bf">max_number_of_particles_per_cell</a>;</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7"> 1379</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">number_of_particles</a>;</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a9e58737ebcfc6340e1a42f53056c7a2d"> 1380</a></span>  <span class="keyword">typename</span> Particles::ParticleHandler&lt;dim&gt;::particle_iterator_range <a class="code hl_variable" href="classNavierStokesScratchData.html#a9e58737ebcfc6340e1a42f53056c7a2d">pic</a>;</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a15f3549bb83f7157db104857b22f0a4a"> 1381</a></span>  <span class="keywordtype">double</span>                                                            <a class="code hl_variable" href="classNavierStokesScratchData.html#a15f3549bb83f7157db104857b22f0a4a">cell_volume</a>;</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0410ed941db9623f765c05ea1776ac2e"> 1382</a></span>  <span class="keywordtype">double</span>                                                            <a class="code hl_variable" href="classNavierStokesScratchData.html#a0410ed941db9623f765c05ea1776ac2e">beta_drag</a>;</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6adf340668d1ce441c03309e163045ee"> 1383</a></span>  Tensor&lt;1, dim&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a6adf340668d1ce441c03309e163045ee">undisturbed_flow_force</a>;</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span><span class="comment"></span> </div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span><span class="comment">   * Scratch component for the heat transfer</span></div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span><span class="comment">   */</span></div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ac45b659821eec6e1fa6c8ecd2cae5415"> 1389</a></span>  <span class="keywordtype">bool</span>                                     <a class="code hl_variable" href="classNavierStokesScratchData.html#ac45b659821eec6e1fa6c8ecd2cae5415">gather_temperature</a>;</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adfdeab3a94c08dce29176710541ad665"> 1390</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                             <a class="code hl_variable" href="classNavierStokesScratchData.html#adfdeab3a94c08dce29176710541ad665">n_dofs_heat_transfer</a>;</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ac05774c7b7819ddfec872a43af036b9c"> 1391</a></span>  std::vector&lt;double&gt;                      <a class="code hl_variable" href="classNavierStokesScratchData.html#ac05774c7b7819ddfec872a43af036b9c">temperature_values</a>;</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a4a134fc3c9836109e4077f63c26a4e17"> 1392</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a4a134fc3c9836109e4077f63c26a4e17">previous_temperature_values</a>;</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a3ebc680707e5085db58fb099b5b97bd7"> 1393</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt;              <a class="code hl_variable" href="classNavierStokesScratchData.html#a3ebc680707e5085db58fb099b5b97bd7">temperature_gradients</a>;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a457d2cc982eb13afbfa39427f6c68807"> 1394</a></span>  std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a457d2cc982eb13afbfa39427f6c68807">previous_temperature_gradients</a>;</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>  <span class="comment">// This is stored as a shared_ptr because it is only instantiated when needed</span></div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df"> 1396</a></span>  std::shared_ptr&lt;FEValues&lt;dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">fe_values_temperature</a>;</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span><span class="comment"></span> </div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span><span class="comment">   * Scratch component for the CahnHilliard auxiliary physics</span></div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span><span class="comment">   */</span></div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a80675043762c14c602da2c651248d2c6"> 1401</a></span>  <span class="keywordtype">bool</span>                        <a class="code hl_variable" href="classNavierStokesScratchData.html#a80675043762c14c602da2c651248d2c6">gather_cahn_hilliard</a>;</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aa4a64740ac957fea527533e95b5ca233"> 1402</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                <a class="code hl_variable" href="classNavierStokesScratchData.html#aa4a64740ac957fea527533e95b5ca233">n_dofs_cahn_hilliard</a>;</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aaf28c142ac8fd80e605d236c5770f11f"> 1403</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#aaf28c142ac8fd80e605d236c5770f11f">phase_order_cahn_hilliard_values</a>;</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af1ed3d09a7c260547245c035a1641d03"> 1404</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#af1ed3d09a7c260547245c035a1641d03">filtered_phase_order_cahn_hilliard_values</a>;</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a39ac4958d1c97b955d55874904644a01"> 1405</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a39ac4958d1c97b955d55874904644a01">phase_order_cahn_hilliard_gradients</a>;</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#afcbbcbddf76fe8e5c18ee4f4549aee17"> 1406</a></span>  std::vector&lt;double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#afcbbcbddf76fe8e5c18ee4f4549aee17">chemical_potential_cahn_hilliard_values</a>;</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span> </div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>  std::shared_ptr&lt;CahnHilliardFilterBase&gt;</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a9a9121f92c46736d4be8b92933fb6874"> 1409</a></span>    <a class="code hl_variable" href="classNavierStokesScratchData.html#a9a9121f92c46736d4be8b92933fb6874">cahn_hilliard_filter</a>; <span class="comment">// Phase order fraction filter</span></div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span> </div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>  <span class="comment">// This is stored as a shared_ptr because it is only instantiated when needed</span></div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972"> 1412</a></span>  std::shared_ptr&lt;FEValues&lt;dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">fe_values_cahn_hilliard</a>;</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82"> 1413</a></span>  FEValuesExtractors::Scalar     <a class="code hl_variable" href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82">phase_order</a>;</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ab12122ce6e915131ae74691c0aaf8a11"> 1414</a></span>  FEValuesExtractors::Scalar     <a class="code hl_variable" href="classNavierStokesScratchData.html#ab12122ce6e915131ae74691c0aaf8a11">chemical_potential</a>;</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span><span class="comment"></span> </div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span><span class="comment">   * Scratch component for the mortar method</span></div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span><span class="comment">   */</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0bd069ab2a2e317dcfb1f506b0041a50"> 1419</a></span>  <span class="keywordtype">bool</span>                        <a class="code hl_variable" href="classNavierStokesScratchData.html#a0bd069ab2a2e317dcfb1f506b0041a50">gather_mortar</a>;</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adcc81802d5c41910ef956b07d740b943"> 1420</a></span>  std::vector&lt;Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#adcc81802d5c41910ef956b07d740b943">rotor_linear_velocity_values</a>;</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span><span class="comment"></span> </div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span><span class="comment">  /**</span></div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span><span class="comment">   * Is boundary cell indicator</span></div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span><span class="comment">   */</span></div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a26944c6375322a4ad03b51b959f5b3f6"> 1425</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a26944c6375322a4ad03b51b959f5b3f6">is_boundary_cell</a>;</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span> </div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>  <span class="comment">// If a rheological model is being used for a non-Newtonian flow</span></div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9"> 1428</a></span>  <span class="keywordtype">bool</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">gather_hessian</a>;</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span> </div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c"> 1430</a></span>  FEFaceValues&lt;dim&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">fe_face_values</a>;</div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span> </div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221"> 1432</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">n_faces</a>;</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af"> 1433</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">n_faces_q_points</a>;</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a66da7daca38fcd92aa0bb2f41a75ab3c"> 1434</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="classNavierStokesScratchData.html#a66da7daca38fcd92aa0bb2f41a75ab3c">face_n_dofs</a>;</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span> </div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>  <span class="comment">// If boundary cell indicator</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a85c0cf98990e2f944e1043a13577d78b"> 1437</a></span>  std::vector&lt;bool&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a85c0cf98990e2f944e1043a13577d78b">is_boundary_face</a>;</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#acc2f4cf7c08898d8ff4172e2e07ce260"> 1438</a></span>  std::vector&lt;unsigned int&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#acc2f4cf7c08898d8ff4172e2e07ce260">boundary_face_id</a>;</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span> </div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>  <span class="comment">// Quadrature</span></div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a1800b777a5f6ee949f4bd19632f8dbd9"> 1441</a></span>  Table&lt;2, double&gt;                     <a class="code hl_variable" href="classNavierStokesScratchData.html#a1800b777a5f6ee949f4bd19632f8dbd9">face_JxW</a>;</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#af0c85dd1b4866fb1c70c2cf5de3281b1"> 1442</a></span>  std::vector&lt;std::vector&lt;Point&lt;dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#af0c85dd1b4866fb1c70c2cf5de3281b1">face_quadrature_points</a>;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a0a08bcb3a530d7517edf64c72dbdc28a"> 1443</a></span>  Table&lt;2, Tensor&lt;1, dim&gt;&gt;             <a class="code hl_variable" href="classNavierStokesScratchData.html#a0a08bcb3a530d7517edf64c72dbdc28a">face_normal</a>;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span> </div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>  <span class="comment">// Velocity and pressure values</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>  <span class="comment">// First vector is face number, second quadrature point</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aa10f5197d2a06f1d40525bdf8493d8c6"> 1447</a></span>  std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#aa10f5197d2a06f1d40525bdf8493d8c6">face_velocity_values</a>;</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adf8f8020ea98df223151cccd92a2e738"> 1448</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#adf8f8020ea98df223151cccd92a2e738">face_velocity_divergences</a>;</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae190c0101083553dafc546b98b300ce6"> 1449</a></span>  std::vector&lt;std::vector&lt;Tensor&lt;2, dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ae190c0101083553dafc546b98b300ce6">face_velocity_gradients</a>;</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a33b670f69579168534803ca45effeecd"> 1450</a></span>  std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a33b670f69579168534803ca45effeecd">face_velocity_laplacians</a>;</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#aebfc11a2eade6b515242a0f09275fac0"> 1451</a></span>  std::vector&lt;std::vector&lt;double&gt;&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#aebfc11a2eade6b515242a0f09275fac0">face_pressure_values</a>;</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ab6df2938e916f981c39c1deaacbe4d03"> 1452</a></span>  std::vector&lt;std::vector&lt;Tensor&lt;1, dim&gt;&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ab6df2938e916f981c39c1deaacbe4d03">face_pressure_gradients</a>;</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span> </div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>  <span class="comment">// Shape functions</span></div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>  <span class="comment">// First vector is face number, second quadrature point, third DOF</span></div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a8d7c491f60dacd4d624b3665e4e4372c"> 1456</a></span>  Table&lt;3, double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a8d7c491f60dacd4d624b3665e4e4372c">face_div_phi_u</a>;</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#abd334c0baa72b939278f4b2869371414"> 1457</a></span>  Table&lt;3, Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#abd334c0baa72b939278f4b2869371414">face_phi_u</a>;</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a6fb8903e517afdf6ae84667e6dc118ff"> 1458</a></span>  Table&lt;3, Tensor&lt;3, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a6fb8903e517afdf6ae84667e6dc118ff">face_hess_phi_u</a>;</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#ae20f109ee3fd7a5ed525a1ba76a4e759"> 1459</a></span>  Table&lt;3, Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#ae20f109ee3fd7a5ed525a1ba76a4e759">face_laplacian_phi_u</a>;</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a2a341602a56ab835dd59c54126be6734"> 1460</a></span>  Table&lt;3, Tensor&lt;2, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#a2a341602a56ab835dd59c54126be6734">face_grad_phi_u</a>;</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a14f88c10c2002a41a49cda82e5575d25"> 1461</a></span>  Table&lt;3, double&gt;         <a class="code hl_variable" href="classNavierStokesScratchData.html#a14f88c10c2002a41a49cda82e5575d25">face_phi_p</a>;</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#adbd62f1711f3edcf392271e9d0b4e6e6"> 1462</a></span>  Table&lt;3, Tensor&lt;1, dim&gt;&gt; <a class="code hl_variable" href="classNavierStokesScratchData.html#adbd62f1711f3edcf392271e9d0b4e6e6">face_grad_phi_p</a>;</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span><span class="comment"></span> </div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span><span class="comment">  /// SDIRK table for SDIRK time integration</span></div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"><a class="line" href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c"> 1465</a></span><span class="comment"></span>  <a class="code hl_struct" href="structSDIRKTable.html">SDIRKTable</a> <a class="code hl_variable" href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c">sdirk_table</a>;</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>};</div>
</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span> </div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="abdf_8h_html"><div class="ttname"><a href="bdf_8h.html">bdf.h</a></div></div>
<div class="ttc" id="abdf_8h_html_a4e79f83003fb6f8817196a020a8dc161"><div class="ttname"><a href="bdf_8h.html#a4e79f83003fb6f8817196a020a8dc161">bdf_extrapolate</a></div><div class="ttdeci">void bdf_extrapolate(const std::vector&lt; double &gt; &amp;time_vector, const std::vector&lt; std::vector&lt; DataType &gt; &gt; &amp;solution_vector, const unsigned int number_of_previous_solutions, std::vector&lt; DataType &gt; &amp;extrapolated_solution)</div><div class="ttdoc">Extrapolate vector of solution to time_vector[0] using previous solution times and previous solutions...</div><div class="ttdef"><b>Definition</b> <a href="bdf_8h_source.html#l00133">bdf.h:133</a></div></div>
<div class="ttc" id="abdf_8h_html_a79e44dc10ababc737a8659c2f5f8c18a"><div class="ttname"><a href="bdf_8h.html#a79e44dc10ababc737a8659c2f5f8c18a">number_of_previous_solutions</a></div><div class="ttdeci">unsigned int number_of_previous_solutions(const Parameters::SimulationControl::TimeSteppingMethod method)</div><div class="ttdoc">Get the number of previous time steps for a specific BDF scheme.</div><div class="ttdef"><b>Definition</b> <a href="bdf_8h_source.html#l00097">bdf.h:97</a></div></div>
<div class="ttc" id="acahn__hilliard__filter_8h_html"><div class="ttname"><a href="cahn__hilliard__filter_8h.html">cahn_hilliard_filter.h</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html"><div class="ttname"><a href="classNavierStokesScratchData.html">NavierStokesScratchData</a></div><div class="ttdoc">Class that stores the information required by the assembly procedure for a Navier-Stokes equation....</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00054">navier_stokes_scratch_data.h:55</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0410ed941db9623f765c05ea1776ac2e"><div class="ttname"><a href="classNavierStokesScratchData.html#a0410ed941db9623f765c05ea1776ac2e">NavierStokesScratchData::beta_drag</a></div><div class="ttdeci">double beta_drag</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01382">navier_stokes_scratch_data.h:1382</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a05a68c1d47ea11eeea610580e93f1d0e"><div class="ttname"><a href="classNavierStokesScratchData.html#a05a68c1d47ea11eeea610580e93f1d0e">NavierStokesScratchData::NavierStokesScratchData</a></div><div class="ttdeci">NavierStokesScratchData(const NavierStokesScratchData&lt; dim &gt; &amp;sd)</div><div class="ttdoc">Copy Constructor. Same as the main constructor. This constructor only uses the other scratch to build...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00126">navier_stokes_scratch_data.h:126</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a077315d33bded4ae3e9f13b1541bbe3d"><div class="ttname"><a href="classNavierStokesScratchData.html#a077315d33bded4ae3e9f13b1541bbe3d">NavierStokesScratchData::previous_phase_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; previous_phase_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01333">navier_stokes_scratch_data.h:1333</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0a08bcb3a530d7517edf64c72dbdc28a"><div class="ttname"><a href="classNavierStokesScratchData.html#a0a08bcb3a530d7517edf64c72dbdc28a">NavierStokesScratchData::face_normal</a></div><div class="ttdeci">Table&lt; 2, Tensor&lt; 1, dim &gt; &gt; face_normal</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01443">navier_stokes_scratch_data.h:1443</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0b0d67e46df8e9870fb9174d496701e9"><div class="ttname"><a href="classNavierStokesScratchData.html#a0b0d67e46df8e9870fb9174d496701e9">NavierStokesScratchData::fe_values_vof</a></div><div class="ttdeci">std::shared_ptr&lt; FEValues&lt; dim &gt; &gt; fe_values_vof</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01337">navier_stokes_scratch_data.h:1337</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0b858fcc61c20c7b3ca24253741b39eb"><div class="ttname"><a href="classNavierStokesScratchData.html#a0b858fcc61c20c7b3ca24253741b39eb">NavierStokesScratchData::div_phi_u</a></div><div class="ttdeci">Table&lt; 2, double &gt; div_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01317">navier_stokes_scratch_data.h:1317</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0bd069ab2a2e317dcfb1f506b0041a50"><div class="ttname"><a href="classNavierStokesScratchData.html#a0bd069ab2a2e317dcfb1f506b0041a50">NavierStokesScratchData::gather_mortar</a></div><div class="ttdeci">bool gather_mortar</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01419">navier_stokes_scratch_data.h:1419</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0c71709046272d72203fbe735e40e0f4"><div class="ttname"><a href="classNavierStokesScratchData.html#a0c71709046272d72203fbe735e40e0f4">NavierStokesScratchData::mass_source</a></div><div class="ttdeci">std::vector&lt; double &gt; mass_source</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01294">navier_stokes_scratch_data.h:1294</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0d32755f9533006a0c28c61b594f4b0f"><div class="ttname"><a href="classNavierStokesScratchData.html#a0d32755f9533006a0c28c61b594f4b0f">NavierStokesScratchData::pressure_values</a></div><div class="ttdeci">std::vector&lt; double &gt; pressure_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01310">navier_stokes_scratch_data.h:1310</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0d6c54e17e2e5dc31f8e8d1e2bfe30e7"><div class="ttname"><a href="classNavierStokesScratchData.html#a0d6c54e17e2e5dc31f8e8d1e2bfe30e7">NavierStokesScratchData::sdirk_stage_sum</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; sdirk_stage_sum</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01314">navier_stokes_scratch_data.h:1314</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a0e506238dac667b6c23647eb1b237120"><div class="ttname"><a href="classNavierStokesScratchData.html#a0e506238dac667b6c23647eb1b237120">NavierStokesScratchData::reinit_projected_phase_fraction_gradient</a></div><div class="ttdeci">void reinit_projected_phase_fraction_gradient(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;projected_phase_fraction_gradient_cell, const VectorType &amp;current_projected_phase_fraction_gradient_solution)</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00536">navier_stokes_scratch_data.h:536</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a10a1bb5ffa32ef81cf831b2508513d76"><div class="ttname"><a href="classNavierStokesScratchData.html#a10a1bb5ffa32ef81cf831b2508513d76">NavierStokesScratchData::gather_vof</a></div><div class="ttdeci">bool gather_vof</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01328">navier_stokes_scratch_data.h:1328</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a126d7e05decf1cd0ab526d786a86e1af"><div class="ttname"><a href="classNavierStokesScratchData.html#a126d7e05decf1cd0ab526d786a86e1af">NavierStokesScratchData::enable_cahn_hilliard</a></div><div class="ttdeci">void enable_cahn_hilliard(const FiniteElement&lt; dim &gt; &amp;fe, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping, const Parameters::CahnHilliard &amp;cahn_hilliard_parameters)</div><div class="ttdoc">enable_cahn_hilliard Enables the collection of the CahnHilliard data by the scratch</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00177">navier_stokes_scratch_data.cc:177</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a13040c1693b86dadfd2d7edade3140e8"><div class="ttname"><a href="classNavierStokesScratchData.html#a13040c1693b86dadfd2d7edade3140e8">NavierStokesScratchData::thermal_expansion_1</a></div><div class="ttdeci">std::vector&lt; double &gt; thermal_expansion_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01279">navier_stokes_scratch_data.h:1279</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a132a5f0c61439d03594e00c5052b27fe"><div class="ttname"><a href="classNavierStokesScratchData.html#a132a5f0c61439d03594e00c5052b27fe">NavierStokesScratchData::force</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; force</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01293">navier_stokes_scratch_data.h:1293</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a14f88c10c2002a41a49cda82e5575d25"><div class="ttname"><a href="classNavierStokesScratchData.html#a14f88c10c2002a41a49cda82e5575d25">NavierStokesScratchData::face_phi_p</a></div><div class="ttdeci">Table&lt; 3, double &gt; face_phi_p</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01461">navier_stokes_scratch_data.h:1461</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a15f3549bb83f7157db104857b22f0a4a"><div class="ttname"><a href="classNavierStokesScratchData.html#a15f3549bb83f7157db104857b22f0a4a">NavierStokesScratchData::cell_volume</a></div><div class="ttdeci">double cell_volume</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01381">navier_stokes_scratch_data.h:1381</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a170bd84860356dfd01caf5fc3287eec8"><div class="ttname"><a href="classNavierStokesScratchData.html#a170bd84860356dfd01caf5fc3287eec8">NavierStokesScratchData::NavierStokesScratchData</a></div><div class="ttdeci">NavierStokesScratchData(const std::shared_ptr&lt; SimulationControl &gt; &amp;simulation_control, const PhysicalPropertiesManager &amp;properties_manager, const FESystem&lt; dim &gt; &amp;fe, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping, const Quadrature&lt; dim - 1 &gt; &amp;face_quadrature)</div><div class="ttdoc">Constructor. The constructor creates the fe_values that will be used to fill the member variables of ...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00078">navier_stokes_scratch_data.h:78</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a1800b777a5f6ee949f4bd19632f8dbd9"><div class="ttname"><a href="classNavierStokesScratchData.html#a1800b777a5f6ee949f4bd19632f8dbd9">NavierStokesScratchData::face_JxW</a></div><div class="ttdeci">Table&lt; 2, double &gt; face_JxW</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01441">navier_stokes_scratch_data.h:1441</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a1ae1ea949cfae902e9af13d01fb9540e"><div class="ttname"><a href="classNavierStokesScratchData.html#a1ae1ea949cfae902e9af13d01fb9540e">NavierStokesScratchData::density_1</a></div><div class="ttdeci">std::vector&lt; double &gt; density_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01251">navier_stokes_scratch_data.h:1251</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a1c3df5a7c2e0bd07238e9cff84928b76"><div class="ttname"><a href="classNavierStokesScratchData.html#a1c3df5a7c2e0bd07238e9cff84928b76">NavierStokesScratchData::gather_particles_information</a></div><div class="ttdeci">bool gather_particles_information</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01361">navier_stokes_scratch_data.h:1361</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a1f794b9e6eda684ee0169bfb72864bc0"><div class="ttname"><a href="classNavierStokesScratchData.html#a1f794b9e6eda684ee0169bfb72864bc0">NavierStokesScratchData::n_dofs_vof</a></div><div class="ttdeci">unsigned int n_dofs_vof</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01329">navier_stokes_scratch_data.h:1329</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a204a64dc7ede58da66f4b8b3879df7bf"><div class="ttname"><a href="classNavierStokesScratchData.html#a204a64dc7ede58da66f4b8b3879df7bf">NavierStokesScratchData::max_number_of_particles_per_cell</a></div><div class="ttdeci">unsigned int max_number_of_particles_per_cell</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01378">navier_stokes_scratch_data.h:1378</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a217da6b0183d1fb370e0d0c362888252"><div class="ttname"><a href="classNavierStokesScratchData.html#a217da6b0183d1fb370e0d0c362888252">NavierStokesScratchData::kinematic_viscosity_scale_0</a></div><div class="ttdeci">double kinematic_viscosity_scale_0</div><div class="ttdoc">Scale of the kinematic viscosity for fluid 0.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01266">navier_stokes_scratch_data.h:1266</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a24846172d49e366a6d0fed30df1213fd"><div class="ttname"><a href="classNavierStokesScratchData.html#a24846172d49e366a6d0fed30df1213fd">NavierStokesScratchData::pressure_scaling_factor</a></div><div class="ttdeci">double pressure_scaling_factor</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01247">navier_stokes_scratch_data.h:1247</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a259368979ba79f29adce98f255992f7e"><div class="ttname"><a href="classNavierStokesScratchData.html#a259368979ba79f29adce98f255992f7e">NavierStokesScratchData::velocities</a></div><div class="ttdeci">FEValuesExtractors::Vector velocities</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01288">navier_stokes_scratch_data.h:1288</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a26944c6375322a4ad03b51b959f5b3f6"><div class="ttname"><a href="classNavierStokesScratchData.html#a26944c6375322a4ad03b51b959f5b3f6">NavierStokesScratchData::is_boundary_cell</a></div><div class="ttdeci">bool is_boundary_cell</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01425">navier_stokes_scratch_data.h:1425</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a274a5e1e8c8b250142b725222586bb2c"><div class="ttname"><a href="classNavierStokesScratchData.html#a274a5e1e8c8b250142b725222586bb2c">NavierStokesScratchData::sdirk_table</a></div><div class="ttdeci">SDIRKTable sdirk_table</div><div class="ttdoc">SDIRK table for SDIRK time integration.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01465">navier_stokes_scratch_data.h:1465</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a2a341602a56ab835dd59c54126be6734"><div class="ttname"><a href="classNavierStokesScratchData.html#a2a341602a56ab835dd59c54126be6734">NavierStokesScratchData::face_grad_phi_u</a></div><div class="ttdeci">Table&lt; 3, Tensor&lt; 2, dim &gt; &gt; face_grad_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01460">navier_stokes_scratch_data.h:1460</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a2a598e7c026ac4edd8c7b95c188b64b1"><div class="ttname"><a href="classNavierStokesScratchData.html#a2a598e7c026ac4edd8c7b95c188b64b1">NavierStokesScratchData::velocity_hessians</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 3, dim &gt; &gt; velocity_hessians</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01308">navier_stokes_scratch_data.h:1308</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a2c271b97942ba7a74d7f4e9e0c545b6b"><div class="ttname"><a href="classNavierStokesScratchData.html#a2c271b97942ba7a74d7f4e9e0c545b6b">NavierStokesScratchData::enable_void_fraction</a></div><div class="ttdeci">void enable_void_fraction(const FiniteElement&lt; dim &gt; &amp;fe, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping)</div><div class="ttdoc">enable_void_fraction Enables the collection of the void fraction data by the scratch</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00310">navier_stokes_scratch_data.cc:310</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a2e37181c34de8b2712921a955fc7a5c2"><div class="ttname"><a href="classNavierStokesScratchData.html#a2e37181c34de8b2712921a955fc7a5c2">NavierStokesScratchData::void_fraction_gradient_values</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; void_fraction_gradient_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01354">navier_stokes_scratch_data.h:1354</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a30ca912e22e35000f7109061ad47726b"><div class="ttname"><a href="classNavierStokesScratchData.html#a30ca912e22e35000f7109061ad47726b">NavierStokesScratchData::calculate_physical_properties</a></div><div class="ttdeci">void calculate_physical_properties()</div><div class="ttdoc">Calculates the physical properties. This function calculates the physical properties that may be requ...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00433">navier_stokes_scratch_data.cc:433</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a32458393ad0bd016416c85b53a285013"><div class="ttname"><a href="classNavierStokesScratchData.html#a32458393ad0bd016416c85b53a285013">NavierStokesScratchData::phi_p</a></div><div class="ttdeci">Table&lt; 2, double &gt; phi_p</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01322">navier_stokes_scratch_data.h:1322</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a3377bdde203866dd8bd0d4670df2fb89"><div class="ttname"><a href="classNavierStokesScratchData.html#a3377bdde203866dd8bd0d4670df2fb89">NavierStokesScratchData::reinit_mortar</a></div><div class="ttdeci">void reinit_mortar(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;cell, const Parameters::Mortar&lt; dim &gt; &amp;mortar_parameters, const double &amp;radius)</div><div class="ttdoc">Renitialize the content of the scratch data for mortar.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00371">navier_stokes_scratch_data.cc:371</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a33b670f69579168534803ca45effeecd"><div class="ttname"><a href="classNavierStokesScratchData.html#a33b670f69579168534803ca45effeecd">NavierStokesScratchData::face_velocity_laplacians</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, dim &gt; &gt; &gt; face_velocity_laplacians</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01450">navier_stokes_scratch_data.h:1450</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a340f24792940c9a3f8fbd42e36fa0972"><div class="ttname"><a href="classNavierStokesScratchData.html#a340f24792940c9a3f8fbd42e36fa0972">NavierStokesScratchData::fe_values_cahn_hilliard</a></div><div class="ttdeci">std::shared_ptr&lt; FEValues&lt; dim &gt; &gt; fe_values_cahn_hilliard</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01412">navier_stokes_scratch_data.h:1412</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a342292f02eab0cb140f77cd12588775d"><div class="ttname"><a href="classNavierStokesScratchData.html#a342292f02eab0cb140f77cd12588775d">NavierStokesScratchData::kinematic_viscosity_1</a></div><div class="ttdeci">std::vector&lt; double &gt; kinematic_viscosity_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01264">navier_stokes_scratch_data.h:1264</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a35e6cecb73b9e5a9d2576b8208c77da8"><div class="ttname"><a href="classNavierStokesScratchData.html#a35e6cecb73b9e5a9d2576b8208c77da8">NavierStokesScratchData::previous_velocity_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, dim &gt; &gt; &gt; previous_velocity_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01313">navier_stokes_scratch_data.h:1313</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a388e56385b295cc88c28137a82f79aa2"><div class="ttname"><a href="classNavierStokesScratchData.html#a388e56385b295cc88c28137a82f79aa2">NavierStokesScratchData::kinematic_viscosity_0</a></div><div class="ttdeci">std::vector&lt; double &gt; kinematic_viscosity_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01263">navier_stokes_scratch_data.h:1263</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a39ac4958d1c97b955d55874904644a01"><div class="ttname"><a href="classNavierStokesScratchData.html#a39ac4958d1c97b955d55874904644a01">NavierStokesScratchData::phase_order_cahn_hilliard_gradients</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; phase_order_cahn_hilliard_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01405">navier_stokes_scratch_data.h:1405</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a3c148603b147b2f0e746395d8756ab52"><div class="ttname"><a href="classNavierStokesScratchData.html#a3c148603b147b2f0e746395d8756ab52">NavierStokesScratchData::reinit_heat_transfer</a></div><div class="ttdeci">void reinit_heat_transfer(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;cell, const VectorType &amp;current_solution, const std::vector&lt; VectorType &gt; &amp;previous_solutions)</div><div class="ttdoc">Reinitialize the content of the scratch for the heat transfer auxiliary physic.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01081">navier_stokes_scratch_data.h:1081</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a3dbda49d1128ac105d4d92b83fa47cc3"><div class="ttname"><a href="classNavierStokesScratchData.html#a3dbda49d1128ac105d4d92b83fa47cc3">NavierStokesScratchData::average_particle_velocity</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; average_particle_velocity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01365">navier_stokes_scratch_data.h:1365</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a3ea0ab72226feac5c12b4c018b2e7672"><div class="ttname"><a href="classNavierStokesScratchData.html#a3ea0ab72226feac5c12b4c018b2e7672">NavierStokesScratchData::gather_projected_phase_fraction_gradient</a></div><div class="ttdeci">bool gather_projected_phase_fraction_gradient</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01340">navier_stokes_scratch_data.h:1340</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a3ebc680707e5085db58fb099b5b97bd7"><div class="ttname"><a href="classNavierStokesScratchData.html#a3ebc680707e5085db58fb099b5b97bd7">NavierStokesScratchData::temperature_gradients</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; temperature_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01393">navier_stokes_scratch_data.h:1393</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a402dc7a9c4c505cb09842b649fbf0c81"><div class="ttname"><a href="classNavierStokesScratchData.html#a402dc7a9c4c505cb09842b649fbf0c81">NavierStokesScratchData::phase_gradient_values</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; phase_gradient_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01335">navier_stokes_scratch_data.h:1335</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a405da43dc1730f5de1a5a3683202ddbd"><div class="ttname"><a href="classNavierStokesScratchData.html#a405da43dc1730f5de1a5a3683202ddbd">NavierStokesScratchData::JxW</a></div><div class="ttdeci">Table&lt; 1, double &gt; JxW</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01297">navier_stokes_scratch_data.h:1297</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a425e384b23005541ab442a50b49560f4"><div class="ttname"><a href="classNavierStokesScratchData.html#a425e384b23005541ab442a50b49560f4">NavierStokesScratchData::previous_pressure_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; previous_pressure_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01312">navier_stokes_scratch_data.h:1312</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a44c0473dfbeadc8880372e632c45a885"><div class="ttname"><a href="classNavierStokesScratchData.html#a44c0473dfbeadc8880372e632c45a885">NavierStokesScratchData::density_scale</a></div><div class="ttdeci">double density_scale</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01256">navier_stokes_scratch_data.h:1256</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a450633f51bba8ae38aacb114003daf82"><div class="ttname"><a href="classNavierStokesScratchData.html#a450633f51bba8ae38aacb114003daf82">NavierStokesScratchData::phase_order</a></div><div class="ttdeci">FEValuesExtractors::Scalar phase_order</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01413">navier_stokes_scratch_data.h:1413</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a457d2cc982eb13afbfa39427f6c68807"><div class="ttname"><a href="classNavierStokesScratchData.html#a457d2cc982eb13afbfa39427f6c68807">NavierStokesScratchData::previous_temperature_gradients</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, dim &gt; &gt; &gt; previous_temperature_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01394">navier_stokes_scratch_data.h:1394</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a4757cd43b23a146abbbfb67be6fa7c81"><div class="ttname"><a href="classNavierStokesScratchData.html#a4757cd43b23a146abbbfb67be6fa7c81">NavierStokesScratchData::calculate_vof_at_particle_location</a></div><div class="ttdeci">void calculate_vof_at_particle_location(const Quadrature&lt; dim &gt; &amp;q_particles_location, const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;phase_cell, const VectorType &amp;current_filtered_solution)</div><div class="ttdoc">Interpolates the filtered VOF solution at the location of the particles. The latter values are used i...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00896">navier_stokes_scratch_data.h:896</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a4895405a50ddfcbec1a63454c7d754e6"><div class="ttname"><a href="classNavierStokesScratchData.html#a4895405a50ddfcbec1a63454c7d754e6">NavierStokesScratchData::average_fluid_particle_relative_velocity</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; average_fluid_particle_relative_velocity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01369">navier_stokes_scratch_data.h:1369</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a48de4521a4a6296ef1fdfaa90d123427"><div class="ttname"><a href="classNavierStokesScratchData.html#a48de4521a4a6296ef1fdfaa90d123427">NavierStokesScratchData::fe_values_void_fraction</a></div><div class="ttdeci">std::shared_ptr&lt; FEValues&lt; dim &gt; &gt; fe_values_void_fraction</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01356">navier_stokes_scratch_data.h:1356</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a49d6b95189b964ca9682f81c5b0f97b5"><div class="ttname"><a href="classNavierStokesScratchData.html#a49d6b95189b964ca9682f81c5b0f97b5">NavierStokesScratchData::reinit_particle_fluid_interactions</a></div><div class="ttdeci">void reinit_particle_fluid_interactions(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;velocity_cell, const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;void_fraction_cell, const VectorType &amp;, const VectorType &amp;previous_velocity_pressure_solution, const VectorType &amp;void_fraction_solution, const Particles::ParticleHandler&lt; dim &gt; &amp;particle_handler)</div><div class="ttdoc">Calculates the variables needed to compute the particle fluid interactions in the VANS equations.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00943">navier_stokes_scratch_data.h:943</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a49eb75df4a79112316a46d5f714f3b2b"><div class="ttname"><a href="classNavierStokesScratchData.html#a49eb75df4a79112316a46d5f714f3b2b">NavierStokesScratchData::density_ref</a></div><div class="ttdeci">double density_ref</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01231">navier_stokes_scratch_data.h:1231</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a49f74b732d4b2321493338e2d84a9911"><div class="ttname"><a href="classNavierStokesScratchData.html#a49f74b732d4b2321493338e2d84a9911">NavierStokesScratchData::filter</a></div><div class="ttdeci">std::shared_ptr&lt; VolumeOfFluidFilterBase &gt; filter</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01338">navier_stokes_scratch_data.h:1338</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a4a134fc3c9836109e4077f63c26a4e17"><div class="ttname"><a href="classNavierStokesScratchData.html#a4a134fc3c9836109e4077f63c26a4e17">NavierStokesScratchData::previous_temperature_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; previous_temperature_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01392">navier_stokes_scratch_data.h:1392</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a4b89c62b025b47447f51e9eea1bc2480"><div class="ttname"><a href="classNavierStokesScratchData.html#a4b89c62b025b47447f51e9eea1bc2480">NavierStokesScratchData::components</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; components</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01301">navier_stokes_scratch_data.h:1301</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a50e47e5746c3b8e513d798318938235b"><div class="ttname"><a href="classNavierStokesScratchData.html#a50e47e5746c3b8e513d798318938235b">NavierStokesScratchData::interpolated_void_fraction</a></div><div class="ttdeci">bool interpolated_void_fraction</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01362">navier_stokes_scratch_data.h:1362</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a51cadf33b64ca212d6b49e6bfa7be9e1"><div class="ttname"><a href="classNavierStokesScratchData.html#a51cadf33b64ca212d6b49e6bfa7be9e1">NavierStokesScratchData::enable_mortar</a></div><div class="ttdeci">void enable_mortar()</div><div class="ttdoc">enable_mortar Enables the calculation of the rotor rotation angle</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00364">navier_stokes_scratch_data.cc:364</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a539bd8eb9798dce1834fdf0a21b89e73"><div class="ttname"><a href="classNavierStokesScratchData.html#a539bd8eb9798dce1834fdf0a21b89e73">NavierStokesScratchData::n_dofs_void_fraction</a></div><div class="ttdeci">unsigned int n_dofs_void_fraction</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01351">navier_stokes_scratch_data.h:1351</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a5470704145930632762c7dee59207de1"><div class="ttname"><a href="classNavierStokesScratchData.html#a5470704145930632762c7dee59207de1">NavierStokesScratchData::cell_void_fraction</a></div><div class="ttdeci">std::vector&lt; double &gt; cell_void_fraction</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01376">navier_stokes_scratch_data.h:1376</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a54dd04719414e07ae63dc85c9845d1f8"><div class="ttname"><a href="classNavierStokesScratchData.html#a54dd04719414e07ae63dc85c9845d1f8">NavierStokesScratchData::n_dofs</a></div><div class="ttdeci">unsigned int n_dofs</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01285">navier_stokes_scratch_data.h:1285</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a55be20797a583dc74e98db1265f4e7b7"><div class="ttname"><a href="classNavierStokesScratchData.html#a55be20797a583dc74e98db1265f4e7b7">NavierStokesScratchData::compressibility_multiplier</a></div><div class="ttdeci">std::vector&lt; double &gt; compressibility_multiplier</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01260">navier_stokes_scratch_data.h:1260</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a566544b2f37645bd28a94073e42caf94"><div class="ttname"><a href="classNavierStokesScratchData.html#a566544b2f37645bd28a94073e42caf94">NavierStokesScratchData::velocity_gradients</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 2, dim &gt; &gt; velocity_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01306">navier_stokes_scratch_data.h:1306</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a578dfea0694f03cf3ab93953bbf37d91"><div class="ttname"><a href="classNavierStokesScratchData.html#a578dfea0694f03cf3ab93953bbf37d91">NavierStokesScratchData::surface_tension_gradient</a></div><div class="ttdeci">std::vector&lt; double &gt; surface_tension_gradient</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01281">navier_stokes_scratch_data.h:1281</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a59bab3e52c8e29cf84473965f49baefe"><div class="ttname"><a href="classNavierStokesScratchData.html#a59bab3e52c8e29cf84473965f49baefe">NavierStokesScratchData::enable_heat_transfer</a></div><div class="ttdeci">void enable_heat_transfer(const FiniteElement&lt; dim &gt; &amp;fe, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping)</div><div class="ttdoc">enable_heat_transfer Enables the collection of the heat transfer data (Temperature field) by the scra...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00409">navier_stokes_scratch_data.cc:409</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a59cf6c71f993b535281774fb63838cbd"><div class="ttname"><a href="classNavierStokesScratchData.html#a59cf6c71f993b535281774fb63838cbd">NavierStokesScratchData::reinit_void_fraction</a></div><div class="ttdeci">void reinit_void_fraction(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;cell, const VectorType &amp;current_solution, const std::vector&lt; VectorType &gt; &amp;previous_solutions)</div><div class="ttdoc">Reinitialize the content of the scratch for the void fraction.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00599">navier_stokes_scratch_data.h:599</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a5c0fe0240fc3541e95df2896b0231e84"><div class="ttname"><a href="classNavierStokesScratchData.html#a5c0fe0240fc3541e95df2896b0231e84">NavierStokesScratchData::previous_density</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; previous_density</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01243">navier_stokes_scratch_data.h:1243</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a5f0b2159838caaa058d098021f9e39ff"><div class="ttname"><a href="classNavierStokesScratchData.html#a5f0b2159838caaa058d098021f9e39ff">NavierStokesScratchData::pressure</a></div><div class="ttdeci">FEValuesExtractors::Scalar pressure</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01289">navier_stokes_scratch_data.h:1289</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a5f65155a6dcfa12516d5357049ecba5b"><div class="ttname"><a href="classNavierStokesScratchData.html#a5f65155a6dcfa12516d5357049ecba5b">NavierStokesScratchData::surface_tension</a></div><div class="ttdeci">std::vector&lt; double &gt; surface_tension</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01280">navier_stokes_scratch_data.h:1280</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a615e771dac9cdc466d96a437076c0f3e"><div class="ttname"><a href="classNavierStokesScratchData.html#a615e771dac9cdc466d96a437076c0f3e">NavierStokesScratchData::density_0</a></div><div class="ttdeci">std::vector&lt; double &gt; density_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01250">navier_stokes_scratch_data.h:1250</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a62323c078408373c8553c6c4a19b83be"><div class="ttname"><a href="classNavierStokesScratchData.html#a62323c078408373c8553c6c4a19b83be">NavierStokesScratchData::particle_reference_location</a></div><div class="ttdeci">std::vector&lt; Point&lt; dim &gt; &gt; particle_reference_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01374">navier_stokes_scratch_data.h:1374</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a64034d9ed0a70afc50b0c275ea59d62f"><div class="ttname"><a href="classNavierStokesScratchData.html#a64034d9ed0a70afc50b0c275ea59d62f">NavierStokesScratchData::fe_values</a></div><div class="ttdeci">FEValues&lt; dim &gt; fe_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01284">navier_stokes_scratch_data.h:1284</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a65dbc42537a82ed88779ee994c35d6af"><div class="ttname"><a href="classNavierStokesScratchData.html#a65dbc42537a82ed88779ee994c35d6af">NavierStokesScratchData::n_faces_q_points</a></div><div class="ttdeci">unsigned int n_faces_q_points</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01433">navier_stokes_scratch_data.h:1433</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a661e62ccc078b9798322641b2c56655c"><div class="ttname"><a href="classNavierStokesScratchData.html#a661e62ccc078b9798322641b2c56655c">NavierStokesScratchData::enable_particle_fluid_interactions</a></div><div class="ttdeci">void enable_particle_fluid_interactions(const unsigned int n_global_max_particles_per_cell, const bool enable_void_fraction_interpolation)</div><div class="ttdoc">enable_particle_fluid_interactions Enables the calculation of the fluid information at the particle l...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00337">navier_stokes_scratch_data.cc:337</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a66da7daca38fcd92aa0bb2f41a75ab3c"><div class="ttname"><a href="classNavierStokesScratchData.html#a66da7daca38fcd92aa0bb2f41a75ab3c">NavierStokesScratchData::face_n_dofs</a></div><div class="ttdeci">unsigned int face_n_dofs</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01434">navier_stokes_scratch_data.h:1434</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6937a49938e44bf91ff473c99e176561"><div class="ttname"><a href="classNavierStokesScratchData.html#a6937a49938e44bf91ff473c99e176561">NavierStokesScratchData::enable_projected_phase_fraction_gradient</a></div><div class="ttdeci">void enable_projected_phase_fraction_gradient(const FiniteElement&lt; dim &gt; &amp;fe_projected_phase_fraction_gradient, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping)</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00274">navier_stokes_scratch_data.cc:274</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6aa64fd685358a4990eb37189602d20f"><div class="ttname"><a href="classNavierStokesScratchData.html#a6aa64fd685358a4990eb37189602d20f">NavierStokesScratchData::quadrature_points</a></div><div class="ttdeci">std::vector&lt; Point&lt; dim &gt; &gt; quadrature_points</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01298">navier_stokes_scratch_data.h:1298</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6adf340668d1ce441c03309e163045ee"><div class="ttname"><a href="classNavierStokesScratchData.html#a6adf340668d1ce441c03309e163045ee">NavierStokesScratchData::undisturbed_flow_force</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; undisturbed_flow_force</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01383">navier_stokes_scratch_data.h:1383</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6c7b8433dc947341f4bb84ae42ad3221"><div class="ttname"><a href="classNavierStokesScratchData.html#a6c7b8433dc947341f4bb84ae42ad3221">NavierStokesScratchData::n_faces</a></div><div class="ttdeci">unsigned int n_faces</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01432">navier_stokes_scratch_data.h:1432</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6ddebf3c3b40b8989c7ab25fd83c4b5c"><div class="ttname"><a href="classNavierStokesScratchData.html#a6ddebf3c3b40b8989c7ab25fd83c4b5c">NavierStokesScratchData::calculate_force_parameters_at_particle_location</a></div><div class="ttdeci">void calculate_force_parameters_at_particle_location()</div><div class="ttdoc">Calculates the velocity of the fluid relative to that of the particle and the particle Reynolds numbe...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00848">navier_stokes_scratch_data.h:848</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6e54265ec4571075921ef83518d38c36"><div class="ttname"><a href="classNavierStokesScratchData.html#a6e54265ec4571075921ef83518d38c36">NavierStokesScratchData::fluid_particle_relative_velocity_at_particle_location</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; fluid_particle_relative_velocity_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01368">navier_stokes_scratch_data.h:1368</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6ecba60f4ef7a7c6e0c49c688464d990"><div class="ttname"><a href="classNavierStokesScratchData.html#a6ecba60f4ef7a7c6e0c49c688464d990">NavierStokesScratchData::gather_curvature</a></div><div class="ttdeci">bool gather_curvature</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01341">navier_stokes_scratch_data.h:1341</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a6fb8903e517afdf6ae84667e6dc118ff"><div class="ttname"><a href="classNavierStokesScratchData.html#a6fb8903e517afdf6ae84667e6dc118ff">NavierStokesScratchData::face_hess_phi_u</a></div><div class="ttdeci">Table&lt; 3, Tensor&lt; 3, dim &gt; &gt; face_hess_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01458">navier_stokes_scratch_data.h:1458</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a70fd7e5971c2481ba307bc08f90f60b0"><div class="ttname"><a href="classNavierStokesScratchData.html#a70fd7e5971c2481ba307bc08f90f60b0">NavierStokesScratchData::phi_u</a></div><div class="ttdeci">Table&lt; 2, Tensor&lt; 1, dim &gt; &gt; phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01318">navier_stokes_scratch_data.h:1318</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a732e9107c27d323f8d013e214dbcd223"><div class="ttname"><a href="classNavierStokesScratchData.html#a732e9107c27d323f8d013e214dbcd223">NavierStokesScratchData::void_fraction_values</a></div><div class="ttdeci">std::vector&lt; double &gt; void_fraction_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01352">navier_stokes_scratch_data.h:1352</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a75b812c13d59aa2d7dccb006301ae84e"><div class="ttname"><a href="classNavierStokesScratchData.html#a75b812c13d59aa2d7dccb006301ae84e">NavierStokesScratchData::calculate_fluid_properties_at_particle_location</a></div><div class="ttdeci">void calculate_fluid_properties_at_particle_location()</div><div class="ttdoc">Calculates the properties of the fluid at the locations of the particles. At the moment,...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00790">navier_stokes_scratch_data.h:790</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a77665366e5d77005ed30767b65a5e4f7"><div class="ttname"><a href="classNavierStokesScratchData.html#a77665366e5d77005ed30767b65a5e4f7">NavierStokesScratchData::density_psi_0</a></div><div class="ttdeci">double density_psi_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01254">navier_stokes_scratch_data.h:1254</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a77a8a872036804121a9eb9f73a23b7f5"><div class="ttname"><a href="classNavierStokesScratchData.html#a77a8a872036804121a9eb9f73a23b7f5">NavierStokesScratchData::projected_phase_fraction_gradient_values</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; projected_phase_fraction_gradient_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01344">navier_stokes_scratch_data.h:1344</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a7a125a0005aafb952cd026b445ee0b6b"><div class="ttname"><a href="classNavierStokesScratchData.html#a7a125a0005aafb952cd026b445ee0b6b">NavierStokesScratchData::dynamic_viscosity_for_stabilization_1</a></div><div class="ttdeci">std::vector&lt; double &gt; dynamic_viscosity_for_stabilization_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01277">navier_stokes_scratch_data.h:1277</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a7a5de95e31fb3562e2ceaf0970fda02e"><div class="ttname"><a href="classNavierStokesScratchData.html#a7a5de95e31fb3562e2ceaf0970fda02e">NavierStokesScratchData::fe_values_projected_phase_fraction_gradient</a></div><div class="ttdeci">std::shared_ptr&lt; FEValues&lt; dim &gt; &gt; fe_values_projected_phase_fraction_gradient</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01342">navier_stokes_scratch_data.h:1342</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a7a84adbf5b1f22f5a91c0f27dd1748e1"><div class="ttname"><a href="classNavierStokesScratchData.html#a7a84adbf5b1f22f5a91c0f27dd1748e1">NavierStokesScratchData::fields</a></div><div class="ttdeci">std::map&lt; field, std::vector&lt; double &gt; &gt; fields</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01229">navier_stokes_scratch_data.h:1229</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a80675043762c14c602da2c651248d2c6"><div class="ttname"><a href="classNavierStokesScratchData.html#a80675043762c14c602da2c651248d2c6">NavierStokesScratchData::gather_cahn_hilliard</a></div><div class="ttdeci">bool gather_cahn_hilliard</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01401">navier_stokes_scratch_data.h:1401</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a8150ab425914422919793a5a0a4bf3af"><div class="ttname"><a href="classNavierStokesScratchData.html#a8150ab425914422919793a5a0a4bf3af">NavierStokesScratchData::dynamic_viscosity_0</a></div><div class="ttdeci">std::vector&lt; double &gt; dynamic_viscosity_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01261">navier_stokes_scratch_data.h:1261</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a8210e7b229953704ed77819e7abc38e8"><div class="ttname"><a href="classNavierStokesScratchData.html#a8210e7b229953704ed77819e7abc38e8">NavierStokesScratchData::density_ref_1</a></div><div class="ttdeci">double density_ref_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01253">navier_stokes_scratch_data.h:1253</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a82d5130ae1a9d00a7328d3a7db44d666"><div class="ttname"><a href="classNavierStokesScratchData.html#a82d5130ae1a9d00a7328d3a7db44d666">NavierStokesScratchData::kinematic_viscosity_scale</a></div><div class="ttdeci">double kinematic_viscosity_scale</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01235">navier_stokes_scratch_data.h:1235</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a84fa7f09cd33151a56e6655bcd19c61e"><div class="ttname"><a href="classNavierStokesScratchData.html#a84fa7f09cd33151a56e6655bcd19c61e">NavierStokesScratchData::kinematic_viscosity</a></div><div class="ttdeci">std::vector&lt; double &gt; kinematic_viscosity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01234">navier_stokes_scratch_data.h:1234</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a853bc7f1f89073ba31f04e869c382290"><div class="ttname"><a href="classNavierStokesScratchData.html#a853bc7f1f89073ba31f04e869c382290">NavierStokesScratchData::fluid_velocity_curls_at_particle_location_2d</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, 1 &gt; &gt; fluid_velocity_curls_at_particle_location_2d</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01372">navier_stokes_scratch_data.h:1372</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a853be5072710d046742d14590199db78"><div class="ttname"><a href="classNavierStokesScratchData.html#a853be5072710d046742d14590199db78">NavierStokesScratchData::particle_weights</a></div><div class="ttdeci">std::vector&lt; double &gt; particle_weights</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01375">navier_stokes_scratch_data.h:1375</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a85c0cf98990e2f944e1043a13577d78b"><div class="ttname"><a href="classNavierStokesScratchData.html#a85c0cf98990e2f944e1043a13577d78b">NavierStokesScratchData::is_boundary_face</a></div><div class="ttdeci">std::vector&lt; bool &gt; is_boundary_face</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01437">navier_stokes_scratch_data.h:1437</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a874ee56d946ee54f5848bd5d0b42b9bc"><div class="ttname"><a href="classNavierStokesScratchData.html#a874ee56d946ee54f5848bd5d0b42b9bc">NavierStokesScratchData::thermal_expansion_0</a></div><div class="ttdeci">std::vector&lt; double &gt; thermal_expansion_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01278">navier_stokes_scratch_data.h:1278</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a87cd5671045169b0b25e99ad568369f7"><div class="ttname"><a href="classNavierStokesScratchData.html#a87cd5671045169b0b25e99ad568369f7">NavierStokesScratchData::number_of_particles</a></div><div class="ttdeci">unsigned int number_of_particles</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01379">navier_stokes_scratch_data.h:1379</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a899d3f71f0c5958d0a5a6321b5d1b62c"><div class="ttname"><a href="classNavierStokesScratchData.html#a899d3f71f0c5958d0a5a6321b5d1b62c">NavierStokesScratchData::calculate_void_fraction_at_particle_location</a></div><div class="ttdeci">void calculate_void_fraction_at_particle_location(const Quadrature&lt; dim &gt; &amp;q_particles_location, const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;void_fraction_cell, const VectorType &amp;void_fraction_solution)</div><div class="ttdoc">Interpolates the void fraction at the locations of the particles.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00759">navier_stokes_scratch_data.h:759</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a89be382ee756efb20600f131017a5d33"><div class="ttname"><a href="classNavierStokesScratchData.html#a89be382ee756efb20600f131017a5d33">NavierStokesScratchData::reinit_cahn_hilliard</a></div><div class="ttdeci">void reinit_cahn_hilliard(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;cell, const VectorType &amp;current_solution, const VectorType &amp;current_filtered_solution)</div><div class="ttdoc">Reinitialize the content of the scratch for CH.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01167">navier_stokes_scratch_data.h:1167</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a8a004531a8787367955a1a4345bb0de0"><div class="ttname"><a href="classNavierStokesScratchData.html#a8a004531a8787367955a1a4345bb0de0">NavierStokesScratchData::calculate_fluid_fields_at_particle_location</a></div><div class="ttdeci">void calculate_fluid_fields_at_particle_location(const Quadrature&lt; dim &gt; &amp;q_particles_location, const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;velocity_cell, const VectorType &amp;velocity_pressure_solution)</div><div class="ttdoc">Interpolates the velocity and pressure of the fluid, as well as the pressure gradient,...</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00696">navier_stokes_scratch_data.h:696</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a8a93306de6e1cd56c819318e8253f2a5"><div class="ttname"><a href="classNavierStokesScratchData.html#a8a93306de6e1cd56c819318e8253f2a5">NavierStokesScratchData::velocity_values</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; velocity_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01304">navier_stokes_scratch_data.h:1304</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a8b3fe310d5cc130bb0ce50c44d7d78df"><div class="ttname"><a href="classNavierStokesScratchData.html#a8b3fe310d5cc130bb0ce50c44d7d78df">NavierStokesScratchData::fe_values_temperature</a></div><div class="ttdeci">std::shared_ptr&lt; FEValues&lt; dim &gt; &gt; fe_values_temperature</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01396">navier_stokes_scratch_data.h:1396</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a8d7c491f60dacd4d624b3665e4e4372c"><div class="ttname"><a href="classNavierStokesScratchData.html#a8d7c491f60dacd4d624b3665e4e4372c">NavierStokesScratchData::face_div_phi_u</a></div><div class="ttdeci">Table&lt; 3, double &gt; face_div_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01456">navier_stokes_scratch_data.h:1456</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a91011b4cd4861cad33fe26dd60c010b8"><div class="ttname"><a href="classNavierStokesScratchData.html#a91011b4cd4861cad33fe26dd60c010b8">NavierStokesScratchData::Re_particle</a></div><div class="ttdeci">std::vector&lt; double &gt; Re_particle</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01377">navier_stokes_scratch_data.h:1377</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a95349c742f9be9d55490462c30a1c9fb"><div class="ttname"><a href="classNavierStokesScratchData.html#a95349c742f9be9d55490462c30a1c9fb">NavierStokesScratchData::grad_phi_u</a></div><div class="ttdeci">Table&lt; 2, Tensor&lt; 2, dim &gt; &gt; grad_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01321">navier_stokes_scratch_data.h:1321</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a963f460a1a06ad5969f0ae5a21c2b5ca"><div class="ttname"><a href="classNavierStokesScratchData.html#a963f460a1a06ad5969f0ae5a21c2b5ca">NavierStokesScratchData::curvature_values</a></div><div class="ttdeci">std::vector&lt; double &gt; curvature_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01345">navier_stokes_scratch_data.h:1345</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a981998a12120f1637b795299af81151f"><div class="ttname"><a href="classNavierStokesScratchData.html#a981998a12120f1637b795299af81151f">NavierStokesScratchData::filtered_phase_values_at_particle_location</a></div><div class="ttdeci">std::vector&lt; double &gt; filtered_phase_values_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01332">navier_stokes_scratch_data.h:1332</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a981c3e639a7e753c867a48d835f2b9b9"><div class="ttname"><a href="classNavierStokesScratchData.html#a981c3e639a7e753c867a48d835f2b9b9">NavierStokesScratchData::hess_phi_u</a></div><div class="ttdeci">Table&lt; 2, Tensor&lt; 3, dim &gt; &gt; hess_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01319">navier_stokes_scratch_data.h:1319</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a991574ac5b97689773fd0108eeab24a0"><div class="ttname"><a href="classNavierStokesScratchData.html#a991574ac5b97689773fd0108eeab24a0">NavierStokesScratchData::reinit</a></div><div class="ttdeci">void reinit(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;cell, const VectorType &amp;current_solution, const std::vector&lt; VectorType &gt; &amp;previous_solutions, const VectorType &amp;sum_over_previous_stages, std::shared_ptr&lt; Function&lt; dim &gt; &gt; forcing_function, Tensor&lt; 1, dim &gt; beta_force, const double pressure_scaling_factor)</div><div class="ttdoc">Reinitializes the content of the scratch.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00225">navier_stokes_scratch_data.h:225</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a9a9121f92c46736d4be8b92933fb6874"><div class="ttname"><a href="classNavierStokesScratchData.html#a9a9121f92c46736d4be8b92933fb6874">NavierStokesScratchData::cahn_hilliard_filter</a></div><div class="ttdeci">std::shared_ptr&lt; CahnHilliardFilterBase &gt; cahn_hilliard_filter</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01409">navier_stokes_scratch_data.h:1409</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a9acf89bc99f2fcfc1a454e0ffec12911"><div class="ttname"><a href="classNavierStokesScratchData.html#a9acf89bc99f2fcfc1a454e0ffec12911">NavierStokesScratchData::phase_values</a></div><div class="ttdeci">std::vector&lt; double &gt; phase_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01330">navier_stokes_scratch_data.h:1330</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a9b57679638ab4f0b90a3d7e2c7c2c32c"><div class="ttname"><a href="classNavierStokesScratchData.html#a9b57679638ab4f0b90a3d7e2c7c2c32c">NavierStokesScratchData::cell_size</a></div><div class="ttdeci">double cell_size</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01287">navier_stokes_scratch_data.h:1287</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a9e58737ebcfc6340e1a42f53056c7a2d"><div class="ttname"><a href="classNavierStokesScratchData.html#a9e58737ebcfc6340e1a42f53056c7a2d">NavierStokesScratchData::pic</a></div><div class="ttdeci">Particles::ParticleHandler&lt; dim &gt;::particle_iterator_range pic</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01380">navier_stokes_scratch_data.h:1380</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_a9f3a9b09303fb38071eba70e6392dc0c"><div class="ttname"><a href="classNavierStokesScratchData.html#a9f3a9b09303fb38071eba70e6392dc0c">NavierStokesScratchData::enable_curvature</a></div><div class="ttdeci">void enable_curvature(const FiniteElement&lt; dim &gt; &amp;fe_curvature, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping)</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00294">navier_stokes_scratch_data.cc:294</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa02f906b4d33a632cd21d38eefff32ce"><div class="ttname"><a href="classNavierStokesScratchData.html#aa02f906b4d33a632cd21d38eefff32ce">NavierStokesScratchData::laplacian_phi_u</a></div><div class="ttdeci">Table&lt; 2, Tensor&lt; 1, dim &gt; &gt; laplacian_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01320">navier_stokes_scratch_data.h:1320</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa10f5197d2a06f1d40525bdf8493d8c6"><div class="ttname"><a href="classNavierStokesScratchData.html#aa10f5197d2a06f1d40525bdf8493d8c6">NavierStokesScratchData::face_velocity_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, dim &gt; &gt; &gt; face_velocity_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01447">navier_stokes_scratch_data.h:1447</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa2e6cff4889a98d9ed713209ad8e9a06"><div class="ttname"><a href="classNavierStokesScratchData.html#aa2e6cff4889a98d9ed713209ad8e9a06">NavierStokesScratchData::gather_particles_reference_location</a></div><div class="ttdeci">Quadrature&lt; dim &gt; gather_particles_reference_location()</div><div class="ttdoc">Creates an object of type Quadrature&lt;dim&gt; that contains the particle reference location....</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00758">navier_stokes_scratch_data.cc:758</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa3ac2a1e98dd07b62ee49f808642ce09"><div class="ttname"><a href="classNavierStokesScratchData.html#aa3ac2a1e98dd07b62ee49f808642ce09">NavierStokesScratchData::enable_vof</a></div><div class="ttdeci">void enable_vof(const FiniteElement&lt; dim &gt; &amp;fe, const Quadrature&lt; dim &gt; &amp;quadrature, const Mapping&lt; dim &gt; &amp;mapping, const Parameters::VOF_PhaseFilter &amp;phase_filter_parameters)</div><div class="ttdoc">enable_vof Enables the collection of the VOF data by the scratch</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00095">navier_stokes_scratch_data.cc:95</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa48c218f4f67db5887e6036756508bbd"><div class="ttname"><a href="classNavierStokesScratchData.html#aa48c218f4f67db5887e6036756508bbd">NavierStokesScratchData::previous_void_fraction_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; previous_void_fraction_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01353">navier_stokes_scratch_data.h:1353</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa4a64740ac957fea527533e95b5ca233"><div class="ttname"><a href="classNavierStokesScratchData.html#aa4a64740ac957fea527533e95b5ca233">NavierStokesScratchData::n_dofs_cahn_hilliard</a></div><div class="ttdeci">unsigned int n_dofs_cahn_hilliard</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01402">navier_stokes_scratch_data.h:1402</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aa750e3f05a771a2e56c29f5d6e27e202"><div class="ttname"><a href="classNavierStokesScratchData.html#aa750e3f05a771a2e56c29f5d6e27e202">NavierStokesScratchData::shear_rate</a></div><div class="ttdeci">std::vector&lt; double &gt; shear_rate</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01309">navier_stokes_scratch_data.h:1309</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aaf28c142ac8fd80e605d236c5770f11f"><div class="ttname"><a href="classNavierStokesScratchData.html#aaf28c142ac8fd80e605d236c5770f11f">NavierStokesScratchData::phase_order_cahn_hilliard_values</a></div><div class="ttdeci">std::vector&lt; double &gt; phase_order_cahn_hilliard_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01403">navier_stokes_scratch_data.h:1403</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ab059ac1bfc7ed0fc0f1540ead8fa59f0"><div class="ttname"><a href="classNavierStokesScratchData.html#ab059ac1bfc7ed0fc0f1540ead8fa59f0">NavierStokesScratchData::reinit_particle_fluid_forces</a></div><div class="ttdeci">void reinit_particle_fluid_forces()</div><div class="ttdoc">Reinitializes the fluid forces and torques on the particles in the cell to zero.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00671">navier_stokes_scratch_data.cc:671</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ab1202093c4ca2dfbbce9b93b93cc9b14"><div class="ttname"><a href="classNavierStokesScratchData.html#ab1202093c4ca2dfbbce9b93b93cc9b14">NavierStokesScratchData::particle_velocity</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; particle_velocity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01364">navier_stokes_scratch_data.h:1364</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ab12122ce6e915131ae74691c0aaf8a11"><div class="ttname"><a href="classNavierStokesScratchData.html#ab12122ce6e915131ae74691c0aaf8a11">NavierStokesScratchData::chemical_potential</a></div><div class="ttdeci">FEValuesExtractors::Scalar chemical_potential</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01414">navier_stokes_scratch_data.h:1414</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ab297c915f78a5aa41da5f0f1a476944f"><div class="ttname"><a href="classNavierStokesScratchData.html#ab297c915f78a5aa41da5f0f1a476944f">NavierStokesScratchData::n_q_points</a></div><div class="ttdeci">unsigned int n_q_points</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01286">navier_stokes_scratch_data.h:1286</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ab42fb46ce7737929c7b76f6faa1a8a86"><div class="ttname"><a href="classNavierStokesScratchData.html#ab42fb46ce7737929c7b76f6faa1a8a86">NavierStokesScratchData::filtered_phase_gradient_values</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; filtered_phase_gradient_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01334">navier_stokes_scratch_data.h:1334</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ab6df2938e916f981c39c1deaacbe4d03"><div class="ttname"><a href="classNavierStokesScratchData.html#ab6df2938e916f981c39c1deaacbe4d03">NavierStokesScratchData::face_pressure_gradients</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, dim &gt; &gt; &gt; face_pressure_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01452">navier_stokes_scratch_data.h:1452</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_abd334c0baa72b939278f4b2869371414"><div class="ttname"><a href="classNavierStokesScratchData.html#abd334c0baa72b939278f4b2869371414">NavierStokesScratchData::face_phi_u</a></div><div class="ttdeci">Table&lt; 3, Tensor&lt; 1, dim &gt; &gt; face_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01457">navier_stokes_scratch_data.h:1457</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_abec92bb60f2174b1d4f0fc674420ece9"><div class="ttname"><a href="classNavierStokesScratchData.html#abec92bb60f2174b1d4f0fc674420ece9">NavierStokesScratchData::dynamic_viscosity_1</a></div><div class="ttdeci">std::vector&lt; double &gt; dynamic_viscosity_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01262">navier_stokes_scratch_data.h:1262</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ac05774c7b7819ddfec872a43af036b9c"><div class="ttname"><a href="classNavierStokesScratchData.html#ac05774c7b7819ddfec872a43af036b9c">NavierStokesScratchData::temperature_values</a></div><div class="ttdeci">std::vector&lt; double &gt; temperature_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01391">navier_stokes_scratch_data.h:1391</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ac0c8bbc5f5970cab5fb230b53070fbf8"><div class="ttname"><a href="classNavierStokesScratchData.html#ac0c8bbc5f5970cab5fb230b53070fbf8">NavierStokesScratchData::fluid_velocity_at_particle_location</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; fluid_velocity_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01366">navier_stokes_scratch_data.h:1366</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ac45b659821eec6e1fa6c8ecd2cae5415"><div class="ttname"><a href="classNavierStokesScratchData.html#ac45b659821eec6e1fa6c8ecd2cae5415">NavierStokesScratchData::gather_temperature</a></div><div class="ttdeci">bool gather_temperature</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01389">navier_stokes_scratch_data.h:1389</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ac56d38ff514f674f06df2d66d50ae980"><div class="ttname"><a href="classNavierStokesScratchData.html#ac56d38ff514f674f06df2d66d50ae980">NavierStokesScratchData::gather_void_fraction</a></div><div class="ttdeci">bool gather_void_fraction</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01350">navier_stokes_scratch_data.h:1350</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ac7d601c55618c1618aeaa585f6f0552f"><div class="ttname"><a href="classNavierStokesScratchData.html#ac7d601c55618c1618aeaa585f6f0552f">NavierStokesScratchData::density_ref_0</a></div><div class="ttdeci">double density_ref_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01252">navier_stokes_scratch_data.h:1252</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ac89d0f424dfb61cab155a75d1bcab036"><div class="ttname"><a href="classNavierStokesScratchData.html#ac89d0f424dfb61cab155a75d1bcab036">NavierStokesScratchData::fluid_velocity_curls_at_particle_location_3d</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, 3 &gt; &gt; fluid_velocity_curls_at_particle_location_3d</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01373">navier_stokes_scratch_data.h:1373</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_acc2f4cf7c08898d8ff4172e2e07ce260"><div class="ttname"><a href="classNavierStokesScratchData.html#acc2f4cf7c08898d8ff4172e2e07ce260">NavierStokesScratchData::boundary_face_id</a></div><div class="ttdeci">std::vector&lt; unsigned int &gt; boundary_face_id</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01438">navier_stokes_scratch_data.h:1438</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_acdbc2067fb56794ff053c86100b7124f"><div class="ttname"><a href="classNavierStokesScratchData.html#acdbc2067fb56794ff053c86100b7124f">NavierStokesScratchData::density_psi_1</a></div><div class="ttdeci">double density_psi_1</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01255">navier_stokes_scratch_data.h:1255</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad1fc7d24a864a2e16f6e116cf1e9753d"><div class="ttname"><a href="classNavierStokesScratchData.html#ad1fc7d24a864a2e16f6e116cf1e9753d">NavierStokesScratchData::simulation_control</a></div><div class="ttdeci">const std::shared_ptr&lt; SimulationControl &gt; simulation_control</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01225">navier_stokes_scratch_data.h:1225</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad20a933f0fb20cca56c20f8a61c869bb"><div class="ttname"><a href="classNavierStokesScratchData.html#ad20a933f0fb20cca56c20f8a61c869bb">NavierStokesScratchData::density_psi</a></div><div class="ttdeci">double density_psi</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01232">navier_stokes_scratch_data.h:1232</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad3150bbed772e9ada4dce841e0d2de97"><div class="ttname"><a href="classNavierStokesScratchData.html#ad3150bbed772e9ada4dce841e0d2de97">NavierStokesScratchData::reinit_particle_fluid_interactions</a></div><div class="ttdeci">void reinit_particle_fluid_interactions(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;velocity_cell, const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;void_fraction_cell, const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;phase_cell, const VectorType &amp;, const VectorType &amp;previous_velocity_pressure_solution, const VectorType &amp;void_fraction_solution, const Particles::ParticleHandler&lt; dim &gt; &amp;particle_handler, const VectorType &amp;current_filtered_solution)</div><div class="ttdoc">Calculates the variables needed to compute the particle fluid interactions in the VANS equations....</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01010">navier_stokes_scratch_data.h:1010</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad3a36ee74822fecc5ee3f63facc7d2ad"><div class="ttname"><a href="classNavierStokesScratchData.html#ad3a36ee74822fecc5ee3f63facc7d2ad">NavierStokesScratchData::kinematic_viscosity_for_stabilization</a></div><div class="ttdeci">std::vector&lt; double &gt; kinematic_viscosity_for_stabilization</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01238">navier_stokes_scratch_data.h:1238</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad53462b1362da031efce498558afbdf9"><div class="ttname"><a href="classNavierStokesScratchData.html#ad53462b1362da031efce498558afbdf9">NavierStokesScratchData::gather_hessian</a></div><div class="ttdeci">bool gather_hessian</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01428">navier_stokes_scratch_data.h:1428</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad824df2b7790211977cea193a1810af8"><div class="ttname"><a href="classNavierStokesScratchData.html#ad824df2b7790211977cea193a1810af8">NavierStokesScratchData::rhs_force</a></div><div class="ttdeci">std::vector&lt; Vector&lt; double &gt; &gt; rhs_force</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01291">navier_stokes_scratch_data.h:1291</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad8eaa43dddfe9c8dd2d3fccdb1375062"><div class="ttname"><a href="classNavierStokesScratchData.html#ad8eaa43dddfe9c8dd2d3fccdb1375062">NavierStokesScratchData::filtered_phase_values</a></div><div class="ttdeci">std::vector&lt; double &gt; filtered_phase_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01331">navier_stokes_scratch_data.h:1331</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ad98b8bde0f425d5269cde4132d5cdfd3"><div class="ttname"><a href="classNavierStokesScratchData.html#ad98b8bde0f425d5269cde4132d5cdfd3">NavierStokesScratchData::allocate</a></div><div class="ttdeci">void allocate() override</div><div class="ttdoc">Allocates the memory for the scratch.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00011">navier_stokes_scratch_data.cc:11</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ada4d466d38ae48bee70c5b562e4a74af"><div class="ttname"><a href="classNavierStokesScratchData.html#ada4d466d38ae48bee70c5b562e4a74af">NavierStokesScratchData::reinit_curvature</a></div><div class="ttdeci">void reinit_curvature(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;curvature_cell, const VectorType &amp;current_curvature_solution)</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00553">navier_stokes_scratch_data.h:553</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adaa0ede5e0e15a6c423d648d51fd55a0"><div class="ttname"><a href="classNavierStokesScratchData.html#adaa0ede5e0e15a6c423d648d51fd55a0">NavierStokesScratchData::fluid_velocity_laplacian_at_particle_location</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; fluid_velocity_laplacian_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01371">navier_stokes_scratch_data.h:1371</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adbd62f1711f3edcf392271e9d0b4e6e6"><div class="ttname"><a href="classNavierStokesScratchData.html#adbd62f1711f3edcf392271e9d0b4e6e6">NavierStokesScratchData::face_grad_phi_p</a></div><div class="ttdeci">Table&lt; 3, Tensor&lt; 1, dim &gt; &gt; face_grad_phi_p</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01462">navier_stokes_scratch_data.h:1462</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adc5876c2ab3a6358caac55eacd49b6df"><div class="ttname"><a href="classNavierStokesScratchData.html#adc5876c2ab3a6358caac55eacd49b6df">NavierStokesScratchData::velocity_divergences</a></div><div class="ttdeci">std::vector&lt; double &gt; velocity_divergences</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01305">navier_stokes_scratch_data.h:1305</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adcc81802d5c41910ef956b07d740b943"><div class="ttname"><a href="classNavierStokesScratchData.html#adcc81802d5c41910ef956b07d740b943">NavierStokesScratchData::rotor_linear_velocity_values</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; rotor_linear_velocity_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01420">navier_stokes_scratch_data.h:1420</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_add32ba3d3e8df614b7cb332483226d5f"><div class="ttname"><a href="classNavierStokesScratchData.html#add32ba3d3e8df614b7cb332483226d5f">NavierStokesScratchData::dynamic_viscosity_for_stabilization</a></div><div class="ttdeci">std::vector&lt; double &gt; dynamic_viscosity_for_stabilization</div><div class="ttdoc">Values of the dynamic viscosity used in the SUPG and PSPG stabilizations.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01240">navier_stokes_scratch_data.h:1240</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ade08aef1aa4ab5ec0bde23394c92c348"><div class="ttname"><a href="classNavierStokesScratchData.html#ade08aef1aa4ab5ec0bde23394c92c348">NavierStokesScratchData::density_at_particle_location</a></div><div class="ttdeci">std::vector&lt; double &gt; density_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01259">navier_stokes_scratch_data.h:1259</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adf8f8020ea98df223151cccd92a2e738"><div class="ttname"><a href="classNavierStokesScratchData.html#adf8f8020ea98df223151cccd92a2e738">NavierStokesScratchData::face_velocity_divergences</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; face_velocity_divergences</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01448">navier_stokes_scratch_data.h:1448</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adfa7834a2c85ab8d1f91316c2b6712a7"><div class="ttname"><a href="classNavierStokesScratchData.html#adfa7834a2c85ab8d1f91316c2b6712a7">NavierStokesScratchData::kinematic_viscosity_at_particle_location</a></div><div class="ttdeci">std::vector&lt; double &gt; kinematic_viscosity_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01271">navier_stokes_scratch_data.h:1271</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_adfdeab3a94c08dce29176710541ad665"><div class="ttname"><a href="classNavierStokesScratchData.html#adfdeab3a94c08dce29176710541ad665">NavierStokesScratchData::n_dofs_heat_transfer</a></div><div class="ttdeci">unsigned int n_dofs_heat_transfer</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01390">navier_stokes_scratch_data.h:1390</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae190c0101083553dafc546b98b300ce6"><div class="ttname"><a href="classNavierStokesScratchData.html#ae190c0101083553dafc546b98b300ce6">NavierStokesScratchData::face_velocity_gradients</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 2, dim &gt; &gt; &gt; face_velocity_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01449">navier_stokes_scratch_data.h:1449</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae20f109ee3fd7a5ed525a1ba76a4e759"><div class="ttname"><a href="classNavierStokesScratchData.html#ae20f109ee3fd7a5ed525a1ba76a4e759">NavierStokesScratchData::face_laplacian_phi_u</a></div><div class="ttdeci">Table&lt; 3, Tensor&lt; 1, dim &gt; &gt; face_laplacian_phi_u</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01459">navier_stokes_scratch_data.h:1459</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae38cfc270e721ef6a4de6db34dbe7e12"><div class="ttname"><a href="classNavierStokesScratchData.html#ae38cfc270e721ef6a4de6db34dbe7e12">NavierStokesScratchData::grad_phi_p</a></div><div class="ttdeci">Table&lt; 2, Tensor&lt; 1, dim &gt; &gt; grad_phi_p</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01323">navier_stokes_scratch_data.h:1323</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae72c592369ec0d85c01f4495eaee169c"><div class="ttname"><a href="classNavierStokesScratchData.html#ae72c592369ec0d85c01f4495eaee169c">NavierStokesScratchData::dynamic_viscosity</a></div><div class="ttdeci">std::vector&lt; double &gt; dynamic_viscosity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01233">navier_stokes_scratch_data.h:1233</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae765f88852f101d649a93b4a4f6f066c"><div class="ttname"><a href="classNavierStokesScratchData.html#ae765f88852f101d649a93b4a4f6f066c">NavierStokesScratchData::fe_face_values</a></div><div class="ttdeci">FEFaceValues&lt; dim &gt; fe_face_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01430">navier_stokes_scratch_data.h:1430</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae7754a9f031d997877e37f788f749fdb"><div class="ttname"><a href="classNavierStokesScratchData.html#ae7754a9f031d997877e37f788f749fdb">NavierStokesScratchData::grad_kinematic_viscosity_shear_rate</a></div><div class="ttdeci">std::vector&lt; double &gt; grad_kinematic_viscosity_shear_rate</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01242">navier_stokes_scratch_data.h:1242</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_ae83e521a115865e9bec668fc26be1e49"><div class="ttname"><a href="classNavierStokesScratchData.html#ae83e521a115865e9bec668fc26be1e49">NavierStokesScratchData::reinit_vof</a></div><div class="ttdeci">void reinit_vof(const typename DoFHandler&lt; dim &gt;::active_cell_iterator &amp;cell, const VectorType &amp;current_solution, const VectorType &amp;current_filtered_solution, const std::vector&lt; VectorType &gt; &amp;previous_solutions)</div><div class="ttdoc">Reinitialize the content of the scratch for the vof.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l00505">navier_stokes_scratch_data.h:505</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aeb94e9a27086b6776c73896a8ad92d6e"><div class="ttname"><a href="classNavierStokesScratchData.html#aeb94e9a27086b6776c73896a8ad92d6e">NavierStokesScratchData::density</a></div><div class="ttdeci">std::vector&lt; double &gt; density</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01230">navier_stokes_scratch_data.h:1230</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aebaf071ef8a3e9f6e878f11d7a94be66"><div class="ttname"><a href="classNavierStokesScratchData.html#aebaf071ef8a3e9f6e878f11d7a94be66">NavierStokesScratchData::fe_values_curvature</a></div><div class="ttdeci">std::shared_ptr&lt; FEValues&lt; dim &gt; &gt; fe_values_curvature</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01343">navier_stokes_scratch_data.h:1343</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aebfc11a2eade6b515242a0f09275fac0"><div class="ttname"><a href="classNavierStokesScratchData.html#aebfc11a2eade6b515242a0f09275fac0">NavierStokesScratchData::face_pressure_values</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; face_pressure_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01451">navier_stokes_scratch_data.h:1451</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_aefffdd294c642100ea21ba30aea5d185"><div class="ttname"><a href="classNavierStokesScratchData.html#aefffdd294c642100ea21ba30aea5d185">NavierStokesScratchData::beta_force</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; beta_force</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01292">navier_stokes_scratch_data.h:1292</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af0c85dd1b4866fb1c70c2cf5de3281b1"><div class="ttname"><a href="classNavierStokesScratchData.html#af0c85dd1b4866fb1c70c2cf5de3281b1">NavierStokesScratchData::face_quadrature_points</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Point&lt; dim &gt; &gt; &gt; face_quadrature_points</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01442">navier_stokes_scratch_data.h:1442</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af1ed3d09a7c260547245c035a1641d03"><div class="ttname"><a href="classNavierStokesScratchData.html#af1ed3d09a7c260547245c035a1641d03">NavierStokesScratchData::filtered_phase_order_cahn_hilliard_values</a></div><div class="ttdeci">std::vector&lt; double &gt; filtered_phase_order_cahn_hilliard_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01404">navier_stokes_scratch_data.h:1404</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af329e1c369385dbdd3cb044f23aeda0f"><div class="ttname"><a href="classNavierStokesScratchData.html#af329e1c369385dbdd3cb044f23aeda0f">NavierStokesScratchData::pressure_gradients</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; pressure_gradients</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01311">navier_stokes_scratch_data.h:1311</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af4d6f3f3933bb6a0ee8a290750bd7b84"><div class="ttname"><a href="classNavierStokesScratchData.html#af4d6f3f3933bb6a0ee8a290750bd7b84">NavierStokesScratchData::fluid_pressure_gradients_at_particle_location</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; fluid_pressure_gradients_at_particle_location</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01370">navier_stokes_scratch_data.h:1370</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af63bf259579dd4a09ae20cc81b36b01d"><div class="ttname"><a href="classNavierStokesScratchData.html#af63bf259579dd4a09ae20cc81b36b01d">NavierStokesScratchData::thermal_expansion</a></div><div class="ttdeci">std::vector&lt; double &gt; thermal_expansion</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01241">navier_stokes_scratch_data.h:1241</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af72659fbca48ccb8a9a76fcacef290ee"><div class="ttname"><a href="classNavierStokesScratchData.html#af72659fbca48ccb8a9a76fcacef290ee">NavierStokesScratchData::calculate_cell_void_fraction</a></div><div class="ttdeci">void calculate_cell_void_fraction(const double &amp;total_particle_volume)</div><div class="ttdoc">Computes the cell void fraction.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00736">navier_stokes_scratch_data.cc:736</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af76efde9fb25c3d5174fafda67d91307"><div class="ttname"><a href="classNavierStokesScratchData.html#af76efde9fb25c3d5174fafda67d91307">NavierStokesScratchData::velocity_laplacians</a></div><div class="ttdeci">std::vector&lt; Tensor&lt; 1, dim &gt; &gt; velocity_laplacians</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01307">navier_stokes_scratch_data.h:1307</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af8ac55b44d36bba2da5edb79754de69b"><div class="ttname"><a href="classNavierStokesScratchData.html#af8ac55b44d36bba2da5edb79754de69b">NavierStokesScratchData::extract_particle_properties</a></div><div class="ttdeci">double extract_particle_properties()</div><div class="ttdoc">Extracts the velocity of the particles and calculates their total volume in the cell.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8cc_source.html#l00696">navier_stokes_scratch_data.cc:696</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af919f875b3c240401eb20d9a84b4a19c"><div class="ttname"><a href="classNavierStokesScratchData.html#af919f875b3c240401eb20d9a84b4a19c">NavierStokesScratchData::properties_manager</a></div><div class="ttdeci">const PhysicalPropertiesManager properties_manager</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01228">navier_stokes_scratch_data.h:1228</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_af9e94c266309f54fa5210766dd1e7e96"><div class="ttname"><a href="classNavierStokesScratchData.html#af9e94c266309f54fa5210766dd1e7e96">NavierStokesScratchData::dynamic_viscosity_for_stabilization_0</a></div><div class="ttdeci">std::vector&lt; double &gt; dynamic_viscosity_for_stabilization_0</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01274">navier_stokes_scratch_data.h:1274</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_afcbbcbddf76fe8e5c18ee4f4549aee17"><div class="ttname"><a href="classNavierStokesScratchData.html#afcbbcbddf76fe8e5c18ee4f4549aee17">NavierStokesScratchData::chemical_potential_cahn_hilliard_values</a></div><div class="ttdeci">std::vector&lt; double &gt; chemical_potential_cahn_hilliard_values</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01406">navier_stokes_scratch_data.h:1406</a></div></div>
<div class="ttc" id="aclassNavierStokesScratchData_html_affb3f96369a5da5dcd9a246baa18e734"><div class="ttname"><a href="classNavierStokesScratchData.html#affb3f96369a5da5dcd9a246baa18e734">NavierStokesScratchData::kinematic_viscosity_scale_1</a></div><div class="ttdeci">double kinematic_viscosity_scale_1</div><div class="ttdoc">Scale of the kinematic viscosity for fluid 1.</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes__scratch__data_8h_source.html#l01268">navier_stokes_scratch_data.h:1268</a></div></div>
<div class="ttc" id="aclassPhysicalPropertiesManager_html"><div class="ttname"><a href="classPhysicalPropertiesManager.html">PhysicalPropertiesManager</a></div><div class="ttdoc">Class that manages the physical properties model which are required to calculate the various physical...</div><div class="ttdef"><b>Definition</b> <a href="physical__properties__manager_8h_source.html#l00057">physical_properties_manager.h:58</a></div></div>
<div class="ttc" id="aclassPhysicalPropertiesManager_html_a4fbf4cde6182467899c9cfab9a4bfdb0"><div class="ttname"><a href="classPhysicalPropertiesManager.html#a4fbf4cde6182467899c9cfab9a4bfdb0">PhysicalPropertiesManager::density_is_constant</a></div><div class="ttdeci">bool density_is_constant() const</div><div class="ttdef"><b>Definition</b> <a href="physical__properties__manager_8h_source.html#l00278">physical_properties_manager.h:278</a></div></div>
<div class="ttc" id="aclassPhysicalPropertiesManager_html_a62c83e5e2c38c581718752435b46e0f1"><div class="ttname"><a href="classPhysicalPropertiesManager.html#a62c83e5e2c38c581718752435b46e0f1">PhysicalPropertiesManager::is_non_newtonian</a></div><div class="ttdeci">bool is_non_newtonian() const</div><div class="ttdef"><b>Definition</b> <a href="physical__properties__manager_8h_source.html#l00266">physical_properties_manager.h:266</a></div></div>
<div class="ttc" id="aclassPhysicalPropertiesManager_html_ac301cee6597f9d4565681d9069365a8a"><div class="ttname"><a href="classPhysicalPropertiesManager.html#ac301cee6597f9d4565681d9069365a8a">PhysicalPropertiesManager::get_rheology</a></div><div class="ttdeci">std::shared_ptr&lt; RheologicalModel &gt; get_rheology(const unsigned int fluid_id=0, const unsigned int material_id=0) const</div><div class="ttdef"><b>Definition</b> <a href="physical__properties__manager_8h_source.html#l00138">physical_properties_manager.h:138</a></div></div>
<div class="ttc" id="aclassPhysicsScratchDataBase_html"><div class="ttname"><a href="classPhysicsScratchDataBase.html">PhysicsScratchDataBase</a></div><div class="ttdoc">Base class for scratch data objects of physics and subequations.</div><div class="ttdef"><b>Definition</b> <a href="physics__scratch__data_8h_source.html#l00010">physics_scratch_data.h:11</a></div></div>
<div class="ttc" id="adem__properties_8h_html"><div class="ttname"><a href="dem__properties_8h.html">dem_properties.h</a></div></div>
<div class="ttc" id="anamespaceDEM_1_1CFDDEMProperties_html_ae9734b9d29480269e4764c5092d87b2fac31564c0282259a90fa3036a0f7993e5"><div class="ttname"><a href="namespaceDEM_1_1CFDDEMProperties.html#ae9734b9d29480269e4764c5092d87b2fac31564c0282259a90fa3036a0f7993e5">DEM::CFDDEMProperties::dp</a></div><div class="ttdeci">@ dp</div><div class="ttdef"><b>Definition</b> <a href="dem__properties_8h_source.html#l00061">dem_properties.h:61</a></div></div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition</b> <a href="fluid__dynamics__matrix__free_8h_source.html#l00032">fluid_dynamics_matrix_free.h:33</a></div></div>
<div class="ttc" id="aparameters_8h_html"><div class="ttname"><a href="parameters_8h.html">parameters.h</a></div></div>
<div class="ttc" id="aphysical__properties__manager_8h_html"><div class="ttname"><a href="physical__properties__manager_8h.html">physical_properties_manager.h</a></div></div>
<div class="ttc" id="aphysical__property__model_8h_html"><div class="ttname"><a href="physical__property__model_8h.html">physical_property_model.h</a></div></div>
<div class="ttc" id="aphysics__scratch__data_8h_html"><div class="ttname"><a href="physics__scratch__data_8h.html">physics_scratch_data.h</a></div></div>
<div class="ttc" id="asdirk__stage__data_8h_html"><div class="ttname"><a href="sdirk__stage__data_8h.html">sdirk_stage_data.h</a></div></div>
<div class="ttc" id="astructParameters_1_1CahnHilliard_html"><div class="ttname"><a href="structParameters_1_1CahnHilliard.html">Parameters::CahnHilliard</a></div><div class="ttdef"><b>Definition</b> <a href="parameters__multiphysics_8h_source.html#l00360">parameters_multiphysics.h:361</a></div></div>
<div class="ttc" id="astructParameters_1_1Mortar_html"><div class="ttname"><a href="structParameters_1_1Mortar.html">Parameters::Mortar</a></div><div class="ttdoc">Mortar - Defines parameters used to construct mortar elements.</div><div class="ttdef"><b>Definition</b> <a href="parameters_8h_source.html#l01821">parameters.h:1822</a></div></div>
<div class="ttc" id="astructParameters_1_1VOF__PhaseFilter_html"><div class="ttname"><a href="structParameters_1_1VOF__PhaseFilter.html">Parameters::VOF_PhaseFilter</a></div><div class="ttdoc">Parameters for the phase filtration.</div><div class="ttdef"><b>Definition</b> <a href="parameters__multiphysics_8h_source.html#l00189">parameters_multiphysics.h:190</a></div></div>
<div class="ttc" id="astructSDIRKTable_html"><div class="ttname"><a href="structSDIRKTable.html">SDIRKTable</a></div><div class="ttdoc">Structure representing a Butcher tableau for a SDIRK method.</div><div class="ttdef"><b>Definition</b> <a href="sdirk__stage__data_8h_source.html#l00033">sdirk_stage_data.h:34</a></div></div>
<div class="ttc" id="atime__integration__utilities_8h_html"><div class="ttname"><a href="time__integration__utilities_8h.html">time_integration_utilities.h</a></div></div>
<div class="ttc" id="atime__integration__utilities_8h_html_a0a24876ac89130c482872183aaabb619"><div class="ttname"><a href="time__integration__utilities_8h.html#a0a24876ac89130c482872183aaabb619">is_bdf</a></div><div class="ttdeci">bool is_bdf(const Parameters::SimulationControl::TimeSteppingMethod method)</div><div class="ttdoc">Determines if the time integration method is within the bdf family.</div><div class="ttdef"><b>Definition</b> <a href="time__integration__utilities_8h_source.html#l00041">time_integration_utilities.h:41</a></div></div>
<div class="ttc" id="atime__integration__utilities_8h_html_aa978da869c242558658db8bf49e8568e"><div class="ttname"><a href="time__integration__utilities_8h.html#aa978da869c242558658db8bf49e8568e">is_sdirk</a></div><div class="ttdeci">bool is_sdirk(const Parameters::SimulationControl::TimeSteppingMethod method)</div><div class="ttdoc">Determines if the time integration method is within the sdirk family.</div><div class="ttdef"><b>Definition</b> <a href="time__integration__utilities_8h_source.html#l00058">time_integration_utilities.h:58</a></div></div>
<div class="ttc" id="autilities_8h_html_a3d02cb065c32b672c94bb862ecff4431"><div class="ttname"><a href="utilities_8h.html#a3d02cb065c32b672c94bb862ecff4431">compute_cell_measure_with_JxW</a></div><div class="ttdeci">double compute_cell_measure_with_JxW(const std::vector&lt; double &gt; &amp;JxW_values)</div><div class="ttdoc">Computes the area (2D) or volume (3D) of the cell by integrating 1 over the cell, by summing JxW valu...</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00708">utilities.h:708</a></div></div>
<div class="ttc" id="autilities_8h_html_a955c2851894d041727c14dff59686f0d"><div class="ttname"><a href="utilities_8h.html#a955c2851894d041727c14dff59686f0d">calculate_point_property</a></div><div class="ttdeci">double calculate_point_property(const double phase, const double property0, const double property1)</div><div class="ttdoc">Calculate the equivalent properties for a given phase. Method called in quadrature points loops in VO...</div><div class="ttdef"><b>Definition</b> <a href="utilities_8h_source.html#l00292">utilities.h:292</a></div></div>
<div class="ttc" id="avof__filter_8h_html"><div class="ttname"><a href="vof__filter_8h.html">vof_filter.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
