# Listing of Parameters
# ---------------------
# --------------------------------------------------
# Simulation and IO Control
#---------------------------------------------------
subsection simulation control
  set method                  = bdf1
  set number mesh adapt       = 0
  set output name              = result_
  set output frequency	  	= 1000
  set startup time scaling         = 0.6
  set time end                     = 0.005
  set time step                    = 0.001
  set subdivision             = 1 
  set log precision     = 10 
end

#---------------------------------------------------
# Restart
#---------------------------------------------------
subsection restart
	set checkpoint					 = false
	set frequency 					 = 100
	set restart       				 = false
	set filename      				 = case
end

#---------------------------------------------------
# FEM
#---------------------------------------------------
subsection FEM
    set velocity order            = 1
    set pressure order            = 1
end


#---------------------------------------------------
# Physical Properties
#---------------------------------------------------
subsection physical properties
    set kinematic viscosity            = 0.0000008379
    set density                        = 996.7775
end

#---------------------------------------------------
# Mesh
#---------------------------------------------------
subsection mesh
    set type                 				= dealii
    set grid type            				= subdivided_hyper_rectangle
    set grid arguments       				= 2,33,2:-0.005,-0.05,-0.005:0.005,0.05,0.005:true
    set initial refinement   				= 2
end
#---------------------------------------------------
# Void Fraction
#---------------------------------------------------
subsection void fraction
   set mode = dem
   set read dem = true
   set dem file name = dem
   set l2 smoothing factor = 0.000005
   set l2 lower bound = 0
   set l2 upper bound = 1
   set bound void fraction = false
end

#---------------------------------------------------
# CFD-DEM
#---------------------------------------------------
subsection cfd-dem
   set grad div = false
   set void fraction time derivative  = false
   set drag force = true
   set buoyancy force = true
   set shear force = false
   set pressure force = false
   set drag model = difelice
   set post processing = true
   set inlet boundary id = 2
   set outlet boundary id = 3
   set coupling frequency = 200
end

#---------------------------------------------------
# Initial condition
#---------------------------------------------------
 subsection initial conditions
#    set type = nodal
#    set viscosity = 0.005
    subsection uvwp
            set Function expression = 0; 0; 0; 0
    end
 end

# --------------------------------------------------
# Boundary Conditions
#---------------------------------------------------
subsection boundary conditions
  set number                  = 5
   subsection bc 0
     set id		   = 0
     set type              = slip
    end
   subsection bc 1
     set id		   = 1
     set type              = slip
    end
   subsection bc 2
     set id		   = 4
     set type              = slip
    end
   subsection bc 3
     set id		   = 5
     set type              = slip
    end
   subsection bc 4
     set id		   = 2
     set type              = function
        subsection u
            set Function expression = 0
        end
        subsection v
            set Function expression = 0.01  
        end
        subsection w
            set Function expression = 0
        end
    end
end

# --------------------------------------------------
# Source term
#---------------------------------------------------
subsection source term
  set enable                 = false
    subsection xyz
            set Function expression = 0; 0; 0; 0
    end
end

# --------------------------------------------------
# Mesh Adaptation Control
#---------------------------------------------------
subsection mesh adaptation
  set type                    = none
end

#---------------------------------------------------
# Timer
#---------------------------------------------------
subsection timer
  set type  = none
end

# --------------------------------------------------
# Model parameters
#---------------------------------------------------
subsection model parameters
  set contact detection method 		   		 = dynamic
  set dynamic contact search size coefficient	 	 = 0.9
  set neighborhood threshold				 = 1.5
  set load balance method				 = none
  set load balance threshold				 = 0.5
  set load balance frequency		 		 = 10
  set dynamic load balance check frequency		 = 50
  set load balance particle weight			 = 100
  set particle particle contact force method             = pp_nonlinear
  set particle wall contact force method                 = pw_nonlinear
  set integration method				 = velocity_verlet
end

#---------------------------------------------------
# Physical Properties
#---------------------------------------------------
subsection lagrangian physical properties
    set gx            		 			= 0
    set gy            		 			= -9.81
    set gz						= 0
    set number of particle types	                = 1
    subsection particle type 0
		set size distribution type		= uniform
    		set diameter            	 	= 0.002664
    		set number				= 10000
    		set density particles         	        = 1028.805
    		set young modulus particles         	= 100000000
    		set poisson ratio particles          	= 0.3
    		set restitution coefficient particles	= 0.9
    		set friction coefficient particles      = 0.1
    		set rolling friction particles        	= 0.2
	end
    set young modulus wall            			= 100000000
    set poisson ratio wall            			= 0.3
    set restitution coefficient wall           		= 0.9
    set friction coefficient wall         		= 0.1
    set rolling friction wall         	      	  	= 0.3
end

#---------------------------------------------------
# Floating walls
#---------------------------------------------------
subsection floating walls
    set number of floating walls	                = 1
    	subsection wall 0
		subsection point on wall
			set x				= 0
			set y				= -0.045
			set z				= 0
		end
		subsection normal vector
			set nx				= 0
			set ny				= 1
 			set nz 				= 0
		end
		set start time				= 0
		set end time				= 50
   	end

end

# --------------------------------------------------
# Non-Linear Solver Control
#---------------------------------------------------
subsection non-linear solver
  set tolerance               = 1e-9
  set max iterations          = 10
  set verbosity               = quiet
end

# --------------------------------------------------
# Linear Solver Control
#---------------------------------------------------
subsection linear solver
  set method                                 = gmres
  set max iters                              = 5000
  set relative residual                      = 1e-3
  set minimum residual                       = 1e-10
  set ilu preconditioner fill                = 1
  set ilu preconditioner absolute tolerance  = 1e-14
  set ilu preconditioner relative tolerance  = 1.00
  set verbosity               = quiet
  set max krylov vectors = 1000

end
