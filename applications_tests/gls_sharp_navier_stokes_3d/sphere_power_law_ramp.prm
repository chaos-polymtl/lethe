# Listing of Parameters
# ---------------------
# --------------------------------------------------
# Simulation Control
#---------------------------------------------------
subsection simulation control
  set method                  = steady
  set number mesh adapt       = 0
  set output name             = sphere-output
  set output frequency        = 1
  set subdivision             = 1
end
#---------------------------------------------------
# FEM
#---------------------------------------------------
subsection FEM
    set velocity order        = 1
    set pressure order        = 1
end

#------------------------------------------------
# Force
#---------------------------------------------------
subsection forces			
    set verbosity               = verbose
end

#---------------------------------------------------
# Initial condition
#---------------------------------------------------
subsection initial conditions
    set type = ramp
    subsection ramp
    	subsection n
    		set initial n = 1.0
    		set iterations = 2
    		set alpha = 0.5
    	end
    	subsection viscosity
    		set initial viscosity = 1.0
    		set iterations = 2
    		set alpha = 0.5
    	end
    end
end

#---------------------------------------------------
# Physical Properties
#---------------------------------------------------
subsection physical properties
set number of fluids = 1
  subsection fluid 0
   	set rheological model	= power-law

    subsection non newtonian
    	subsection power-law
	    	set K 		   = 10
	    	set n 		   = 0.5
	    	set shear rate min = 1e-03
	end
    end
  end
end

#---------------------------------------------------
# Mesh
#---------------------------------------------------
subsection mesh
    set type                 = dealii
    set grid type            = subdivided_hyper_rectangle
    set grid arguments       = 2,1,1 : -18,-15,-15 : 42,15,15 : true
    set initial refinement   = 2
end

subsection  box refinement
    set initial refinement   = 4
    subsection mesh
    set type                 = dealii
    set grid type            = subdivided_hyper_rectangle
    set grid arguments       = 2,2,2: -2,-2,-2 : 2,2,2 : true
    set initial refinement   = 0
    end
end



# --------------------------------------------------
# Boundary Conditions
#---------------------------------------------------
subsection boundary conditions
set number                  = 5
    subsection bc 0
	set id = 0
        set type              = function
        subsection u
            set Function expression = 1
        end
        subsection v
            set Function expression = 0
        end
        subsection w
            set Function expression = 0
        end
    end
    subsection bc 1
	set id = 2
        set type              = slip
    end    
    subsection bc 2
	set id = 3
        set type              = slip
    end
    subsection bc 3
	set id = 4
        set type              = slip
    end
    subsection bc 4
	set id = 5
        set type              = slip
    end
end

# --------------------------------------------------
# IB particules
#---------------------------------------------------
subsection particles
	set number of particles = 1
	set stencil order = 2
	set length ratio  = 2.5
	set refine mesh inside radius factor = 0.5
	set refine mesh outside radius factor = 1.5
	set initial refinement = 2
	set integrate motion = false
	set assemble Navier-Stokes inside particles = false    
	subsection particle info 0
	subsection position
	    set Function expression =0;0;0
	end
	subsection velocity
	    set Function expression =0;0;0
	end
	    subsection omega
	    set Function expression =0;0;0
	end
	    set pressure x =0.00001
	    set pressure y =0.00001
	    set pressure z =0.00001
	    set radius = 0.5
    end
end
# --------------------------------------------------
# Mesh Adaptation Control
#---------------------------------------------------
subsection mesh adaptation
  set type                    = kelly
  set fraction coarsening     = 0.0
  set fraction refinement     = 0.0
  set fraction type	      = number
  set frequency            = 1
  set max number elements     = 8000000
  set min refinement level    = 0
  set max refinement level    = 10
end
# --------------------------------------------------
# Non-Linear Solver Control
#---------------------------------------------------
subsection non-linear solver
  set verbosity               = verbose
  set tolerance               = 1e-6
  set max iterations          = 1000
  set residual precision      = 5
  set force rhs calculation   = true
end
# --------------------------------------------------
# Timer
#---------------------------------------------------
subsection restart
  # Enable checkpointing. Checkpointing creates a restartpoint from which the
  # simulation can be restarted from.
  set checkpoint = true  # Prefix for the filename of checkpoints
  set filename   = check_point  # Frequency for checkpointing
  set frequency  = 300  # Frequency for
  set restart    = false
  end
  # --------------------------------------------------
# Linear Solver Control
#---------------------------------------------------
subsection linear solver
#  set verbosity               = verbose
  set method                  = gmres
  set max iters               = 1000
  set relative residual       = 1e-3
  set minimum residual        = 1e-8
  set ilu preconditioner fill = 0
  set ilu preconditioner absolute tolerance = 1e-12
  set ilu preconditioner relative tolerance = 1.00
  set amg aggregation threshold                 = 1e-20
  set amg n cycles                              = 1
  set amg preconditioner ilu absolute tolerance = 1e-20
  set amg preconditioner ilu fill               = 0
  set amg preconditioner ilu relative tolerance = 1.00
  set amg smoother overlap                      = 1
  set amg smoother sweeps                       = 2
  set amg w cycles                              = false
  set max krylov vectors = 1000
end
