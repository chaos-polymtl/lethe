====================================
Concentric heat exchanger
====================================

This example simulates an heat exchanger which is made of two concentric pipes in which a hot and a cold fluid circulate in a counter-current fashion. We simulate the fluid flow within two fluid regions as well as the heat transfer within the entire domain (solid and fluid). This example illustrates the conjugate heat transfer capabilities of Lethe.

----------------------------------
Features
----------------------------------
- Solver: ``gls_navier_stokes_3d`` 
- Heat transfer pÄ¥ysics
- Conjugated heat transfer

Files used in this example
---------------------------
Prm file: ``examples/multiphysics/concentric-heat-exchanger/concentric-heat-exchanger.prm``
GMSH file: ``examples/multiphysics/concentric-heat-exchanger/concentric-cylinders.geo``
GMSH mesh: ``examples/multiphysics/concentric-heat-exchanger/concentric-cylinders.msh``


Description of the case
-------------------------

Heat exchangers are a common unit operations used in many type of industries to transfer energy from one fluid to another. In this case, we simulate the most simple heat exchanger geometry, which is a concentric tube in which the hot fluid circulates within the outer region and a cold fluid circulates within the inner region. We model the full heat transfer by simulating the motion of the fluid in both regions and the heat transfer within the entire domain. 

We consider steel concentric tubes with radii of :math:`R_0=2\text{mm} ,R_1=5\text{mm},R_2=7.5\text{mm}` in which water circulates. We consider a counter-current flow with an inner tube velocity of :math:`u_i=10\text{mm/s}` and a outer tube velocity of :math:`u_o=2\text{mm/s}`. We do not formulate the problem in SI units, but instead we express the fundamental length in mm. This ensures that most variables of interest are close to unit value and this leads to a system matrix which has improved conditioning.

.. 
  image:: images/stefan-problem-illustration.png
    :alt: problem_illustration
    :align: center



We compare the results we obtain with the CFD simulations with results from a correlation. Using the YYY correlations, we can estimate the heat transfer coefficients on the outer and the inner tube walls to be:

The resulting the temperature profile for both the hot and the cold fluid is:


--------------
Parameter file
--------------

We first enable the heat transfer multiphysics component:

.. code-block:: text

    #---------------------------------------------------
    # Multiphysics
    #---------------------------------------------------
    subsection multiphysics
       set heat transfer = true
    end



Conjugated heat transfer simulations require meshes in which the fluid and the solid regions are identified using a ``material_id``. In the case of meshes generated by GMSH, this corresponds to the ``Physical Volume``. Lethe assumes that the region occupied by the fluid has ``material_id=0```and the region occupied by the solid has ``material_id=1``. The mesh used in this problem is a mesh generated using GMSH.

.. code-block:: text

    #---------------------------------------------------
    # Mesh
    #---------------------------------------------------
    subsection mesh
        set type                 = gmsh
        set file name            = concentric-cylinders.msh
    end


The next step is establishing the boundary conditions for the fluid flow. We specify a no-slip boundary conditions on the outer walls of the cylinder and specify an inlet velocity for both boundary 1 and 2. Note that the faces at the interfaces between the solid region and the fluid regions automatically have a ``noslip`` boundary condition applied to them.

.. code-block:: text

    # --------------------------------------------------
    # Boundary Conditions
    #---------------------------------------------------
    subsection boundary conditions
      set number                  = 3
        subsection bc 0
            set type              = noslip
            set id                = 0
        end
        subsection bc 1
            set type              = function
            set id                = 1
            subsection u
                set Function expression = 0
            end
            subsection v
                set Function expression = 0
            end
            subsection w
                set Function expression = 10
            end
        end
        subsection bc 2
            set type              = function
            set id                = 4
            subsection u
                set Function expression = 0
            end
            subsection v
                set Function expression = 0
            end
            subsection w
                set Function expression = -2
            end
        end

    end

On the heat transfer side, we apply temperature boundary conditions at both inlet to impose the cold and the hot temperatures of the fluid. We explicitely specify ``noflux`` boundary conditions on both outlets to ensure that the heat flux through them will be calculated within the post-processing section of the code.

.. code-block:: text

    # --------------------------------------------------
    # Boundary Conditions Heat Transfer
    #---------------------------------------------------
    subsection boundary conditions heat transfer
      set number                  = 4
        subsection bc 0
            set id = 1
            set type              = temperature
    	      set value             = 0
        end

        subsection bc 1
            set id = 4
            set type              = temperature
    	      set value             = 100
        end
        subsection bc 2
            set id = 2
            set type              = noflux
        end
        subsection bc 3
            set id = 3
            set type              = noflux
        end
    end


Next, we define the physical properties for both the solid and the fluid. It is important to explicitely indicate the number of solids, otherwise the solid region will not be detected by Lethe.

.. code-block:: text

    subsection physical properties
      subsection fluid 0
        set kinematic viscosity            = 1 #1e-6
        set specific heat                  = 4180
        set density                        = 1 #11000
        set thermal conductivity           = 1.44e-1 #10.6
      end

      set number of solids = 1
      subsection solid 0
        set thermal conductivity           = 4
        set specific heat                  = 1
        set density                        = 1
      end
    end

To enable a more complete analysis of the case, we enable the heat flux post-processing. This will calculate the total heat flux on every boundary of the domain and enable us to characterize the energy coming in and out of every inlets and oulets.

.. code-block:: text

    #---------------------------------------------------
    # Post-processing
    #---------------------------------------------------
    subsection post-processing
        set verbosity = verbose
        set calculate heat flux = true
    end

Finally, we are interested in steady-state results and we thus specify a steady-state simulation.

.. code-block:: text

    # --------------------------------------------------
    # Simulation Control
    #---------------------------------------------------
    subsection simulation control
      set method                  = steady
      set output frequency        = 1
      set output path             = ./output/
    end



-------
Results
-------

Possibilities for extension
----------------------------

- **Investigate co-current flow:** By inverting the inlet and the outlet on the outer pipe, this case can be changed from a counter-current to a co-current heat exchanger.



----------------------------
References
----------------------------

`[1] <https://doi.org/10.1016/j.applthermaleng.2007.01.008>`_ aus der Wiesche, Stefan. "Numerical heat transfer and thermal engineering of AdBlue (SCR) tanks for combustion engine emission reduction." Applied Thermal Engineering 27.11-12 (2007): 1790-1798.
